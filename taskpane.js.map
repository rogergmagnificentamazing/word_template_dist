{"version":3,"file":"taskpane.js","mappings":"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","sources":["webpack://office-addin-taskpane/webpack/bootstrap","webpack://office-addin-taskpane/webpack/runtime/define property getters","webpack://office-addin-taskpane/webpack/runtime/global","webpack://office-addin-taskpane/webpack/runtime/hasOwnProperty shorthand","webpack://office-addin-taskpane/webpack/runtime/publicPath","webpack://office-addin-taskpane/webpack/runtime/jsonp chunk loading","webpack://office-addin-taskpane/./src/taskpane/taskpane.ts","webpack://office-addin-taskpane/./src/taskpane/taskpane.html"],"sourcesContent":["// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n// expose the modules object (__webpack_modules__)\n__webpack_require__.m = __webpack_modules__;\n\n","// define getter functions for harmony exports\n__webpack_require__.d = function(exports, definition) {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.g = (function() {\n\tif (typeof globalThis === 'object') return globalThis;\n\ttry {\n\t\treturn this || new Function('return this')();\n\t} catch (e) {\n\t\tif (typeof window === 'object') return window;\n\t}\n})();","__webpack_require__.o = function(obj, prop) { return Object.prototype.hasOwnProperty.call(obj, prop); }","var scriptUrl;\nif (__webpack_require__.g.importScripts) scriptUrl = __webpack_require__.g.location + \"\";\nvar document = __webpack_require__.g.document;\nif (!scriptUrl && document) {\n\tif (document.currentScript && document.currentScript.tagName.toUpperCase() === 'SCRIPT')\n\t\tscriptUrl = document.currentScript.src;\n\tif (!scriptUrl) {\n\t\tvar scripts = document.getElementsByTagName(\"script\");\n\t\tif(scripts.length) {\n\t\t\tvar i = scripts.length - 1;\n\t\t\twhile (i > -1 && (!scriptUrl || !/^http(s?):/.test(scriptUrl))) scriptUrl = scripts[i--].src;\n\t\t}\n\t}\n}\n// When supporting browsers where an automatic publicPath is not supported you must specify an output.publicPath manually via configuration\n// or pass an empty string (\"\") and set the __webpack_public_path__ variable from your code to use your own logic.\nif (!scriptUrl) throw new Error(\"Automatic publicPath is not supported in this browser\");\nscriptUrl = scriptUrl.replace(/^blob:/, \"\").replace(/#.*$/, \"\").replace(/\\?.*$/, \"\").replace(/\\/[^\\/]+$/, \"/\");\n__webpack_require__.p = scriptUrl;","__webpack_require__.b = document.baseURI || self.location.href;\n\n// object to store loaded and loading chunks\n// undefined = chunk not loaded, null = chunk preloaded/prefetched\n// [resolve, reject, Promise] = chunk loading, 0 = chunk loaded\nvar installedChunks = {\n\t926: 0\n};\n\n// no chunk on demand loading\n\n// no prefetching\n\n// no preloaded\n\n// no HMR\n\n// no HMR manifest\n\n// no on chunks loaded\n\n// no jsonp function","/*\n * Copyright (c) Microsoft Corporation. All rights reserved. Licensed under the MIT license.\n * See LICENSE in the project root for license information.\n */\n\n/* global document, Office, Word */\n\n(window as any).addinCommand = {\n  pasteUnformatted,\n  setStyle,\n  setCoverHeadingFontSize,\n  clearFormatting,\n  insertAutoText,\n  dynamicTable,\n  insertTableCaption,\n  insertImageIntoWord,\n  screenshotFormatGuide,\n  insertBackCover,\n  insertPageBreakAtSelection,\n  updateCoverProperties,\n  updateTOC,\n  insertFigureCaption,\n  a4Orientation,\n  getOOXML,\n  getOOXMLDocument,\n  pasteOOXML,\n  pasteOOXMLAsDocument,\n  chooseTemplate\n};\n\n\nOffice.onReady(async (info) => {\n\n  console.log(\"onready in taskpane.\")\n  Office.actions.associate(\"launchTaskpane\", launchTaskpane);\n Office.actions.associate(\"launcHelpTaskpane\", launcHelpTaskpane);\n\n  //\n  \n  // Register the function with Office want to call from the Ribbon.\n  Office.actions.associate(\"action\", action);\n\n  // todo :ribbon test, confirmed ribbon not supported\n  // await updateRibbon();\n});\n\n// placeholder action for ribbon command \nfunction action(event: Office.AddinCommands.Event)\n{\n\n    event.completed();\n\n}\n\nasync function updateRibbon() {\n\n  /* todo: can enable buttons but can't hide */\n  \n  console.log(\"attempting to update ribbon\");\n  await Office.ribbon.requestUpdate({\n    tabs: [\n      {\n        id: \"CustomTab\",\n        visible: false\n      }\n    ]\n  }).then(() => {\n    console.log(\"Custom tab hidden.\");\n  }).catch((error) => {\n    console.error(\"Failed to hide tab:\", error);\n  });\n\n}\n\nexport async function run() {\n  return Word.run(async (context) => {\n    /**\n     * Insert your Word code here\n     */\n\n    // insert a paragraph at the end of the document.\n    const paragraph = context.document.body.insertParagraph(\"Hello World\", Word.InsertLocation.end);\n\n    // change the paragraph color to blue.\n    paragraph.font.color = \"blue\";\n\n    await context.sync();\n  });\n}\n\nasync function launcHelpTaskpane(event)\n{\n   await launchTaskpane(event);\n\n   // todo: should probably check if taskpane actually launched.\n    window.showTab(\"help\");\n\n}\n\nasync function launchTaskpane(event) {\n\n  console.log(\"launch taskpane\");\n\n  // TODO: BUG BUG, IF THIS THROWS AND WE DON'T CALL EVENT.COMPLETE() add-in UI is frozen\n\n  // check if the template has been configured\n  // todo: should just be  acheck function but \n  // do here since currently only place to check.\n  const keys = [\"CoverOption\", \"CoverDesign\"];\n  let customPropertiesDict = await getCustomPropertiesAsJson(keys);\n  if (!customPropertiesDict[\"CoverOption\"])\n  {\n     // if cover option not defined then set it up.\n     // MAGOO\n     \n     \n      document.getElementById(\"chooseTemplate\").onclick = async () => { \n        await chooseTemplate();\n        };\n      \n    \n\n     // the dialog is async so can't wait.\n     // need to have taskpane be launched again via a callback.\n\n   //  event.completed();\n   //  return;\n  }\n\n\n  Office.addin.showAsTaskpane()\n    .then(() => {\n      // Optional: initialize UI or state\n       event.completed();\n    })\n    .catch((error) => {\n      console.error(\"Failed to show taskpane:\", error);\n      event.completed();\n    });\n\n}\n\n/* office doesn't allow clipboard access so use the browser.\n  User will be asked if accessing clipboard is okay\n*/\nexport function pasteUnformatted() {\n  navigator.clipboard.readText().then((clipText) => {\n    Word.run(async (context) => {\n      const selection = context.document.getSelection();\n      selection.insertText(clipText, Word.InsertLocation.replace);\n      await context.sync();\n    });\n  }).catch((err) => {\n    console.error(\"Clipboard access failed:\", err);\n  });\n}\n\n/*\n Set the Style\n*/\n\nexport async function setStyle(styleName) {\n\n  console.log(\"setStyle \" + styleName);\n\n   try {\n    await Word.run(async (context) => {\n      const selection = context.document.getSelection();\n      selection.style = styleName;\n      await context.sync();\n    });\n  } catch (error) {\n\n    // Todo: make a common helper\n    console.log(\"Error applying style:\", styleName, \"Most likely style doesn't exist in document.\");\n\n    if (error instanceof OfficeExtension.Error) {\n        console.error(\"Debug info:\", {\n      message: error.message,\n      code: error.code,\n      trace: error.traceMessages,\n    });\n  }\n\n\n  }\n}\n\n\n/*\nOffice.JS doesn't have a \"Clear Formatting\" so have to manually reset each of the\nproperties we care about resetting to the Style.\n*/\nexport async function clearFormatting() {\n  try {\n    await Word.run(async (context) => {\n      const selection = context.document.getSelection();\n      const font = selection.font;\n\n      // Safely reset local formatting overrides\n      font.bold = false;\n      font.italic = false;\n      font.underline = \"None\";\n      font.color = \"auto\";\n      font.highlightColor = \"None\";\n      font.strikeThrough = false;\n      font.subscript = false;\n      font.superscript = false;\n\n      await context.sync();\n      console.log(\"Local formatting reset to style defaults.\");\n    });\n  } catch (error) {\n    console.error(\"Error resetting formatting:\", error);\n    if (error instanceof OfficeExtension.Error) {\n      console.error(\"Details:\", {\n        message: error.message,\n        code: error.code,\n        trace: error.traceMessages,\n      });\n    }\n  }\n}\n\n\n/* \nTodo: example if using custom.xml for the autotext.\nCould also store the .xml online and Fetch if don't want to store in the document.\n*/\n/*\ntodo: if do the fetch cache after first call so don't fetch and parse every time\n*/\n\nvar netwealth_CacheXml = null;\nvar ahrc_CacheXml = null;\n\nasync function getAutoTextOOXML(autoText_identifier)\n{\n\n let  xmlDoc = null;\n\n    /*\n    // make sure xml is loaded\n    if (!netwealth_CacheXml) {\n      // Step 1: Fetch custom.xml from assets\n      //const response = await fetch(\"./assets/netwealth_custom.xml\");\n\n           const response = await fetch(\"./assets/netwealth_custom.xml\");\n\n      if (!response.ok) {\n        throw new Error(`Failed to fetch custom.xml: ${response.statusText}`);\n      }\n\n      const xmlText = await response.text();\n\n      // Step 2: Parse XML and locate the snippet\n      const parser = new DOMParser();\n      xmlDoc = parser.parseFromString(xmlText, \"application/xml\");\n      netwealth_CacheXml = xmlDoc;\n    }\n*/\n\n      // make sure xml is loaded\n    if (!ahrc_CacheXml) {\n      // Step 1: Fetch custom.xml from assets\n      const response = await fetch(\"./assets/ahrc_custom.xml\");\n      if (!response.ok) {\n        throw new Error(`Failed to fetch custom.xml: ${response.statusText}`);\n      }\n\n      const xmlText = await response.text();\n\n      // Step 2: Parse XML and locate the snippet\n      const parser = new DOMParser();\n      xmlDoc = parser.parseFromString(xmlText, \"application/xml\");\n      ahrc_CacheXml = xmlDoc;\n    }\n\n    //  hack we just check both xmls for prototypeing.\n    let snippetNode = null; // netwealth_CacheXml.querySelector(`Snippet[id='${autoText_identifier}']`);\n\n    if (!snippetNode) {\n      snippetNode = ahrc_CacheXml.querySelector(`Snippet[id='${autoText_identifier}']`);\n      if (!snippetNode) {\n      throw new Error(`Snippet with id '${autoText_identifier}' not found.`);\n      }\n    }\n\n    const snippet = snippetNode.textContent;\n\n    return snippet\n}\n\nexport async function insertAutoText(autoText_identifier, bookmarkName = null) {\n  try {\n\n    let snippet = await getAutoTextOOXML(autoText_identifier);\n\n    // Step 3: Insert OOXML into Word document\n    await Word.run(async (context) => {\n      let insertRange = null;\n      if (bookmarkName) {\n          insertRange = context.document.getBookmarkRange(bookmarkName);\n          insertRange.load(\"text\");\n          await context.sync();\n\n          // TODO: CHECK FOR ERRORS.\n      }\n      else\n      {\n          insertRange = context.document.getSelection();\n      }\n\n\n      // insertOoxml merges and doesn't honor the replace so clear out the range first.\n      insertRange.clear();\n      await context.sync();\n\n\n       insertRange.insertOoxml(snippet, Word.InsertLocation.replace);\n      await context.sync();\n    });\n\n  } catch (error) {\n    console.error(\"Error inserting autotext:\", error);\n    if (error instanceof OfficeExtension.Error) {\n      console.error(\"Details:\", {\n        message: error.message,\n        code: error.code,\n        trace: error.traceMessages,\n      });\n    }\n  }\n}\n\nexport async function insertAutoTextContentXml(autoText_identifier) {\n  try {\n        await Word.run(async (context) => {\n          const parts = context.document.customXmlParts.getByNamespace(\"http://schemas.adu/addin/autotext\");\n          parts.load(\"items\");\n          await context.sync();\n\n          if (parts.items.length === 0) {\n            throw new Error(\"No matching CustomXmlParts found.\");\n          }\n\n          const xmlPart = parts.items[0]; // Now confidently scoped\n          const xml = xmlPart.getXml();\n          await context.sync();\n\n          const parser = new DOMParser();\n          const xmlDoc = parser.parseFromString(xml.value, \"text/xml\");\n          const snippetNode = xmlDoc.querySelector(`Snippet[id='${autoText_identifier}']`);\n\n          if (!snippetNode) {\n            throw new Error(`Snippet with id '${autoText_identifier}' not found.`);\n          }\n\n          const snippet = snippetNode.textContent;\n\n          const selection = context.document.getSelection();\n          selection.insertOoxml(snippet, Word.InsertLocation.replace);\n\n          await context.sync();\n        });\n\n  } catch (error) {\n    console.error(\"Error inserting autotext:\", error);\n    if (error instanceof OfficeExtension.Error) {\n      console.error(\"Details:\", {\n        message: error.message,\n        code: error.code,\n        trace: error.traceMessages,\n      });\n    }\n  }\n}\n\n/*\ntodo: test code for changing style font size\nOffice.js doesn't support changing the font size, \nCould looking into using OOXML direction\n*/\nexport async function setCoverHeadingFontSize(size: number) {\n  try {\n    await Word.run(async (context) => {\n      const props = context.document.properties.customProperties;\n      const styles = context.document.getStyles();\n      \n      props.load(\"items\");\n      const coverHeadingStyle = styles.getByNameOrNullObject(\"Cover Heading\");\n      coverHeadingStyle.load(\"font\");\n      await context.sync();\n\n      const getProp = (name: string) => {\n        const prop = props.items.find(p => p.key === name);\n        return prop ? prop.value : null;\n      };\n\n      const coverChosen = getProp(\"CoverChosen\");\n      const docType = getProp(\"DocumentType\");\n\n      // Todo: clean this up.\n      const caption = \"setCoverHeadingFontSize\";     // Replace with actual value\n      const docTypeLabel = \"\"; // Replace with actual value\n\n      if (coverChosen === \"1\" || coverChosen === \"2\") {\n        console.log(`${caption} ${docTypeLabel}: This option is not designed for the cover you've chosen.`);\n        return;\n      } else if (docType === \"CustomNoCover\") {\n        console.log(`${caption} ${docTypeLabel}: This option is not designed for the custom layout you've chosen.`);\n        return;\n      } else if (docType === \"Simple\") {\n        console.log(`${caption} ${docTypeLabel}: This option is not designed for the simple layout you've chosen.`);\n        return;\n      }\n\n      if (coverHeadingStyle.isNullObject) {\n        console.log(\"Style 'Cover Heading' not found.\");\n        return;\n      }\n\n      coverHeadingStyle.font.size = size;\n      await context.sync();\n\n      console.log(`Updated 'Cover Heading' font size to ${size}pt.`);\n    });\n  } catch (error) {\n    console.error(\"Error during validation or style update:\", error);\n  }\n}\n\n/*\nCode for testing the Insert Table code\n\n*/\n\nasync function dynamicTable()\n{\n  \n   console.trace(\"dynamictable\");\n   let options = {}\n\n   options.numRows = 3;\n   options.numCols = 3;\n   options.coloredBorders = true;\n   options.lineBreaks = false;\n\n   options.headerRow = true;\n   options.firstColumn = true;\n   options.lastColumn = true;\n   options.totalRow = true;\n   options.centerAligned = true;\n\n   insertOrFormatTable(options);\n\n}\n\nasync function insertOrFormatTable(options) {\n  try {\n    await Word.run(async (context) => {\n      const selection = context.document.getSelection();\n      selection.load(\"tables\");\n      await context.sync();\n\n      // todo: this doesn't work, need to determine if in Table or not.\n      let table;\n      if (selection.tables.items.length === 0) {\n        const range = selection.insertParagraph(\"\", Word.InsertLocation.after).getRange();\n        table = range.insertTable(options.numRows, options.numCols, Word.InsertLocation.after, [[\"\"]]);\n      } else {\n        table = selection.tables.items[0];\n      }\n\n      table.load([\"rows\", \"columns\", \"style\"]);\n      await context.sync();\n\n      table.style = \"Table Text\";\n\n      if (options.coloredBorders) {\n        table.style = options.lineBreaks ? \"netwealth Combined Table4\" : \"netwealth Combined Table2\";\n      } else if (options.blackBorders) {\n        table.style = options.lineBreaks ? \"netwealth Combined Table3\" : \"netwealth Combined Table\";\n      }\n\n      if (options.headerRow) {\n        table.headerRowCount = 1;\n        const headerRow = table.rows.getFirst();\n        headerRow.load(\"cells\");\n        await context.sync();\n\n        await applyStyleToCellParagraphs(headerRow.cells.items, \"Table Heading\", context);\n\n      }\n\n      /*\n        Todo: office.js doesn't have a last column need to figure out cells by looking at\n         each row and determining the column\n      // Last Column\n      if (options.lastColumn) {\n        table.lastColumn = true;\n        const lastCol = table.columns.getLast();\n        lastCol.load(\"cells\");\n        await context.sync();\n\n        await applyStyleToCellParagraphs(lastCol.cells.items, \"Table LastColumn\", context);\n      }\n      */\n\n      /*\n      // TODO: there is no rows.getLast(); need to find ourselves\n      // Total Row\n      if (options.totalRow) {\n        table.totalRowCount = 1;\n        const lastRow = table.rows.getLast();\n        lastRow.load(\"cells\");\n        await context.sync();\n\n        await applyStyleToCellParagraphs(lastRow.cells.items, \"Table TotalRow\", context);\n      }\n      */\n\n\n      /*\n      // TODO: not loading the proper context ehre and getting errors. \n\n  if (options.centerAligned) {\n    \n      // Step 1: Load rows collection\n      table.rows.load(\"items\");\n      await context.sync();\n\n      // Step 2: Load cells for each row\n      for (const row of table.rows.items) {\n        row.load(\"cells\");\n      }\n      await context.sync();\n\n        const colCount = table.rows.items[0].cells.items.length;\n\n      // Load paragraphs in each cell (columns 2+)\n      for (const row of table.rows.items) {\n        for (let c = 1; c < colCount; c++) {\n          const cell = row.cells.items[c];\n          cell.body.paragraphs.load(\"items\");\n        }\n      }\n      await context.sync();\n\n      // Apply center alignment\n      for (const row of table.rows.items) {\n        for (let c = 1; c < colCount; c++) {\n          const cell = row.cells.items[c];\n          cell.body.paragraphs.items.forEach(p => {\n            p.paragraphFormat.alignment = Word.Alignment.center;\n          });\n        }\n      }\n      await context.sync();\n    }\n\n    */\n\n      await context.sync();\n    });\n  } catch (error) {\n    console.error(\"Error inserting or formatting table:\", error);\n    // Optional: surface error to UI\n    // showNotification(\"Table formatting failed: \" + error.message);\n  }\n}\n\nasync function applyStyleToCellParagraphs(cells, styleName, context) {\n  cells.forEach(cell => cell.load(\"body\"));\n  await context.sync();\n\n  cells.forEach(cell => {\n    const paragraphs = cell.body.paragraphs;\n    paragraphs.load(\"items\");\n  });\n  await context.sync();\n\n  cells.forEach(cell => {\n    cell.body.paragraphs.items.forEach(paragraph => {\n      paragraph.style = styleName;\n    });\n  });\n  await context.sync();\n}\n\n/**\n * Updates all fields in the main body of the document in controlled batches.\n * Adjusts the batch size based on the document's complexity and API limits.\n * todo: may be able to also filter by label such as Table, Figure, so only updates affected\n * versus all SEQ fields\n */\nasync function updateAllFieldsInBatches(fieldType = \"Seq\") {\n  await Word.run(async (context) => {\n    const batchSize = 50;\n    let totalUpdated = 0;\n\n    // Helper to update fields in a given range\n    async function updateFieldsInRange(range, label) {\n      const fields = range.fields;\n      fields.load(\"items, type\");\n      await context.sync();\n\n      const matchingFields = fields.items.filter((field) => field.type === fieldType);\n      if (matchingFields.length > 0) {\n        console.log(`Updating ${matchingFields.length} ${label} fields in batches...`);\n        for (let i = 0; i < matchingFields.length; i += batchSize) {\n          const batchEnd = Math.min(i + batchSize, matchingFields.length);\n          for (let j = i; j < batchEnd; j++) {\n            matchingFields[j].updateResult();\n          }\n          await context.sync();\n        }\n        totalUpdated += matchingFields.length;\n      }\n    }\n\n    // Update fields in the main body\n    await updateFieldsInRange(context.document.body, \"body\");\n\n    // Update fields in all headers across sections\n    const sections = context.document.sections;\n    sections.load(\"items\");\n    await context.sync();\n\n    for (const section of sections.items) {\n      const headers = [\n        section.getHeader(\"Primary\"),\n        section.getHeader(\"FirstPage\"),\n        section.getHeader(\"EvenPages\"),\n      ];\n      for (const header of headers) {\n        await updateFieldsInRange(header, \"header\");\n      }\n    }\n\n    console.log(`Finished updating ${totalUpdated} fields total.`);\n  });\n}\n\n\n\nasync function insertTableCaption(label=\"Table\") {\n\n\n  await Word.run(async (context) => {\n    const range = context.document.getSelection();\n\n    // Get the text before and after the cursor\n    range.load(\"text\");\n    await context.sync();\n\n    // Clear the current selection (like pressing Enter)\n    range.clear();\n\n    // Replace the selection with a paragraph break\n    // !!Important to have text after the \\r or else range won't update to the\n    // new paragraph for some reason.\n    range.insertText(label + \" \", Word.InsertLocation.replace)\n\n    // Move to the newly created paragraph\n    const newParagraph = range.paragraphs.getLast();\n\n    // Move the selection to the new paragraph\n    //newParagraph.select();\n\n    newParagraph.style = \"Caption\"; \n\n    // Get a range just after the inserted text\n    const afterRange = range.getRange(Word.RangeLocation.after);\n\n    // Move the selection to that position\n    afterRange.select();\n\n    await context.sync();\n  });\n\n\n\n  let sectionOoxml = `<pkg:package xmlns:pkg=\"http://schemas.microsoft.com/office/2006/xmlPackage\">\n    <pkg:part pkg:name=\"/_rels/.rels\" pkg:contentType=\"application/vnd.openxmlformats-package.relationships+xml\" pkg:padding=\"512\">\n      <pkg:xmlData>\n        <Relationships xmlns=\"http://schemas.openxmlformats.org/package/2006/relationships\">\n          <Relationship Id=\"rId1\" Type=\"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument\" Target=\"word/document.xml\"/>\n        </Relationships>\n      </pkg:xmlData>\n    </pkg:part>\n\n    <!-- The missing part: Relationships for document.xml -->\n    <pkg:part pkg:name=\"/word/_rels/document.xml.rels\" pkg:contentType=\"application/vnd.openxmlformats-package.relationships+xml\">\n      <pkg:xmlData>\n        <Relationships xmlns=\"http://schemas.openxmlformats.org/package/2006/relationships\">\n          <Relationship Id=\"rId2\" Type=\"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles\" Target=\"styles.xml\"/>\n        </Relationships>\n      </pkg:xmlData>\n    </pkg:part>\n\n\n     <!-- Add the styles definition part -->\n  <pkg:part pkg:name=\"/word/styles.xml\" pkg:contentType=\"application/vnd.openxmlformats-officedocument.wordprocessingml.styles+xml\">\n    <pkg:xmlData>\n      <w:styles xmlns:w=\"http://schemas.openxmlformats.org/wordprocessingml/2006/main\">\n      </w:styles>\n    </pkg:xmlData>\n  </pkg:part>\n\n\n    <pkg:part pkg:name=\"/word/document.xml\" pkg:contentType=\"application/vnd.openxmlformats-officedocument.wordprocessingml.document.main+xml\">\n      <pkg:xmlData>\n\n\n        <w:document xmlns:w=\"http://schemas.openxmlformats.org/wordprocessingml/2006/main\">\n          <w:body>\n\n          <w:p>\n            <!-- important the original markup is \\* but in javascript have to add \\\\* -->\n              <w:fldSimple w:instr=\" SEQ ${label} \\\\* ARABIC \">\n                  <w:r>\n                      <w:rPr>\n                          <w:noProof />\n                      </w:rPr>\n                      <w:t>1</w:t>\n                  </w:r>\n              </w:fldSimple>\n\n              <!-- Separator -->\n              <w:r>\n                <w:t xml:space=\"preserve\"> - </w:t>\n              </w:r>\n          </w:p>\n          \n          </w:body>\n        </w:document>\n\n      </pkg:xmlData>\n    </pkg:part>\n  </pkg:package>`;\n\n\n    await Word.run(async (context) => {\n  \n  try {\n    const selection = context.document.getSelection();\n    let afterRange = selection.getRange(Word.RangeLocation.after);\n    afterRange.insertOoxml(sectionOoxml, Word.InsertLocation.replace);\n\n    // Move the selection to that position\n    afterRange = afterRange.getRange(Word.RangeLocation.after);\n    afterRange.select();\n\n    await context.sync();\n    console.log(\"caption successfully.\");\n  } catch (error) {\n    console.error(\"Failed to set caption:\", error);\n    // Optional fallback: insert API-based break if OOXML fails\n  }\n\n\n/*\n  // hack location to update fields after insert\n    const field = context.document.getSelection().fields.getFirstOrNullObject();\n    field.select(); // This can help trigger the update\n    await context.sync();\n    field.updateResult();\n    await context.sync();\n*/\n  \n    /*\n    const fields = context.document.body.fields;\n    fields.load(\"items\");\n    await context.sync();\n\n    for (let field of fields.items) {\n   //   console.log(field.code); // This is the field instruction\n      field.updateResult();\n    }\n\n    context.sync();\n    */\n\n\n    /*\n    // Insert a new paragraph after the selection\n    const captionParagraph = selection.insertParagraph(\"\", Word.InsertLocation.after);\n\n    // Insert caption label and suffix\n    captionParagraph.insertText(\"Table - \", Word.InsertLocation.start);\n    await context.sync();\n\n   // todo: doens't seem to be an autotext  insertAutoText(\"InsertCaption1\");\n\n   \n    // Apply formatting\n    captionParagraph.style = \"Caption\"; // Must exist in the document\n    captionParagraph.font.bold = false;\n    */\n\n  });\n\n  // todo: bug bug still throws especially when fields have a table of contents\n  // todo: may be able to \n   await updateAllFieldsInBatches(\"Seq\");\n\n}\n\n/*\nTODO: shouldn't add the same <input> tag every time, check for existing and/or add cleanup code.\n*/\nasync function insertImageIntoWord() {\n  const input = document.createElement(\"input\");\n  input.type = \"file\";\n  input.accept = \"image/*\";\n  input.style.display = \"none\";\n\n  input.onchange = function () {\n    const file = input.files[0];\n    if (!file) return;\n\n    const reader = new FileReader();\n    reader.onload = function () {\n      const result = reader.result;\n\n      // Ensure it's a data URL and extract base64\n      const base64 = result.startsWith(\"data:image\")\n        ? result.substring(result.indexOf(\",\") + 1)\n        : null;\n\n      if (!base64) {\n        console.error(\"Invalid image format or reader result.\");\n        return;\n      }\n\n      Word.run(async (context) => {\n        const selection = context.document.getSelection();\n        selection.insertInlinePictureFromBase64(base64, Word.InsertLocation.replace);\n        await context.sync();\n\n        // Style the paragraph at the current selection\n        const paragraph = selection.paragraphs.getFirst();\n        paragraph.load(\"style\");\n        await context.sync();\n\n        // todo: VBA code set the style to \"Picture\" but that style doesn't exist. Not sure why not\n        // causing error.\n        paragraph.style = \"Normal\";\n        await context.sync();\n      });\n    };\n\n    reader.readAsDataURL(file); // Ensures result is a data URL\n  };\n\n  document.body.appendChild(input);\n  input.click();\n}\n\nasync function screenshotFormatGuide() {\n\n   // make a new paragraph where selections paragraph ends\n   await Word.run(async (context) => {\n        const selection = context.document.getSelection();\n\n        // Get the paragraph containing the selection\n        const currentParagraph = selection.paragraphs.getFirst();\n        currentParagraph.load(\"range\");\n        await context.sync();\n\n        // Move cursor to the end of that paragraph\n        const endOfParagraph = currentParagraph.getRange(Word.RangeLocation.end);\n\n        // Insert a new paragraph after it\n        const newParagraph = endOfParagraph.insertParagraph(\"\", Word.InsertLocation.after);\n\n        // Load the range of the new paragraph\n      //  const newRange = newParagraph.getRange();\n       // newRange.select(); // Move the selection to the new paragraph\n\n        // Collapse the range to its end (insertion point only)\n        // this keeps the inserted auto text from being selected when done.\n        const collapsedRange = newParagraph.getRange(Word.RangeLocation.end);\n        collapsedRange.select(); // Moves cursor without selecting content\n\n\n        await context.sync();\n\n        // Type your desired text\n        //newParagraph.insertText(\"Your text goes here.\", Word.InsertLocation.start);\n\n        await context.sync();\n      });\n\n  //    .AttachedTemplate.AutoTextEntries(\"ScreenShotFormat\").Insert Where:=Selection.Range, RichText:=True\n      insertAutoText(\"ScreenShotFormat\");\n\n}\n\n\n\nasync function getOOXML() {\n  await Word.run(async (context) => {\n    const range = context.document.getSelection();\n    const ooxml = range.getOoxml();\n    await context.sync();\n\n    const ooxmlString = ooxml.value;\n    console.log(ooxmlString); // This is your OOXML string\n\n    // Attempt to copy to clipboard\n    try {\n      await navigator.clipboard.writeText(ooxmlString);\n      console.log(\"OOXML copied to clipboard.\");\n    } catch (err) {\n      console.error(\"Failed to copy OOXML to clipboard:\", err);\n    }\n  });\n}\n\nasync function getOOXMLDocument() {\n  await Word.run(async (context) => {\n    const body = context.document.body;\n    const ooxml = body.getOoxml();\n    await context.sync();\n\n    const ooxmlString = ooxml.value;\n    console.log(ooxmlString); // This is your OOXML string\n\n    // Attempt to copy to clipboard\n    try {\n      await navigator.clipboard.writeText(ooxmlString);\n      console.log(\"Document OOXML copied to clipboard.\");\n    } catch (err) {\n      console.error(\"Failed to copy Document OOXML to clipboard:\", err);\n    }\n  });\n}\n\nasync function pasteOOXMLAsDocument() {\n  try {\n    // Read OOXML string from clipboard\n    const ooxmlString = await navigator.clipboard.readText();\n\n    await Word.run(async (context) => {\n      const body = context.document.body;\n      body.insertOoxml(ooxmlString, Word.InsertLocation.replace);\n      await context.sync();\n      console.log(\"Entire document replaced with OOXML from clipboard.\");\n    });\n  } catch (err) {\n    console.error(\"Failed to paste OOXML from clipboard:\", err);\n  }\n}\n\nasync function pasteOOXML() {\n  try {\n    // Read OOXML string from clipboard\n    const ooxmlString = await navigator.clipboard.readText();\n\n    await Word.run(async (context) => {\n      const range = context.document.getSelection();\n      range.insertOoxml(ooxmlString, Word.InsertLocation.after);\n      await context.sync();\n      console.log(\"OOXML pasted from clipboard.\");\n    });\n  } catch (err) {\n    console.error(\"Failed to paste OOXML from clipboard:\", err);\n  }\n}\n\nasync function showAlert(message) {\n   console.log(\"TODO: no alerts implemented\", message);\n   \n}\n\nasync function insertBuildingBlock(context, name, range) {\n  // Simulate AutoText via content control or template logic\n  range.select();\n  await context.sync();\n\n  // TODO: CONSIDER THE RANGE BEING PASSED TO INSERT AUTOTEXT\n  await insertAutoText(name);\n}\n\nfunction isValidBookmarkName(name) {\n  // Must start with a letter and contain only letters, numbers, or underscores\n  return /^[A-Za-z][A-Za-z0-9_]*$/.test(name);\n}\n\nasync function bookmarkExists(bookmarkName ) {\n  if (!isValidBookmarkName(bookmarkName)) {\n    console.warn(`Bookmark name \"${bookmarkName}\" is unsafe for Office.js`);\n    return false;\n  }\n\n  let exists = false;\n\n  try {\n    await Word.run(async (ctx) => {\n      const range = ctx.document.getBookmarkRangeOrNullObject(bookmarkName);\n      range.load();\n      await ctx.sync();\n\n    //  exists = typeof range.text === \"string\";\n      exists = true;\n    });\n  } catch (error) {\n    console.warn(`Bookmark lookup failed for \"${bookmarkName}\":`, error);\n    exists = false;\n  }\n\n  return exists;\n}\n\n/* todo bug bug this doesn't work. and break downstream rich api calls.\n*/\nasync function insertSectionBreakAtSelection(context, type = \"nextPage\") {\n  const selection = context.document.getSelection();\n  await context.sync();\n\n  // todo: there is an InsertBreak support for sections, should be able to use.\n//  selection.insertBreak(Word.BreakType.sectionNext, Word.InsertLocation.after);\n // await context.sync();\n\n\n \n\n// <w:type w:val=\"continuous\"/>\n// TODO: NEEDS TO BE TESTED,  SEEMS TO WORK FOR INSERTING SECTION BUT \n// didn't seem to pick up properties.\n\nlet sectionOoxml = `<pkg:package xmlns:pkg=\"http://schemas.microsoft.com/office/2006/xmlPackage\">\n  <pkg:part pkg:name=\"/_rels/.rels\" pkg:contentType=\"application/vnd.openxmlformats-package.relationships+xml\" pkg:padding=\"512\">\n    <pkg:xmlData>\n      <Relationships xmlns=\"http://schemas.openxmlformats.org/package/2006/relationships\">\n        <Relationship Id=\"rId1\" Type=\"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument\" Target=\"word/document.xml\"/>\n      </Relationships>\n    </pkg:xmlData>\n  </pkg:part>\n  <pkg:part pkg:name=\"/word/document.xml\" pkg:contentType=\"application/vnd.openxmlformats-officedocument.wordprocessingml.document.main+xml\">\n    <pkg:xmlData>\n      <w:document xmlns:w=\"http://schemas.openxmlformats.org/wordprocessingml/2006/main\" >\n        <w:body>\n          <w:p>\n            <w:pPr>\n              <w:sectPr>\n                <w:type w:val=\"nextPage\"/>\n              </w:sectPr>\n            </w:pPr>\n          </w:p>\n        </w:body>\n      </w:document>\n    </pkg:xmlData>\n  </pkg:part>\n</pkg:package>`;\n\n \n\n  try {\n    selection.insertOoxml(sectionOoxml, Word.InsertLocation.after);\n    await context.sync();\n    console.log(\"Section break inserted successfully.\");\n  } catch (error) {\n    console.error(\"Failed to insert section break:\", error);\n    // Optional fallback: insert API-based break if OOXML fails\n  }\n\n\n// doc part body test with image\n// !!! overwrites the image if already one at path but also need to provide so need to figure out\n//   best way to handle. Fine as long as user is working on same template OOXML is generated from.\nsectionOoxml = `<pkg:package xmlns:pkg=\"http://schemas.microsoft.com/office/2006/xmlPackage\">\n  <pkg:part pkg:name=\"/_rels/.rels\" pkg:contentType=\"application/vnd.openxmlformats-package.relationships+xml\" pkg:padding=\"512\">\n    <pkg:xmlData>\n      <Relationships xmlns=\"http://schemas.openxmlformats.org/package/2006/relationships\">\n        <Relationship Id=\"rId1\" Type=\"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument\" Target=\"word/document.xml\"/>\n      </Relationships>\n    </pkg:xmlData>\n  </pkg:part>\n  <pkg:part pkg:name=\"/word/_rels/document.xml.rels\"\n          pkg:contentType=\"application/vnd.openxmlformats-package.relationships+xml\">\n    <pkg:xmlData>\n      <Relationships xmlns=\"http://schemas.openxmlformats.org/package/2006/relationships\">\n        <Relationship Id=\"rId5\"\n                      Type=\"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image\"\n                      Target=\"media/image1.png\"/>\n      </Relationships>\n    </pkg:xmlData>\n  </pkg:part>\n\n  <pkg:part pkg:name=\"/word/media/image1.png\"\n            pkg:contentType=\"image/png\"\n            pkg:compression=\"store\">\n    <pkg:binaryData>\n      iVBORw0KGgoAAAANSUhEUgAAAAoAAAAKCAIAAAACUFjqAAAAFElEQVR42mP8z8AARAwMDPz//x8AAgMBAf0FhVgAAAAASUVORK5CYII=\n    </pkg:binaryData>\n  </pkg:part>\n\n  <pkg:part pkg:name=\"/word/document.xml\" pkg:contentType=\"application/vnd.openxmlformats-officedocument.wordprocessingml.document.main+xml\">\n    <pkg:xmlData>\n      <w:document xmlns:wpc=\"http://schemas.microsoft.com/office/word/2010/wordprocessingCanvas\"\n                    xmlns:cx=\"http://schemas.microsoft.com/office/drawing/2014/chartex\"\n                    xmlns:cx1=\"http://schemas.microsoft.com/office/drawing/2015/9/8/chartex\"\n                    xmlns:cx2=\"http://schemas.microsoft.com/office/drawing/2015/10/21/chartex\"\n                    xmlns:cx3=\"http://schemas.microsoft.com/office/drawing/2016/5/9/chartex\"\n                    xmlns:cx4=\"http://schemas.microsoft.com/office/drawing/2016/5/10/chartex\"\n                    xmlns:cx5=\"http://schemas.microsoft.com/office/drawing/2016/5/11/chartex\"\n                    xmlns:cx6=\"http://schemas.microsoft.com/office/drawing/2016/5/12/chartex\"\n                    xmlns:cx7=\"http://schemas.microsoft.com/office/drawing/2016/5/13/chartex\"\n                    xmlns:cx8=\"http://schemas.microsoft.com/office/drawing/2016/5/14/chartex\"\n                    xmlns:mc=\"http://schemas.openxmlformats.org/markup-compatibility/2006\"\n                    xmlns:aink=\"http://schemas.microsoft.com/office/drawing/2016/ink\"\n                    xmlns:am3d=\"http://schemas.microsoft.com/office/drawing/2017/model3d\"\n                    xmlns:o=\"urn:schemas-microsoft-com:office:office\"\n                    xmlns:oel=\"http://schemas.microsoft.com/office/2019/extlst\"\n                    xmlns:r=\"http://schemas.openxmlformats.org/officeDocument/2006/relationships\"\n                    xmlns:m=\"http://schemas.openxmlformats.org/officeDocument/2006/math\"\n                    xmlns:v=\"urn:schemas-microsoft-com:vml\"\n                    xmlns:wp14=\"http://schemas.microsoft.com/office/word/2010/wordprocessingDrawing\"\n                    xmlns:wp=\"http://schemas.openxmlformats.org/drawingml/2006/wordprocessingDrawing\"\n                    xmlns:w10=\"urn:schemas-microsoft-com:office:word\"\n                    xmlns:w=\"http://schemas.openxmlformats.org/wordprocessingml/2006/main\"\n                    xmlns:w14=\"http://schemas.microsoft.com/office/word/2010/wordml\"\n                    xmlns:w15=\"http://schemas.microsoft.com/office/word/2012/wordml\"\n                    xmlns:w16cex=\"http://schemas.microsoft.com/office/word/2018/wordml/cex\"\n                    xmlns:w16cid=\"http://schemas.microsoft.com/office/word/2016/wordml/cid\"\n                    xmlns:w16=\"http://schemas.microsoft.com/office/word/2018/wordml\"\n                    xmlns:w16du=\"http://schemas.microsoft.com/office/word/2023/wordml/word16du\"\n                    xmlns:w16sdtdh=\"http://schemas.microsoft.com/office/word/2020/wordml/sdtdatahash\"\n                    xmlns:w16sdtfl=\"http://schemas.microsoft.com/office/word/2024/wordml/sdtformatlock\"\n                    xmlns:w16se=\"http://schemas.microsoft.com/office/word/2015/wordml/symex\"\n                    xmlns:wpg=\"http://schemas.microsoft.com/office/word/2010/wordprocessingGroup\"\n                    xmlns:wpi=\"http://schemas.microsoft.com/office/word/2010/wordprocessingInk\"\n                    xmlns:wne=\"http://schemas.microsoft.com/office/word/2006/wordml\"\n                    xmlns:wps=\"http://schemas.microsoft.com/office/word/2010/wordprocessingShape\"\n                    mc:Ignorable=\"w14 w15 w16se w16cid w16 w16cex w16sdtdh w16sdtfl w16du wp14\">\n        <w:body>\n              <w:p w:rsidR=\"00E93316\"\n                     w:rsidRDefault=\"003503CB\"\n                     w:rsidP=\"003503CB\">\n                    <w:r>\n                        <w:drawing>\n                            <wp:inline distT=\"0\"\n                                       distB=\"0\"\n                                       distL=\"0\"\n                                       distR=\"0\"\n                                       wp14:anchorId=\"2A7721B7\"\n                                       wp14:editId=\"375537C8\" xmlns:wp=\"http://schemas.openxmlformats.org/drawingml/2006/wordprocessingDrawing\" xmlns:wp14=\"http://schemas.microsoft.com/office/word/2010/wordprocessingDrawing\">\n                                <wp:extent cx=\"1238423\"\n                                           cy=\"447737\" />\n                                <wp:effectExtent l=\"0\"\n                                                 t=\"0\"\n                                                 r=\"0\"\n                                                 b=\"0\" />\n                                <wp:docPr id=\"7\"\n                                          name=\"Picture 1\" />\n                                <wp:cNvGraphicFramePr>\n                                    <a:graphicFrameLocks xmlns:a=\"http://schemas.openxmlformats.org/drawingml/2006/main\"\n                                                         noChangeAspect=\"1\" />\n                                </wp:cNvGraphicFramePr>\n                                <a:graphic xmlns:a=\"http://schemas.openxmlformats.org/drawingml/2006/main\">\n                                    <a:graphicData uri=\"http://schemas.openxmlformats.org/drawingml/2006/picture\">\n                                        <pic:pic xmlns:pic=\"http://schemas.openxmlformats.org/drawingml/2006/picture\">\n                                            <pic:nvPicPr>\n                                                <pic:cNvPr id=\"7\"\n                                                           name=\"logo.png\" />\n                                                <pic:cNvPicPr />\n                                            </pic:nvPicPr>\n                                            <pic:blipFill>\n                                                <a:blip r:embed=\"rId5\" />\n                                                <a:stretch>\n                                                    <a:fillRect />\n                                                </a:stretch>\n                                            </pic:blipFill>\n                                            <pic:spPr>\n                                                <a:xfrm>\n                                                    <a:off x=\"0\"\n                                                           y=\"0\" />\n                                                    <a:ext cx=\"1238423\"\n                                                           cy=\"447737\" />\n                                                </a:xfrm>\n                                                <a:prstGeom prst=\"rect\">\n                                                    <a:avLst />\n                                                </a:prstGeom>\n                                            </pic:spPr>\n                                        </pic:pic>\n                                    </a:graphicData>\n                                </a:graphic>\n                            </wp:inline>\n                        </w:drawing>\n                    </w:r>\n                </w:p>\n        </w:body>\n      </w:document>\n    </pkg:xmlData>\n  </pkg:part>\n</pkg:package>`\n\n\n// end doc part body test\n/*\n\n  try {\n    selection.insertOoxml(sectionOoxml, Word.InsertLocation.after);\n    await context.sync();\n    console.log(\"Section break inserted successfully.\");\n  } catch (error) {\n    console.error(\"Failed to insert section break:\", error);\n    // Optional fallback: insert API-based break if OOXML fails\n  }\n    */\n\n  // todo: tried inserting a document fragment but it always failed. \n}\n\n\nfunction insertPageBreakAtSelection() {\n  Word.run(async (context) => {\n    const range = context.document.getSelection();\n    range.insertBreak(Word.BreakType.page, Word.InsertLocation.after);\n    await context.sync();\n  }).catch((error) => {\n    console.error(\"Failed to insert page break:\", error);\n  });\n}\n\n// test so can know if wrote values correctly\nasync function readCoverProperties() {\n  await Word.run(async (context) => {\n    const props = context.document.properties.customProperties;\n\n    // Load the collection so we can query safely\n    props.load(\"items\");\n    await context.sync();\n\n    const keys = [\n      \"CoverHeading\",\n      \"CoverHeading2\",\n      \"CoverHeading3\",\n      \"CoverDate\"\n    ];\n\n    for (const key of keys) {\n      const prop = props.getItemOrNullObject(key);\n      prop.load(\"value\");\n      await context.sync();\n\n      if (prop.isNullObject) {\n        console.log(`Property \"${key}\" not found.`);\n      } else {\n        console.log(`Property \"${key}\" = \"${prop.value}\"`);\n      }\n    }\n  }).catch((error) => {\n    console.error(\"Failed to read custom properties:\", error);\n  });\n}\n\nasync function updateTOC() {\n\n  await Word.run(async (context) => {\n    // todo: review, original VBA seemed to have more logic\n    await updateAllFieldsInBatches(\"TOC\");\n  }).catch((error) => {\n    console.error(\"TOC update failed:\", error);\n  });\n}\n\nasync function insertFigureCaption() {\n  await insertTableCaption(\"Figure\")\n}\n\n// todo: this doesn't really seem to work very well. may work if \nasync function getCurrentSection(context) {\n  const selection = context.document.getSelection();\n  const sections = context.document.sections;\n  sections.load(\"items\");\n  await context.sync();\n\n  for (let section of sections.items) {\n    const range = section.body.getRange(\"Whole\");\n    await context.sync();\n\n    const startsAfter = selection.compareLocationWith(range, Word.LocationRelation.after);\n    const endsBefore = selection.compareLocationWith(range, Word.LocationRelation.before);\n    await context.sync();\n\n    if (!startsAfter && !endsBefore) {\n      return section;\n    }\n  }\n\n  throw new Error(\"Current section not found.\");\n}\n\nasync function getSectionIndexFromSelection() {\n  return await Word.run(async (context) => {\n    const selection = context.document.getSelection();\n    const selectionRange = selection.getRange();\n    selectionRange.load(\"text\");\n\n    const sections = context.document.sections;\n    sections.load(\"items\");\n\n    await context.sync();\n\n    for (let i = 0; i < sections.items.length; i++) {\n      const sectionBodyRange = sections.items[i].body.getRange();\n      sectionBodyRange.load(\"text\");\n\n      await context.sync();\n\n      const location = selectionRange.compareLocationWith(sectionBodyRange);\n\n      await context.sync();\n\n      if (location.value ===  Word.LocationRelation.inside || location.value === Word.LocationRelation.equal) {\n        console.log(`Selection is in section ${i}`);\n        return i;\n      }\n    }\n\n    console.log(\"Selection not found in any section.\");\n    return -1;\n  });\n}\n\nasync function a4Orientation() {\n\n  // todo: make sure this hands selections across section boundaries logically.\n  let sectionIndex = await getSectionIndexFromSelection();\n  console.log(sectionIndex);\n  \n  if (sectionIndex < 0) {\n    console.log(\"selection is not within a section. todo: show alert\");\n    return;\n  }\n\n  // todo: bug bug need a way to see if all these are set and need to restore each one\n  // todo: could also include headers as part of big insert ooxml and why the\n  // first header and other settings aren't also reset and how to check if \n  // need to set.\n  let headerOoxml = null;\n  let footerOoxml = null;\n\n  let firstPageheaderOoxml = null;\n  let firstPagefooterOoxml= null;\n\n\n  await Word.run(async (context) => {\n    // Get the sections collection of the document.\n    const sections = context.document.sections;\n\n    // Load the items from the sections collection.\n    sections.load('items');\n    await context.sync();\n\n    // Get the current sections header and footer \n    const secondSection = sections.items[sectionIndex];\n\n    // Get the primary header and footer bodies for the second section.\n    const primaryHeader = secondSection.getHeader(Word.HeaderFooterType.primary);\n    const primaryFooter = secondSection.getFooter(Word.HeaderFooterType.primary);\n\n    // Get the OOXML representation of the header and footer bodies.\n    let zheaderOoxml = primaryHeader.getOoxml();\n    let zfooterOoxml = primaryFooter.getOoxml();\n\n    // Sync the document state to get the OOXML values.\n    await context.sync();\n\n    headerOoxml = zheaderOoxml.value;\n    footerOoxml = zfooterOoxml.value;\n\n    // TODO: BUG BUG, SHOW ALSO GET THE oddPages so cover all potential header cases.\n\n     // Get the FIRST header and footer bodies for the second section.\n    const firstHeader = secondSection.getHeader(Word.HeaderFooterType.firstPage);\n    const firstFooter = secondSection.getFooter(Word.HeaderFooterType.firstPage);\n\n    // Get the OOXML representation of the header and footer bodies.\n    let zheaderOoxml2 = firstHeader.getOoxml();\n    let zfooterOoxml2 = firstFooter.getOoxml();\n\n    // Sync the document state to get the OOXML values.\n    await context.sync();\n\n\n    firstPageheaderOoxml = zheaderOoxml2.value;\n    firstPagefooterOoxml = zfooterOoxml2.value;\n\n    /*\n    // Log the OOXML values to the console.\n    console.log('Primary Header OOXML for the second section:');\n    console.log(headerOoxml.value);\n    console.log('Primary Footer OOXML for the second section:');\n    console.log(footerOoxml.value);\n    */\n\n    /*\n    // now flip the content\n     const firstSection = sections.items[0];\n\n    const FprimaryHeader = firstSection.getHeader(Word.HeaderFooterType.primary);\n    const FprimaryFooter = firstSection.getFooter(Word.HeaderFooterType.primary);\n\n    FprimaryHeader.insertOoxml(headerOoxml.value, Word.InsertLocation.replace);\n    FprimaryFooter.insertOoxml(footerOoxml.value, Word.InsertLocation.replace);\n\n    await context.sync();\n    */\n  \n  }).catch((error) => {\n    console.error('An error occurred:', error);\n  });\n\n\n\n  //console.log(\"TODO: A4 rotate not yet implemented\");\n  // return;\n\nlet sectionOoxml = `<pkg:package xmlns:pkg=\"http://schemas.microsoft.com/office/2006/xmlPackage\">\n    <pkg:part pkg:name=\"/_rels/.rels\"\n              pkg:contentType=\"application/vnd.openxmlformats-package.relationships+xml\"\n              pkg:padding=\"512\">\n        <pkg:xmlData>\n            <Relationships xmlns=\"http://schemas.openxmlformats.org/package/2006/relationships\">\n                <Relationship Id=\"rId1\"\n                              Type=\"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument\"\n                              Target=\"word/document.xml\" />\n            </Relationships>\n        </pkg:xmlData>\n    </pkg:part>\n    <pkg:part pkg:name=\"/word/_rels/document.xml.rels\"\n              pkg:contentType=\"application/vnd.openxmlformats-package.relationships+xml\">\n        <pkg:xmlData>\n            <Relationships xmlns=\"http://schemas.openxmlformats.org/package/2006/relationships\">\n\n                <Relationship Id=\"rId7\"\n                              Type=\"http://schemas.openxmlformats.org/officeDocument/2006/relationships/footer\"\n                              Target=\"footer1.xml\" />\n                <Relationship Id=\"rId6\"\n                              Type=\"http://schemas.openxmlformats.org/officeDocument/2006/relationships/header\"\n                              Target=\"header1.xml\" />\n\n                <Relationship Id=\"rHeader10\"\n                              Type=\"http://schemas.openxmlformats.org/officeDocument/2006/relationships/header\"\n                              Target=\"header10.xml\" />\n                <Relationship Id=\"rFooter10\"\n                              Type=\"http://schemas.openxmlformats.org/officeDocument/2006/relationships/footer\"\n                              Target=\"footer10.xml\" />\n                <Relationship Id=\"rHeader20\"\n                              Type=\"http://schemas.openxmlformats.org/officeDocument/2006/relationships/header\"\n                              Target=\"header20.xml\" />\n                <Relationship Id=\"rFooter20\"\n                              Type=\"http://schemas.openxmlformats.org/officeDocument/2006/relationships/footer\"\n                              Target=\"footer20.xml\" />\n            </Relationships>\n        </pkg:xmlData>\n    </pkg:part>\n\n        <pkg:part pkg:name=\"/word/header1.xml\"\n              pkg:contentType=\"application/vnd.openxmlformats-officedocument.wordprocessingml.header+xml\">\n        <pkg:xmlData>\n            <w:hdr xmlns:wpc=\"http://schemas.microsoft.com/office/word/2010/wordprocessingCanvas\"\n                   xmlns:cx=\"http://schemas.microsoft.com/office/drawing/2014/chartex\"\n                   xmlns:cx1=\"http://schemas.microsoft.com/office/drawing/2015/9/8/chartex\"\n                   xmlns:cx2=\"http://schemas.microsoft.com/office/drawing/2015/10/21/chartex\"\n                   xmlns:cx3=\"http://schemas.microsoft.com/office/drawing/2016/5/9/chartex\"\n                   xmlns:cx4=\"http://schemas.microsoft.com/office/drawing/2016/5/10/chartex\"\n                   xmlns:cx5=\"http://schemas.microsoft.com/office/drawing/2016/5/11/chartex\"\n                   xmlns:cx6=\"http://schemas.microsoft.com/office/drawing/2016/5/12/chartex\"\n                   xmlns:cx7=\"http://schemas.microsoft.com/office/drawing/2016/5/13/chartex\"\n                   xmlns:cx8=\"http://schemas.microsoft.com/office/drawing/2016/5/14/chartex\"\n                   xmlns:mc=\"http://schemas.openxmlformats.org/markup-compatibility/2006\"\n                   xmlns:aink=\"http://schemas.microsoft.com/office/drawing/2016/ink\"\n                   xmlns:am3d=\"http://schemas.microsoft.com/office/drawing/2017/model3d\"\n                   xmlns:o=\"urn:schemas-microsoft-com:office:office\"\n                   xmlns:oel=\"http://schemas.microsoft.com/office/2019/extlst\"\n                   xmlns:r=\"http://schemas.openxmlformats.org/officeDocument/2006/relationships\"\n                   xmlns:m=\"http://schemas.openxmlformats.org/officeDocument/2006/math\"\n                   xmlns:v=\"urn:schemas-microsoft-com:vml\"\n                   xmlns:wp14=\"http://schemas.microsoft.com/office/word/2010/wordprocessingDrawing\"\n                   xmlns:wp=\"http://schemas.openxmlformats.org/drawingml/2006/wordprocessingDrawing\"\n                   xmlns:w10=\"urn:schemas-microsoft-com:office:word\"\n                   xmlns:w=\"http://schemas.openxmlformats.org/wordprocessingml/2006/main\"\n                   xmlns:w14=\"http://schemas.microsoft.com/office/word/2010/wordml\"\n                   xmlns:w15=\"http://schemas.microsoft.com/office/word/2012/wordml\"\n                   xmlns:w16cex=\"http://schemas.microsoft.com/office/word/2018/wordml/cex\"\n                   xmlns:w16cid=\"http://schemas.microsoft.com/office/word/2016/wordml/cid\"\n                   xmlns:w16=\"http://schemas.microsoft.com/office/word/2018/wordml\"\n                   xmlns:w16du=\"http://schemas.microsoft.com/office/word/2023/wordml/word16du\"\n                   xmlns:w16sdtdh=\"http://schemas.microsoft.com/office/word/2020/wordml/sdtdatahash\"\n                   xmlns:w16sdtfl=\"http://schemas.microsoft.com/office/word/2024/wordml/sdtformatlock\"\n                   xmlns:w16se=\"http://schemas.microsoft.com/office/word/2015/wordml/symex\"\n                   xmlns:wpg=\"http://schemas.microsoft.com/office/word/2010/wordprocessingGroup\"\n                   xmlns:wpi=\"http://schemas.microsoft.com/office/word/2010/wordprocessingInk\"\n                   xmlns:wne=\"http://schemas.microsoft.com/office/word/2006/wordml\"\n                   xmlns:wps=\"http://schemas.microsoft.com/office/word/2010/wordprocessingShape\"\n                   mc:Ignorable=\"w14 w15 w16se w16cid w16 w16cex w16sdtdh w16sdtfl w16du wp14\">\n            </w:hdr>\n        </pkg:xmlData>\n    </pkg:part>\n\n       <pkg:part pkg:name=\"/word/footer1.xml\"\n              pkg:contentType=\"application/vnd.openxmlformats-officedocument.wordprocessingml.footer+xml\">\n        <pkg:xmlData>\n            <w:ftr xmlns:wpc=\"http://schemas.microsoft.com/office/word/2010/wordprocessingCanvas\"\n                   xmlns:cx=\"http://schemas.microsoft.com/office/drawing/2014/chartex\"\n                   xmlns:cx1=\"http://schemas.microsoft.com/office/drawing/2015/9/8/chartex\"\n                   xmlns:cx2=\"http://schemas.microsoft.com/office/drawing/2015/10/21/chartex\"\n                   xmlns:cx3=\"http://schemas.microsoft.com/office/drawing/2016/5/9/chartex\"\n                   xmlns:cx4=\"http://schemas.microsoft.com/office/drawing/2016/5/10/chartex\"\n                   xmlns:cx5=\"http://schemas.microsoft.com/office/drawing/2016/5/11/chartex\"\n                   xmlns:cx6=\"http://schemas.microsoft.com/office/drawing/2016/5/12/chartex\"\n                   xmlns:cx7=\"http://schemas.microsoft.com/office/drawing/2016/5/13/chartex\"\n                   xmlns:cx8=\"http://schemas.microsoft.com/office/drawing/2016/5/14/chartex\"\n                   xmlns:mc=\"http://schemas.openxmlformats.org/markup-compatibility/2006\"\n                   xmlns:aink=\"http://schemas.microsoft.com/office/drawing/2016/ink\"\n                   xmlns:am3d=\"http://schemas.microsoft.com/office/drawing/2017/model3d\"\n                   xmlns:o=\"urn:schemas-microsoft-com:office:office\"\n                   xmlns:oel=\"http://schemas.microsoft.com/office/2019/extlst\"\n                   xmlns:r=\"http://schemas.openxmlformats.org/officeDocument/2006/relationships\"\n                   xmlns:m=\"http://schemas.openxmlformats.org/officeDocument/2006/math\"\n                   xmlns:v=\"urn:schemas-microsoft-com:vml\"\n                   xmlns:wp14=\"http://schemas.microsoft.com/office/word/2010/wordprocessingDrawing\"\n                   xmlns:wp=\"http://schemas.openxmlformats.org/drawingml/2006/wordprocessingDrawing\"\n                   xmlns:w10=\"urn:schemas-microsoft-com:office:word\"\n                   xmlns:w=\"http://schemas.openxmlformats.org/wordprocessingml/2006/main\"\n                   xmlns:w14=\"http://schemas.microsoft.com/office/word/2010/wordml\"\n                   xmlns:w15=\"http://schemas.microsoft.com/office/word/2012/wordml\"\n                   xmlns:w16cex=\"http://schemas.microsoft.com/office/word/2018/wordml/cex\"\n                   xmlns:w16cid=\"http://schemas.microsoft.com/office/word/2016/wordml/cid\"\n                   xmlns:w16=\"http://schemas.microsoft.com/office/word/2018/wordml\"\n                   xmlns:w16du=\"http://schemas.microsoft.com/office/word/2023/wordml/word16du\"\n                   xmlns:w16sdtdh=\"http://schemas.microsoft.com/office/word/2020/wordml/sdtdatahash\"\n                   xmlns:w16sdtfl=\"http://schemas.microsoft.com/office/word/2024/wordml/sdtformatlock\"\n                   xmlns:w16se=\"http://schemas.microsoft.com/office/word/2015/wordml/symex\"\n                   xmlns:wpg=\"http://schemas.microsoft.com/office/word/2010/wordprocessingGroup\"\n                   xmlns:wpi=\"http://schemas.microsoft.com/office/word/2010/wordprocessingInk\"\n                   xmlns:wne=\"http://schemas.microsoft.com/office/word/2006/wordml\"\n                   xmlns:wps=\"http://schemas.microsoft.com/office/word/2010/wordprocessingShape\"\n                   mc:Ignorable=\"w14 w15 w16se w16cid w16 w16cex w16sdtdh w16sdtfl w16du wp14\">\n            </w:ftr>\n        </pkg:xmlData>\n    </pkg:part>\n    \n    <!-- Header part with linkToPrevious set to false -->\n    <pkg:part pkg:name=\"/word/header10.xml\"\n              pkg:contentType=\"application/vnd.openxmlformats-officedocument.wordprocessingml.header+xml\">\n        <pkg:xmlData>\n            <w:hdr xmlns:w=\"http://schemas.openxmlformats.org/wordprocessingml/2006/main\">\n                <w:linkToPrevious w:val=\"false\" />\n            </w:hdr>\n        </pkg:xmlData>\n    </pkg:part>\n    <!-- Footer part with linkToPrevious set to false -->\n    <pkg:part pkg:name=\"/word/footer10.xml\"\n              pkg:contentType=\"application/vnd.openxmlformats-officedocument.wordprocessingml.footer+xml\">\n        <pkg:xmlData>\n            <w:ftr xmlns:w=\"http://schemas.openxmlformats.org/wordprocessingml/2006/main\">\n                <w:linkToPrevious w:val=\"false\" />\n            </w:ftr>\n        </pkg:xmlData>\n    </pkg:part>\n    <!-- Header part with linkToPrevious set to false -->\n    <pkg:part pkg:name=\"/word/header20.xml\"\n              pkg:contentType=\"application/vnd.openxmlformats-officedocument.wordprocessingml.header+xml\">\n        <pkg:xmlData>\n            <w:hdr xmlns:w=\"http://schemas.openxmlformats.org/wordprocessingml/2006/main\">\n                <w:linkToPrevious w:val=\"false\" />\n            </w:hdr>\n        </pkg:xmlData>\n    </pkg:part>\n    <!-- Footer part with linkToPrevious set to false -->\n    <pkg:part pkg:name=\"/word/footer20.xml\"\n              pkg:contentType=\"application/vnd.openxmlformats-officedocument.wordprocessingml.footer+xml\">\n        <pkg:xmlData>\n            <w:ftr xmlns:w=\"http://schemas.openxmlformats.org/wordprocessingml/2006/main\">\n                <w:linkToPrevious w:val=\"false\" />\n            </w:ftr>\n        </pkg:xmlData>\n    </pkg:part>\n    <pkg:part pkg:name=\"/word/document.xml\"\n              pkg:contentType=\"application/vnd.openxmlformats-officedocument.wordprocessingml.document.main+xml\">\n        <pkg:xmlData>\n            <w:document xmlns:w=\"http://schemas.openxmlformats.org/wordprocessingml/2006/main\"\n                        xmlns:r=\"http://schemas.openxmlformats.org/officeDocument/2006/relationships\">\n                <w:body>\n\t\t\t\t\t<!-- drop in a section to preserve current formatting. -->\n                    <w:p></w:p>\n                    <w:p>\n                        <w:pPr>\n                            <w:sectPr w:rsidR=\"00000000\"\n                                    w:rsidSect=\"00293608\">\n                                <w:headerReference w:type=\"default\"\n                                                r:id=\"rId6\" />\n                                <w:footerReference w:type=\"default\"\n                                                r:id=\"rId7\" />\n                                <w:pgSz w:w=\"12240\"\n                                        w:h=\"15840\" />\n                                <w:pgMar w:top=\"1440\"\n                                        w:right=\"1440\"\n                                        w:bottom=\"1440\"\n                                        w:left=\"1440\"\n                                        w:header=\"720\"\n                                        w:footer=\"720\"\n                                        w:gutter=\"0\" />\n                                <w:cols w:space=\"720\" />\n                                <w:docGrid w:linePitch=\"360\" />\n                            </w:sectPr>\n                        </w:pPr>\n                    </w:p>\n                    <w:p></w:p>\n                    <w:p></w:p>\n                    <w:p w:rsidR=\"00895336\"\n                         w:rsidRDefault=\"00895336\">\n                        <w:pPr>\n                            <w:sectPr w:rsidR=\"00895336\"\n                                      w:rsidSect=\"00895336\">\n                                <w:pgSz w:w=\"16838\"\n                                        w:h=\"11906\"\n                                        w:orient=\"landscape\" />\n                                <w:headerReference w:type=\"default\"\n                                                   r:id=\"rHeader20\" />\n                                <w:footerReference w:type=\"default\"\n                                                   r:id=\"rFooter20\" />\n                            </w:sectPr>\n                        </w:pPr>\n                    </w:p>\n                    <w:sectPr >\n                    </w:sectPr>\n                </w:body>\n            </w:document>\n        </pkg:xmlData>\n    </pkg:part>\n</pkg:package>`;\n\n \n\n  await Word.run(async (context) => {\n  try {\n\n    let selection = context.document.getSelection();\n    /*\n    \n\n    // Theory is if i insert a break above then word will do the proper copy/paste of the \n    // header so if first break in document the header/footer will copy correctly.\n    selection.insertBreak(Word.BreakType.sectionNext, Word.InsertLocation.after);\n    await context.sync();\n\n\n      // Move to the new location after the break\n    selection = selection.getRange(Word.RangeLocation.after);\n    selection.insertText(\"selection location after insert\", Word.InsertLocation.start);\n    await context.sync();\n     */\n\n    selection.insertOoxml(sectionOoxml, Word.InsertLocation.after);\n    await context.sync();\n\n    console.log(\"Section break inserted successfully.\");\n\n  \n\n  } catch (error) {\n    console.error(\"Failed to insert section break:\", error);\n    // Optional fallback: insert API-based break if OOXML fails\n  }\n    });\n\n\n    // okay now restore the headers and footers\n    // making some assumptions that the sections are sequential now in the collction.\n\n\n  await Word.run(async (context) => {\n      // Get the sections collection of the document.\n      // Get the sections collection of the document.\n      const sections = context.document.sections;\n\n      // Load the items from the sections collection.\n      sections.load('items');\n      await context.sync();\n\n      // restore original header footer on section which was removed by the unlink \n      let firstSection = sections.items[sectionIndex];\n\n      let FprimaryHeader = firstSection.getHeader(Word.HeaderFooterType.primary);\n      let FprimaryFooter = firstSection.getFooter(Word.HeaderFooterType.primary);\n\n      FprimaryHeader.insertOoxml(headerOoxml, Word.InsertLocation.replace);\n      FprimaryFooter.insertOoxml(footerOoxml, Word.InsertLocation.replace);\n\n\n      await context.sync();\n\n      // set the first page header  firstPageheaderOoxml = zheaderOoxml.value; firstPagefooterOoxml = zfooterOoxml.value;\n      FprimaryHeader = firstSection.getHeader(Word.HeaderFooterType.firstPage);\n      FprimaryFooter = firstSection.getFooter(Word.HeaderFooterType.firstPage);\n\n      FprimaryHeader.insertOoxml(firstPageheaderOoxml, Word.InsertLocation.replace);\n      FprimaryFooter.insertOoxml(firstPagefooterOoxml, Word.InsertLocation.replace);\n\n\n      await context.sync();\n\n      // hack, set first page header on next section in case first of document\n      // that has the different first page we don't have a way to currently reset it.\n      // todo: some new word api looks like may be way to turn off.\n      firstSection = sections.items[sectionIndex + 2];\n\n      FprimaryHeader = firstSection.getHeader(Word.HeaderFooterType.firstPage);\n      FprimaryFooter = firstSection.getFooter(Word.HeaderFooterType.firstPage);\n\n      FprimaryHeader.insertOoxml(headerOoxml, Word.InsertLocation.replace);\n      FprimaryFooter.insertOoxml(footerOoxml, Word.InsertLocation.replace);\n\n      await context.sync();\n\n\n    }).catch((error) => {\n      console.error('An error occurred:', error);\n    });\n\n    // Todo: the example template VBA seems to always insert a single header regardless\n    // of the template choice with autotext Header_Landscape\n\n  let landscapeHeaderOOXML = await getAutoTextOOXML(\"Header_Landscape\");\n  await Word.run(async (context) => {\n      // Get the sections collection of the document.\n      // Get the sections collection of the document.\n      const sections = context.document.sections;\n\n      // Load the items from the sections collection.\n      sections.load('items');\n      await context.sync();\n\n      \n      // now lets setup the wide orientation.\n      // TODO: CODE ASSUMES that this method run when page in portrait.\n      let newSection = sections.items[sectionIndex + 1];\n\n      let primaryHeader = newSection.getHeader(Word.HeaderFooterType.primary);\n      let primaryFooter = newSection.getFooter(Word.HeaderFooterType.primary);\n\n      primaryHeader.insertOoxml(landscapeHeaderOOXML, Word.InsertLocation.replace);\n\n      // footer use the same ooxml\n      primaryFooter.insertOoxml(footerOoxml, Word.InsertLocation.replace);\n\n      await context.sync();\n    }).catch((error) => {\n      console.error('An error occurred:', error);\n    });\n  \n\n    // update fields that may be in the header or need to update for the new page insert.\n    await updateAllFieldsInBatches(\"DocProperty\");\n    \n    // todo: this works but should probably mimic not updating same as insert manually\n    // also could  be slow for large documents just to get out of sync again from editing.\n    // await updateTOC();\n\n\n}\n\n\n\n\nasync function getCustomPropertiesAsJson(propertyNames) {\n    return Word.run(async (context) => {\n        const props = context.document.properties.customProperties;\n        props.load(\"items\");\n        await context.sync();\n\n        const result = {};\n        for (const name of propertyNames) {\n            const match = props.items.find(p => p.key === name);\n            result[name] = match ? match.value : null;\n        }\n\n        return result;\n    });\n}\n\nasync function setCustomPropertiesFromJson(propertyDict) {\n    return Word.run(async (context) => {\n        const props = context.document.properties.customProperties;\n        props.load(\"items\");\n        await context.sync();\n\n        for (const [key, value] of Object.entries(propertyDict)) {\n            const existing = props.items.find(p => p.key === key);\n            if (existing) {\n                existing.value = String(value ?? \"\"); // Update existing\n            } else {\n                props.add(key, String(value ?? \"\")); // Add new\n            }\n        }\n\n        await context.sync();\n    });\n}\n\nfunction getLocalizedLongDate() {\n    const locale = \"en-AU\";\n    const now = new Date();\n\n    return now.toLocaleDateString(locale, {\n        day: \"numeric\",\n        month: \"long\",\n        year: \"numeric\"\n    });\n}\n\n\n// TODO: currently no way in office.js to delete the bookmark so unlike\n// VBA the bookmark will stick around\n// some discussion from msft to add some better bookark api.\nasync function clearBookmarkContent(bookmarkName) {\n    await Word.run(async (context) => {\n\n          const range = context.document.getBookmarkRange(bookmarkName);\n          range.load(\"text\");\n          await context.sync();\n\n          range.clear();\n          await context.sync();\n\n    });\n}\n\nasync function chooseTemplate() {\n    // Dynamically construct full URL to dialog.html\n  const baseUrl = window.location.origin;\n  const path = window.location.pathname;\n  const dir = path.substring(0, path.lastIndexOf(\"/\"));\n\n  // Get properties need for the dialog.\n  const keys = [\"CoverDate\", \"CoverTitle\", \"CoverSubtitle\", \"DocType\"];\n  const values = await getCustomPropertiesAsJson(keys);\n\n\n\n  // passing init variable as query params. If gets to big will need to switch to a message\n  // but pass query params ensures available when dialog first loaded for UI initialization.\n  const date = encodeURIComponent(values[\"CoverDate\"] ?? getLocalizedLongDate());\n  const title = encodeURIComponent(values[\"CoverTitle\"] ?? \"coverTitle\");\n  const subtitle = encodeURIComponent(values[\"CoverSubtitle\"] ?? \"coverSubtitle\");\n  const docType = encodeURIComponent(values[\"DocType\"] ?? \"docType\");\n\n\n  const dialogUrl = `${baseUrl}${dir}/frmReport.html?date=${date}&title=${title}&subtitle=${subtitle}&docType=${docType}&showCover=1`;\n\n // const result = await new Promise((resolve, reject)  => {\n    Office.context.ui.displayDialogAsync(\n      dialogUrl,\n      { height: 85, width: 40 },\n      function (asyncResult) {\n        const dialog = asyncResult.value;\n\n        dialog.addEventHandler(Office.EventType.DialogMessageReceived, async function (arg) {\n\n\n            // Handle X button or Esc key\n            if (event.type === Office.EventType.DialogClosed) {\n              console.log(\"Dialog was closed via X or Esc\");\n\n              dialog.close();\n              console.log(\"dialog was cancelled\");\n            //  resolve({});\n              return;\n            }\n\n            if (arg.message === \"cancel\") {\n              dialog.close();\n              console.log(\"dialog was cancelled\");\n            //  resolve({});\n              return;\n            }\n\n            const result = JSON.parse(arg.message);\n            console.log(\"User selections:\", result);\n\n            // todo: define the property names instead of hard code\n            // TODO: coverOption and coverDesign were variables in VBA Would could consider putting the values\n            // in Custom XML (if we can alter) so its not visible to the user if they go to custom properties.\n            let customPropertiesDict = {\n                \"CoverDate\" : result[\"date\"],\n                \"CoverTitle\" : result[\"title\"],\n                \"CoverSubtitle\" : result[\"subtitle\"],\n                \"DocType\" : result[\"docType\"],\n                \"CoverOption\" : result[\"coverOption\"], // \"noCover\" is when noCover is selected\n                \"CoverDesign\" : result[\"coverDesign\"]  // a string of \"1\", \"2\" .., \"5\"\n            }\n\n            \n\n    \n            let coverGrid = null;\n            let colorLogo = null;\n\n            // Do bookmark cleanup based on the cover.\n            if (customPropertiesDict[\"CoverOption\"] == \"noCover\")\n            {\n                // The \"NoCover\" bookmark isn't removed but bookmarks within the range will\n                //  such as coverGrid and coverLogo\n                // TODO: not sure why not just clear the other bookmarks if don't need versus\n                // having a noCover, \n                await clearBookmarkContent(\"NoCover\");\n            }\n            else\n            {\n              switch(customPropertiesDict[\"CoverDesign\"])\n              {\n                case \"1\":\n                  coverGrid = \"1\";\n                  colorLogo = \"CoverLogo_Colour\";\n                  break;\n              case \"2\":\n                  coverGrid = \"2\";\n                  colorLogo = \"CoverLogo_Colour\";\n                break;\n              case \"3\":\n                  coverGrid = \"2\";\n                  colorLogo = \"CoverLogo_White\";\n                  break;\n              case \"4\":\n                  coverGrid = \"2\";\n                  colorLogo = \"CoverLogo_White\";\n                  break;\n                case \"5\": // 5 doesn't have a colorLogo since clears out Cover5 contents\n                    coverGrid = \"5\";\n                    await clearBookmarkContent(\"Cover5\");\n\n                    // will search for bookmarks anywhere so even though CoverFooter is in the hader it will be found.\n                    await insertAutoText(\"CoverFooter\", \"CoverFooter\");\n                    break;\n                default:\n                  // todo shouldn't happen\n                  break;\n              }\n        \n            }\n\n            // Setup cover grid\n            if (coverGrid) {\n                await insertAutoText(\"CoverGrid_\" + coverGrid, \"CoverGrid\");\n            }\n\n    \n            // VBA has a check for CoverLogo bookmark but there isn't really a bookmark \"colorLogo\"\n            // todo: really need a way to check if bookmark exists\n            if (colorLogo) \n            {\n              //   await insertAutoText(colorLogo, \"CoverLogo\");\n            }\n\n            if (customPropertiesDict[\"CoverOption\"] != \"noCover\")\n            {\n                let coverDesign = customPropertiesDict[\"CoverDesign\"];\n                await insertAutoText(\"Cover_\" + coverDesign, \"Cover\");\n            }\n\n\n            // Set the custom properties JSON after the template in case\n            // the Autotext updates the properties as well\n            await setCustomPropertiesFromJson(customPropertiesDict);\n        \n            // Update the fields\n            await updateAllFieldsInBatches(\"DocProperty\");\n\n\n            // also update the Table of Contents if it exists\n            await updateTOC();\n\n            // Use result.date, result.title, etc. in your add-in logic\n            dialog.close();\n\n         //   resolve({});\n\n          });\n        }\n      );\n //   });\n\n    return true;\n}\n\n\n// todo: this is a subset of setting up, just copy/pasted code to expedite prototype.\nasync function updateCoverProperties() {\n   // Dynamically construct full URL to dialog.html\n  const baseUrl = window.location.origin;\n  const path = window.location.pathname;\n  const dir = path.substring(0, path.lastIndexOf(\"/\"));\n\n  // Get properties need for the dialog.\n  const keys = [\"CoverDate\", \"CoverTitle\", \"CoverSubtitle\", \"DocType\"];\n  const values = await getCustomPropertiesAsJson(keys);\n\n\n  // passing init variable as query params. If gets to big will need to switch to a message\n  // but pass query params ensures available when dialog first loaded for UI initialization.\n  const date = encodeURIComponent(values[\"CoverDate\"] ?? getLocalizedLongDate());\n  const title = encodeURIComponent(values[\"CoverTitle\"] ?? \"coverTitle\");\n  const subtitle = encodeURIComponent(values[\"CoverSubtitle\"] ?? \"coverSubtitle\");\n  const docType = encodeURIComponent(values[\"DocType\"] ?? \"docType\");\n\n  // don't include &showCover=1 so only the properties are shown.\n  const dialogUrl = `${baseUrl}${dir}/frmReport.html?date=${date}&title=${title}&subtitle=${subtitle}&docType=${docType}`;\n\n  Office.context.ui.displayDialogAsync(\n    dialogUrl,\n    { height: 40, width: 20 },\n    function (asyncResult) {\n      const dialog = asyncResult.value;\n\n      dialog.addEventHandler(Office.EventType.DialogMessageReceived, async function (arg) {\n        if (arg.message === \"cancel\") {\n          dialog.close();\n          return;\n        }\n\n        const result = JSON.parse(arg.message);\n        console.log(\"User selections:\", result);\n\n        // todo: define the property names instead of hard code\n        // TODO: coverOption and coverDesign were variables in VBA Would could consider putting the values\n        // in Custom XML (if we can alter) so its not visible to the user if they go to custom properties.\n        let customPropertiesDict = {\n            \"CoverDate\" : result[\"date\"],\n            \"CoverTitle\" : result[\"title\"],\n            \"CoverSubtitle\" : result[\"subtitle\"],\n            \"DocType\" : result[\"docType\"],\n        }\n\n         // Set the custom properties JSON, \n          await setCustomPropertiesFromJson(customPropertiesDict);\n\n         // Update the fields that may be depending on it.\n         await updateAllFieldsInBatches(\"DocProperty\");\n\n        // Use result.date, result.title, etc. in your add-in logic\n        dialog.close();\n      });\n    }\n  );\n}\n\n\nasync function insertBackCover() {\n\n\n  // Get properties need for the dialog.\n  const keys = [\"CoverOption\", \"CoverDesign\"];\n  const customPropertiesDict = await getCustomPropertiesAsJson(keys);\n  let autoTextName = null;\n  if (customPropertiesDict[\"CoverOption\"] == \"noCover\")\n  {\n    showAlert(\"Insert Back Cover is not supported for NoCover template choice.\")\n  }\n  else\n  {\n    switch (customPropertiesDict[\"CoverDesign\"])\n    {\n        case \"1\":\n        case \"2\":\n          autoTextName = \"LastPage_White\";\n          break;\n        case \"3\":\n          autoTextName = \"LastPage_Green\";\n          break;\n        case \"4\":\n          autoTextName = \"LastPage_Blue\";\n          break;\n        default:\n           showAlert(`Insert Back Cover is not supported for Cover ${customPropertiesDict[\"CoverDesign\"]} template choice.`)\n          break;\n    }\n  }\n\n  // TODO: ADD A DIALOG FOR IF autoTextName is null MsgBox \"This function is not available for 'No Cover' option\", vbOKOnly, c_Caption\n  // TODO: REVIEW IF SHOULD HIDE THE BACKCOVER BUTTON COMPLETEly if doesn't apply\n  if (autoTextName)\n  {\n     let snippet = await getAutoTextOOXML(autoTextName);\n      await Word.run(async (context) => {\n\n        // Todo: cleanup and understand these selection rules\n        // I had to get the full range again after inserting the paragraph or else section break would be\n        // inserted before the paragraph not after. \n          // Step 1: Get the end of the document\n          let endOfDoc = context.document.body.getRange(Word.RangeLocation.end);\n\n          // Step 2: Collapse the range to a cursor\n          let collapsed = endOfDoc.getRange(Word.RangeLocation.end);\n\n          // Step 3: Insert a paragraph\n          collapsed.insertParagraph(\"\", Word.InsertLocation.after);\n\n          endOfDoc = context.document.body.getRange(Word.RangeLocation.end);\n          collapsed = endOfDoc.getRange(Word.RangeLocation.end);\n\n          // Step 4: Insert a section break (next page)\n          collapsed.insertBreak(Word.BreakType.sectionNext, Word.InsertLocation.after);\n\n           // Step 2: Collapse the range to a cursor again at new end.\n          collapsed = endOfDoc.getRange(Word.RangeLocation.end);\n\n          // Note: could also get an updated range from start of document.\n          collapsed = context.document.body.getRange(Word.RangeLocation.end);\n          \n          // insert the autotext snippet.\n          collapsed.insertOoxml(snippet, Word.InsertLocation.replace);\n        \n\n          await context.sync();\n      });\n\n\n  }\n\n}","// Imports\nvar ___HTML_LOADER_IMPORT_0___ = new URL(\"./taskpane.css\", import.meta.url);\n// Module\nvar code = \" <!DOCTYPE html> <html> <head> <meta charset=\\\"UTF-8\\\"/> <meta http-equiv=\\\"X-UA-Compatible\\\" content=\\\"IE=Edge\\\"/> <meta name=\\\"viewport\\\" content=\\\"width=device-width,initial-scale=1\\\"> <title>Contoso Task Pane Add-in</title> <\" + \"script src=\\\"https://appsforoffice.microsoft.com/lib/1/hosted/office.js\\\"><\" + \"/script> <link rel=\\\"stylesheet\\\" href=\\\"https://res-1.cdn.office.net/files/fabric-cdn-prod_20230815.002/office-ui-fabric-core/11.1.0/css/fabric.min.css\\\"/> <link href=\\\"\" + ___HTML_LOADER_IMPORT_0___ + \"\\\" rel=\\\"stylesheet\\\"/> <style>body,html{height:100%;margin:0;padding:0;font-family:Segoe UI,sans-serif;overflow:hidden}.tab-container{display:flex;flex-direction:column;height:100%;border:1px solid #ccc;border-radius:6px;overflow:hidden}.tab-header{display:flex;flex-wrap:wrap;background-color:#e0e0e0;border-bottom:1px solid #ccc}.tab{font-size:13px;padding:6px 12px;cursor:pointer;flex:0 0 auto;text-align:center;background-color:#d4d4d4;border:1px solid #ccc;border-bottom:none;border-top-left-radius:6px;border-top-right-radius:6px;margin-right:4px;position:relative;z-index:1}.tab.active{background-color:#fff;font-weight:700;z-index:2;border-color:#0078d4 #ccc #fff #ccc}.tab:hover{background-color:#c8c8c8}.tab-body{flex:1;padding:12px;background-color:#fff;border:1px solid #ccc;border-top:none;border-bottom-left-radius:6px;border-bottom-right-radius:6px;overflow-y:auto}.tab-content{display:none}.tab-content.active{display:block}.log-output{height:96px;overflow-y:auto;background-color:#f9f9f9;border-top:1px solid #ccc;font-size:12px;font-family:Consolas,monospace;padding:8px;white-space:pre-wrap;box-sizing:border-box}.ribbon-button-container{display:flex;flex-wrap:wrap;gap:12px;padding:8px}.ribbon-button{width:64px;height:80px;padding:4px;display:flex;flex-direction:column;align-items:center;justify-content:center;border:1px solid #ccc;border-radius:6px;background-color:#f3f3f3;cursor:pointer;transition:background-color .2s ease;text-align:center;position:relative}.ribbon-button:hover{background-color:#e0e0e0}.ribbon-button img{width:24px;height:24px;margin-bottom:6px}.ribbon-button span{font-size:12px;color:#333}.highlight-wrapper{position:relative}.highlight-menu{position:absolute;bottom:-1px;left:0;transform:translateY(100%);background-color:#fff;border:1px solid #ccc;border-radius:4px;box-shadow:0 2px 6px rgba(0,0,0,.15);z-index:10;width:100px}.highlight-menu div{padding:6px 10px;font-size:12px;cursor:pointer}.highlight-menu div:hover{background-color:#eee}.hidden{display:none}.dropdown-arrow{width:0;height:0;border-left:4px solid transparent;border-right:4px solid transparent;border-top:5px solid #333;margin-top:4px;margin:0 auto}i{display:inline-block;width:24px;height:24px}p{font-size:12px!important}</style> <\" + \"script>function showTab(e){document.querySelectorAll(\\\".tab-content\\\").forEach(e=>e.classList.remove(\\\"active\\\")),document.getElementById(e).classList.add(\\\"active\\\"),document.querySelectorAll(\\\".tab\\\").forEach(e=>e.classList.remove(\\\"active\\\")),document.querySelector(`.tab[onclick=\\\"showTab('${e}')\\\"]`).classList.add(\\\"active\\\")}function toggleHighlightMenu(e){if(console.log(\\\"toggle button\\\"),e.target.closest(\\\".highlight-menu\\\"))return;e.stopPropagation(),document.querySelectorAll(\\\".highlight-menu\\\").forEach(e=>e.classList.add(\\\"hidden\\\"));e.currentTarget.querySelector(\\\".highlight-menu\\\").classList.toggle(\\\"hidden\\\")}async function handleClick(e){console.log(`Button clicked: ${e}`),document.querySelectorAll(\\\".highlight-menu\\\").forEach(e=>e.classList.add(\\\"hidden\\\"));const[a,t]=e.split(\\\"|\\\");switch(console.log(\\\"Action:\\\",a),t&&console.log(\\\"Metadata:\\\",t),a){case\\\"chooseTemplate\\\":await addinCommand.chooseTemplate();break;case\\\"insertFigureCaption\\\":await addinCommand.insertFigureCaption();break;case\\\"getOOXML\\\":await addinCommand.getOOXML();break;case\\\"getOOXMLDocument\\\":await addinCommand.getOOXMLDocument();break;case\\\"pasteOOXML\\\":await addinCommand.pasteOOXML();break;case\\\"pasteOOXMLAsDocument\\\":await addinCommand.pasteOOXMLAsDocument();break;case\\\"insertPageBreakAtSelection\\\":await addinCommand.insertPageBreakAtSelection();break;case\\\"insertBackCover\\\":await addinCommand.insertBackCover();break;case\\\"screenshotFormatGuide\\\":await addinCommand.screenshotFormatGuide();break;case\\\"insertImageIntoWord\\\":await addinCommand.insertImageIntoWord();break;case\\\"insertTableCaption\\\":await addinCommand.insertTableCaption();break;case\\\"dynamicTable\\\":await addinCommand.dynamicTable(t);break;case\\\"insertAutoText\\\":await addinCommand.insertAutoText(t);break;case\\\"clearFormatting\\\":await addinCommand.clearFormatting();break;case\\\"setCoverHeadingFontSize\\\":await addinCommand.setCoverHeadingFontSize(t);case\\\"setStyle\\\":await addinCommand.setStyle(t);break;case\\\"pasteUnformatted\\\":await addinCommand.pasteUnformatted();break;case\\\"normalText\\\":await addinCommand.setStyle(t);break;case\\\"updateCoverProperties\\\":await addinCommand.updateCoverProperties();break;case\\\"updateTOC\\\":await addinCommand.updateTOC();break;case\\\"a4Orientation\\\":await addinCommand.a4Orientation();break;default:console.log(\\\"no command found for action\\\")}\\\"bold\\\"===a&&Word.run(async e=>{e.document.getSelection().font.bold=!0,await e.sync(),console.log(\\\"Selected text set to bold.\\\")}).catch(function(e){console.log(\\\"Error: \\\"+e),e instanceof OfficeExtension.Error&&console.log(\\\"Debug info: \\\"+JSON.stringify(e.debugInfo))})}document.addEventListener(\\\"click\\\",()=>{document.querySelectorAll(\\\".highlight-menu\\\").forEach(e=>e.classList.add(\\\"hidden\\\"))}),function(){const e=console.log;console.log=function(...a){e.apply(console,a);const t=document.getElementById(\\\"consoleLog\\\");if(t){const e=a.map(e=>\\\"object\\\"==typeof e?JSON.stringify(e,null,2):String(e)).join(\\\" \\\"),o=document.createElement(\\\"div\\\");o.textContent=e,t.appendChild(o),t.scrollTop=t.scrollHeight}}}(),function(){const e=console.error;console.error=function(...a){e.apply(console,a);const t=document.getElementById(\\\"consoleLog\\\");if(t){const e=a.map(e=>\\\"object\\\"==typeof e?JSON.stringify(e,null,2):String(e)).join(\\\" \\\"),o=document.createElement(\\\"div\\\");o.textContent=e,t.appendChild(o),t.scrollTop=t.scrollHeight}}}()<\" + \"/script> </head> <body class=\\\"\\\"> <div class=\\\"tab-container\\\"> <div class=\\\"tab-header\\\"> <div class=\\\"tab active\\\" onclick='showTab(\\\"template\\\")'>Template</div> <div class=\\\"tab\\\" onclick='showTab(\\\"styles\\\")'>Styles</div> <div class=\\\"tab\\\" onclick='showTab(\\\"tableTools\\\")'>Table Tools</div> <div class=\\\"tab\\\" onclick='showTab(\\\"pageLayout\\\")'>Page Layout</div> <div class=\\\"tab\\\" onclick='showTab(\\\"debug\\\")'>Debug</div> <div class=\\\"tab\\\" onclick='showTab(\\\"help\\\")'>Help</div> </div> <div class=\\\"tab-body\\\"> <div id=\\\"template\\\" class=\\\"tab-content active\\\"> <div class=\\\"ribbon-button-container\\\"> <div id=\\\"chooseTemplate\\\" class=\\\"ribbon-button\\\" onclick='handleClick(\\\"chooseTemplate\\\")'> <span>Choose Template<span> </span></span></div> <div class=\\\"ribbon-button\\\" onclick='handleClick(\\\"insertBackCover\\\")'> <span>Insert Back Page</span> </div> <div class=\\\"ribbon-button\\\" onclick='handleClick(\\\"updateCoverProperties\\\")'> <span>Update Cover Details</span> </div> </div> </div> <div id=\\\"styles\\\" class=\\\"tab-content\\\"> <div class=\\\"ribbon-button-container\\\"> <div class=\\\"ribbon-button\\\" onclick='handleClick(\\\"pasteUnformatted\\\")'> <i aria-hidden=\\\"true\\\" iconname=\\\"Paste_24\\\" zclass=\\\"___1n6nxe4 f1o7jddm f14t3ns0 fmd4ok8 f71fsbu fdgdznj f1sj8vnk\\\" data-icon-name=\\\"Paste_24\\\"><svg height=\\\"100%\\\" width=\\\"100%\\\" viewBox=\\\"0,0,2048,2048\\\" focusable=\\\"false\\\"><path type=\\\"path\\\" class=\\\"OfficeIconColors_HighContrast\\\" d=\\\"M1621 768q35 0 61 25 25 25 25 60v854q0 35-25 60-25 25-61 25h-597q-35 0-60-25-25-25-25-60v-854q0-35 25-60 25-25 60-25h597z m-597-85q-71 0-121 50-50 50-50 120v854q0 71 50 120 50 50 121 50h597q71 0 121-50 50-50 50-120v-854q0-71-50-120-50-50-121-50h-597z m-256-171q-71 0-121-50-50-50-50-121h-128q-53 0-90 38-37 37-38 90v1195q0 53 38 91 37 37 90 37h256q18 0 31 12 12 12 12 31 0 18-12 30-12 12-31 12h-256q-88 0-151-62-62-62-62-151v-1195q0-88 62-151 62-62 151-62h151q23-39 61-62 40-24 87-23h341q47 0 87 23 39 23 61 62h151q88 0 151 62 62 62 62 151v86q0 18-12 30-12 12-30 12-18 0-31-12-12-12-12-30v-86q0-53-37-90-37-37-91-38h-128q0 71-50 121-50 50-121 50h-341z m0-256q-35 0-60 25-25 25-25 60 0 35 25 61 25 25 60 25h341q35 0 61-25 25-25 25-61 0-35-25-60-25-25-61-25h-341z\\\"></path><path type=\\\"path\\\" zclass=\\\"OfficeIconColors_m22\\\" d=\\\"M1621 768q35 0 61 25 25 25 25 60v854q0 35-25 60-25 25-61 25h-597q-35 0-60-25-25-25-25-60v-854q0-35 25-60 25-25 60-25h597z m-597-85q-71 0-121 50-50 50-50 120v854q0 71 50 120 50 50 121 50h597q71 0 121-50 50-50 50-120v-854q0-71-50-120-50-50-121-50h-597z\\\"></path><path type=\\\"path\\\" class=\\\"OfficeIconColors_m212\\\" d=\\\"M469 1835h299v-982q0-106 75-181 75-75 181-75h555v-128q0-71-50-120-50-50-121-50h-171q0 43-25 103-28 68-60 67h-427q-32 0-60-67-25-60-25-103h-171q-71 0-120 50-50 50-50 120v1195q0 71 50 121 50 50 120 50z\\\"></path><path type=\\\"path\\\" class=\\\"OfficeIconColors_m211\\\" d=\\\"M768 512q-71 0-121-50-50-50-50-121h-128q-53 0-90 38-37 37-38 90v1195q0 53 38 91 37 37 90 37h256q18 0 31 12 12 12 12 31 0 18-12 30-12 12-31 12h-256q-88 0-151-62-62-62-62-151v-1195q0-88 62-151 62-62 151-62h151q23-39 61-62 40-24 87-23h341q47 0 87 23 39 23 61 62h151q88 0 151 62 62 62 62 151v86q0 18-12 30-12 12-30 12-18 0-31-12-12-12-12-30v-86q0-53-37-90-37-37-91-38h-128q0 71-50 121-50 50-121 50h-341z m0-256q-35 0-60 25-25 25-25 60 0 35 25 61 25 25 60 25h341q35 0 61-25 25-25 25-61 0-35-25-60-25-25-61-25h-341z\\\"></path></svg></i> <span>Paste Unformatted</span> </div> <div class=\\\"ribbon-button\\\" onclick='handleClick(\\\"setStyle|Section Heading\\\")'> <Zimg src=\\\"https://static.thenounproject.com/png/20462-200.png\\\" alt=\\\"Highlight\\\"/> <span>Section Heading</span> </div> <div class=\\\"ribbon-button highlight-wrapper\\\" onclick=\\\"toggleHighlightMenu(event)\\\"> <Zimg src=\\\"https://static.thenounproject.com/png/20462-200.png\\\" alt=\\\"Highlight\\\"/> <span>Cover Styless</span> <div class=\\\"dropdown-arrow\\\"></div> <div class=\\\"highlight-menu hidden\\\"> <div onclick='handleClick(\\\"setStyle|Cover Heading\\\")'>Cover Heading</div> <div onclick='handleClick(\\\"setStyle|Cover Subheading\\\")'>Cover Subheading</div> <div onclick='handleClick(\\\"setStyle|Cover Details\\\")'>Cover Details</div> </div> </div> <div class=\\\"ribbon-button highlight-wrapper\\\" onclick=\\\"toggleHighlightMenu(event)\\\"> <Zimg src=\\\"https://static.thenounproject.com/png/20462-200.png\\\" alt=\\\"Highlight\\\"/> <span>Headings</span> <div class=\\\"dropdown-arrow\\\"></div> <div class=\\\"highlight-menu hidden\\\"> <div onclick='handleClick(\\\"setStyle|Heading 1\\\")'>Heading 1</div> <div onclick='handleClick(\\\"setStyle|Heading 2\\\")'>Heading 2</div> <div onclick='handleClick(\\\"setStyle|Heading 3\\\")'>Heading 3</div> </div> </div> <div class=\\\"ribbon-button highlight-wrapper\\\" onclick=\\\"toggleHighlightMenu(event)\\\"> <Zimg src=\\\"https://static.thenounproject.com/png/20462-200.png\\\" alt=\\\"Highlight\\\"/> <span>Bullets</span> <div class=\\\"dropdown-arrow\\\"></div> <div class=\\\"highlight-menu hidden\\\"> <div onclick='handleClick(\\\"setStyle|List Bullet\\\")'>List Bullet 1</div> <div onclick='handleClick(\\\"setStyle|List Bullet 2\\\")'>List Bullet 2</div> <div onclick='handleClick(\\\"setStyle|List Bullet 3\\\")'>List Bullet 3</div> <div onclick='handleClick(\\\"setStyle|List Bullet 4\\\")'>List Bullet 4</div> <div onclick='handleClick(\\\"setStyle|List Bullet 5\\\")'>List Bullet 5</div> </div> </div> <div class=\\\"ribbon-button highlight-wrapper\\\" onclick=\\\"toggleHighlightMenu(event)\\\"> <Zimg src=\\\"https://static.thenounproject.com/png/20462-200.png\\\" alt=\\\"Highlight\\\"/> <span>Numbering</span> <div class=\\\"dropdown-arrow\\\"></div> <div class=\\\"highlight-menu hidden\\\"> <div onclick='handleClick(\\\"setStyle|List Number\\\")'>List Number 1</div> <div onclick='handleClick(\\\"setStyle|List Number 2\\\")'>List Number 2</div> <div onclick='handleClick(\\\"setStyle|List Number 3\\\")'>List Number 3</div> </div> </div> </div> </div> <div id=\\\"tableTools\\\" class=\\\"tab-content\\\"> <div style=\\\"font-size:8\\\"> <p style=\\\"font-weight:700\\\">Table items not implemented:</p> <p>Insert Table: TODO: make a dialog to specify rows and columns instead of hardcoded.</p> </div> <div class=\\\"ribbon-button-container\\\"> <div class=\\\"ribbon-button\\\" onclick='handleClick(\\\"dynamicTable\\\")'> <i aria-hidden=\\\"true\\\" iconname=\\\"Table_24\\\" class=\\\"___1n6nxe4 f1o7jddm f14t3ns0 fmd4ok8 f71fsbu fdgdznj f1sj8vnk\\\" data-icon-name=\\\"Table_24\\\"><svg height=\\\"100%\\\" width=\\\"100%\\\" viewBox=\\\"0,0,2048,2048\\\" focusable=\\\"false\\\"><path type=\\\"path\\\" class=\\\"OfficeIconColors_HighContrast\\\" d=\\\"M256 469q0-88 62-151 62-62 151-62h1110q88 0 151 62 62 62 62 151v1110q0 88-62 151-62 62-151 62h-1110q-88 0-151-62-62-62-62-151v-1110z m85 299v512h342v-512h-342z m427 0v512h512v-512h-512z m597 0v512h342v-512h-342z m-896-427q-53 0-90 38-37 37-38 90v214h1366v-214q0-53-38-90-37-37-90-38h-1110z m-128 1024v214q0 53 38 90 37 37 90 38h214v-342h-342z m427 0v342h512v-342h-512z m597 0v342h214q53 0 90-38 37-37 38-90v-214h-342z\\\"></path><path type=\\\"path\\\" class=\\\"OfficeIconColors_m22\\\" d=\\\"M256 1579v-854h1536v854q0 88-62 151-62 62-151 62h-1110q-88 0-151-62-62-62-62-151z m85-214v214q0 53 38 90 37 37 90 38h214v-342h-342z m427 0v342h512v-342h-512z m597 0v342h214q53 0 90-38 37-37 38-90v-214h-342z m0-597v512h342v-512h-342z m-85 512v-512h-512v512h512z m-939 0h342v-512h-342v512z\\\"></path><path type=\\\"path\\\" class=\\\"OfficeIconColors_m223\\\" d=\\\"M1579 299h-1110q-71 0-120 50-50 50-50 120v256h1450v-256q0-71-50-120-50-50-120-50z\\\"></path><path type=\\\"path\\\" class=\\\"OfficeIconColors_m22\\\" d=\\\"M469 256q-88 0-151 62-62 62-62 151v1110q0 88 62 151 62 62 151 62h1110q88 0 151-62 62-62 62-151v-1110q0-88-62-151-62-62-151-62h-1110z m-128 213q0-53 38-90 37-37 90-38h1110q53 0 90 38 37 37 38 90v214h-1366v-214z m0 1110v-214h342v342h-214q-53 0-90-38-37-37-38-90z m427 128v-342h512v342h-512z m597 0v-342h342v214q0 53-38 90-37 37-90 38h-214z m0-427v-512h342v512h-342z m-85-512v512h-512v-512h512z m-597 512h-342v-512h342v512z\\\"></path><path type=\\\"path\\\" class=\\\"OfficeIconColors_m224\\\" d=\\\"M256 469q0-88 62-151 62-62 151-62h1110q88 0 151 62 62 62 62 151v299h-1536v-299z m213-128q-53 0-90 38-37 37-38 90v214h1366v-214q0-53-38-90-37-37-90-38h-1110z\\\"></path></svg></i> <span>Insert Table</span> </div> <div class=\\\"ribbon-button highlight-wrapper\\\" onclick=\\\"toggleHighlightMenu(event)\\\"> <i aria-hidden=\\\"true\\\" iconname=\\\"GrowFont_16\\\" class=\\\"___1n6nxe4 f1o7jddm f14t3ns0 fmd4ok8 f71fsbu fdgdznj f1sj8vnk\\\" data-icon-name=\\\"GrowFont_16\\\"><svg height=\\\"100%\\\" width=\\\"100%\\\" viewBox=\\\"0,0,2048,2048\\\" focusable=\\\"false\\\"><path type=\\\"path\\\" class=\\\"OfficeIconColors_HighContrast\\\" d=\\\"M1800 731q13 23 38 31 25 7 49-6 23-13 31-38 7-25-6-49l-264-475q-24-43-69-59-43-15-86 0-45 16-69 59l-264 475q-13 23-6 49 7 25 31 38 23 13 49 6 25-7 38-31l264-475 264 475z m-1096-347q20 0 37 12 17 12 23 30l512 1408q9 25-2 49-11 24-36 33-25 9-49-2-24-11-33-36l-171-470h-562l-171 470q-9 25-33 36-24 11-49 2-25-9-36-33-11-24-2-49l512-1408q7-19 23-30 17-12 37-12z m0 251l-234 645h468l-234-645z\\\"></path><path type=\\\"path\\\" class=\\\"OfficeIconColors_m24\\\" d=\\\"M1887 756q-23 13-49 6-25-7-38-31l-264-475-264 475q-13 23-38 31-25 7-49-6-23-13-31-38-7-25 6-49l264-475q24-43 69-59 43-15 86 0 45 16 69 59l264 475q13 23 6 49-7 25-31 38z\\\"></path><path type=\\\"path\\\" class=\\\"OfficeIconColors_m22\\\" d=\\\"M764 426q-7-19-23-30-17-12-37-12-20 0-37 12-17 12-23 30l-512 1408q-9 25 2 49 11 24 36 33 25 9 49-2 24-11 33-36l171-470h562l171 470q9 25 33 36 24 11 49 2 25-9 36-33 11-24 2-49l-512-1408z m174 854h-468l234-645 234 645z\\\"></path></svg></i> <span>Table Styles</span> <div class=\\\"dropdown-arrow\\\"></div> <div class=\\\"highlight-menu hidden\\\"> <div onclick='handleClick(\\\"setStyle|Table Heading\\\")'>Table Heading</div> <div onclick='handleClick(\\\"setStyle|Table Column\\\")'>Table Column</div> <div onclick='handleClick(\\\"setStyle|Table Text\\\")'>Table Text</div> </div> </div> <div class=\\\"ribbon-button\\\" onclick='handleClick(\\\"insertTableCaption\\\")'> <span>Insert Table Caption</span> </div> </div> </div> <div id=\\\"pageLayout\\\" class=\\\"tab-content\\\"> <div class=\\\"ribbon-button-container\\\"> <div class=\\\"ribbon-button\\\" onclick='handleClick(\\\"updateTOC\\\")'> <span>Update TOC</span> </div> <div class=\\\"ribbon-button\\\" onclick='handleClick(\\\"a4Orientation\\\")'> <span>A4 Orientation</span> </div> <div class=\\\"ribbon-button\\\" onclick='handleClick(\\\"insertPageBreakAtSelection\\\")'> <span>Insert Page Break</span> </div> <div class=\\\"ribbon-button\\\" onclick='handleClick(\\\"insertFigureCaption\\\")'> <span>Insert Figure Caption</span> </div> <div class=\\\"ribbon-button\\\" onclick='handleClick(\\\"insertImageIntoWord\\\")'> <span>Insert Picture</span> </div> <div class=\\\"ribbon-button\\\" onclick='handleClick(\\\"insertAutoText|CaseStudy\\\")'> <span>Insert Case Study</span> </div> <div class=\\\"ribbon-button\\\" onclick='handleClick(\\\"insertAutoText|Checklist\\\")'> <span>Insert Checklist</span> </div> <div class=\\\"ribbon-button\\\" onclick='handleClick(\\\"insertAutoText|Quote\\\")'> <span>Insert Quote</span> </div> <div class=\\\"ribbon-button\\\" onclick='handleClick(\\\"insertAutoText|PulloutBox\\\")'> <span>Insert Pullout Box</span> </div> <div class=\\\"ribbon-button\\\" onclick='handleClick(\\\"insertAutoText|FeatureBox\\\")'> <span>Insert Feature Box</span> </div> </div> </div> <div id=\\\"debug\\\" class=\\\"tab-content\\\"> <div>The debug tab won't be visible in production.</div> <div class=\\\"ribbon-button-container\\\"> <div class=\\\"ribbon-button\\\" onclick='handleClick(\\\"getOOXML\\\")'> <span>Copy selection OOXML</span> </div> <div class=\\\"ribbon-button\\\" onclick='handleClick(\\\"getOOXMLDocument\\\")'> <span>Copy document OOXML</span> </div> <div class=\\\"ribbon-button\\\" onclick='handleClick(\\\"pasteOOXML\\\")'> <span>Paste OOXML at selection</span> </div> <div class=\\\"ribbon-button\\\" onclick='handleClick(\\\"pasteOOXMLAsDocument\\\")'> <span>Paste OOXML as document</span> </div> </div> </div> <div id=\\\"help\\\" class=\\\"tab-content\\\"> <div> <div> <img src=\\\"https://upsidedown.com.au/wp-content/uploads/2019/03/Templates-logo-animation.png\\\" alt=\\\"UPSIDE TEMPLATES Logo\\\" style=\\\"height:60px\\\"> <h2 style=\\\"margin:10px 0\\\">About this template</h2> </div> <p>This template was created by <strong>UpsideDown Productions</strong>:</p> <p>Tel: +61 (0)2 9411 4548<br> <a href=\\\"http://www.upsidedown.com.au\\\" target=\\\"_blank\\\">www.upsidedown.com.au</a><br> </p></div> </div> </div> <div id=\\\"consoleLog\\\" class=\\\"log-output\\\"></div> </div></body> </html> \";\n// Exports\nexport default code;"],"names":["__webpack_module_cache__","__webpack_require__","moduleId","cachedModule","undefined","exports","module","__webpack_modules__","m","d","definition","key","o","Object","defineProperty","enumerable","get","g","globalThis","this","Function","e","window","obj","prop","prototype","hasOwnProperty","call","scriptUrl","importScripts","location","document","currentScript","tagName","toUpperCase","src","scripts","getElementsByTagName","length","i","test","Error","replace","p","b","baseURI","self","href","t","r","Symbol","n","iterator","toStringTag","c","Generator","u","create","_regeneratorDefine2","f","y","G","v","a","bind","l","TypeError","done","value","return","GeneratorFunction","GeneratorFunctionPrototype","getPrototypeOf","setPrototypeOf","__proto__","displayName","_regenerator","w","_invoke","configurable","writable","asyncGeneratorStep","Promise","resolve","then","_asyncToGenerator","arguments","apply","_next","_throw","action","event","completed","launcHelpTaskpane","_x2","_launcHelpTaskpane","_callee7","_context7","launchTaskpane","showTab","_x3","_launchTaskpane","_callee9","keys","_context9","console","log","getCustomPropertiesAsJson","getElementById","onclick","_callee8","_context8","chooseTemplate","Office","addin","showAsTaskpane","catch","error","_setStyle","_callee1","styleName","_t","_context1","Word","run","_ref6","_callee0","context","_context0","getSelection","style","sync","_x24","OfficeExtension","message","code","trace","traceMessages","_clearFormatting","_callee11","_t2","_context11","_ref7","_callee10","selection","font","_context10","bold","italic","underline","color","highlightColor","strikeThrough","subscript","superscript","_x25","addinCommand","pasteUnformatted","navigator","clipboard","readText","clipText","_ref2","_callee2","_context2","insertText","InsertLocation","_x4","err","setStyle","_x5","setCoverHeadingFontSize","_x9","_setCoverHeadingFontSize","clearFormatting","insertAutoText","dynamicTable","_dynamicTable","insertTableCaption","insertImageIntoWord","_insertImageIntoWord","screenshotFormatGuide","_screenshotFormatGuide","insertBackCover","_insertBackCover","insertPageBreakAtSelection","_ref3","_callee3","_context3","insertBreak","BreakType","page","after","_x18","updateCoverProperties","_updateCoverProperties","updateTOC","insertFigureCaption","_insertFigureCaption","a4Orientation","_a4Orientation","getOOXML","_getOOXML","getOOXMLDocument","_getOOXMLDocument","pasteOOXML","_pasteOOXML","pasteOOXMLAsDocument","_pasteOOXMLAsDocument","onReady","_ref","_callee","info","_context","actions","associate","_x","ahrc_CacheXml","getAutoTextOOXML","_x6","_getAutoTextOOXML","_callee12","autoText_identifier","xmlDoc","response","xmlText","parser","snippetNode","snippet","_context12","fetch","ok","concat","statusText","text","DOMParser","parseFromString","querySelector","textContent","_x7","_insertAutoText","_callee14","bookmarkName","_t3","_args14","_context14","_ref8","_callee13","insertRange","_context13","getBookmarkRange","load","clear","insertOoxml","_x26","_callee18","size","_t5","_context18","_ref0","_callee17","props","styles","coverHeadingStyle","getProp","coverChosen","docType","caption","docTypeLabel","_context17","properties","customProperties","getStyles","getByNameOrNullObject","name","items","find","isNullObject","_x28","_callee19","options","_context19","numRows","numCols","coloredBorders","lineBreaks","headerRow","firstColumn","lastColumn","totalRow","centerAligned","insertOrFormatTable","_x0","_insertOrFormatTable","_callee21","_t6","_context21","_ref1","_callee20","table","range","_context20","tables","insertParagraph","getRange","insertTable","blackBorders","headerRowCount","rows","getFirst","applyStyleToCellParagraphs","cells","_x29","_x1","_x10","_x11","_applyStyleToCellParagraphs","_callee22","_context22","forEach","cell","body","paragraphs","paragraph","updateAllFieldsInBatches","_updateAllFieldsInBatches","_callee25","fieldType","_args25","_context25","_ref10","_callee24","batchSize","totalUpdated","updateFieldsInRange","_updateFieldsInRange","sections","_iterator","_step","section","headers","_i","_headers","header","_t7","_context24","_callee23","label","fields","matchingFields","batchEnd","j","_context23","filter","field","type","Math","min","updateResult","_x31","_x32","_createForOfIteratorHelper","s","getHeader","_x30","_insertTableCaption","_callee28","sectionOoxml","_args28","_context28","_ref11","_callee26","_context26","getLast","RangeLocation","select","_x33","_ref12","_callee27","afterRange","_t8","_context27","_x34","_callee30","input","_context30","createElement","accept","display","onchange","file","files","reader","FileReader","onload","result","base64","startsWith","substring","indexOf","_ref13","_callee29","_context29","insertInlinePictureFromBase64","_x35","readAsDataURL","appendChild","click","_callee32","_context32","_ref14","_callee31","currentParagraph","endOfParagraph","_context31","end","_x36","_callee34","_context34","_ref15","_callee33","ooxml","ooxmlString","_t9","_context33","getOoxml","writeText","_x37","_callee36","_context36","_ref16","_callee35","_t0","_context35","_x38","_callee38","_t1","_context38","_ref17","_callee37","_context37","_x39","_callee40","_t10","_context40","_ref18","_callee39","_context39","_x40","showAlert","_x12","_showAlert","_callee41","_context41","_updateTOC","_callee49","_context49","_ref21","_callee48","_context48","_x43","_callee50","_context50","getSectionIndexFromSelection","_getSectionIndexFromSelection","_callee53","_context53","_ref22","_callee52","selectionRange","sectionBodyRange","_context52","compareLocationWith","LocationRelation","inside","equal","_x44","_callee58","sectionIndex","headerOoxml","footerOoxml","firstPageheaderOoxml","firstPagefooterOoxml","landscapeHeaderOOXML","_context58","_ref23","_callee54","secondSection","primaryHeader","primaryFooter","zheaderOoxml","zfooterOoxml","firstHeader","firstFooter","zheaderOoxml2","zfooterOoxml2","_context54","HeaderFooterType","primary","getFooter","firstPage","_x45","_ref24","_callee55","_t14","_context55","_x46","_ref25","_callee56","firstSection","FprimaryHeader","FprimaryFooter","_context56","_x47","_ref26","_callee57","newSection","_context57","_x48","_x20","_getCustomPropertiesAsJson","_callee60","propertyNames","_context61","_ref27","_callee59","_iterator3","_step3","_loop","_t15","_context60","match","_context59","_regeneratorValues","_x49","setCustomPropertiesFromJson","_x21","_setCustomPropertiesFromJson","_callee62","propertyDict","_context64","_ref28","_callee61","_loop2","_i3","_Object$entries","_context63","_Object$entries$_i","existing","_context62","_slicedToArray","String","add","entries","_x50","getLocalizedLongDate","Date","toLocaleDateString","day","month","year","clearBookmarkContent","_x22","_clearBookmarkContent","_callee64","_context66","_ref29","_callee63","_context65","_x51","_chooseTemplate","_callee66","_values$CoverDate","_values$CoverTitle","_values$CoverSubtitle","_values$DocType","baseUrl","path","dir","values","date","title","subtitle","dialogUrl","_context68","origin","pathname","lastIndexOf","encodeURIComponent","ui","displayDialogAsync","height","width","asyncResult","dialog","addEventHandler","EventType","DialogMessageReceived","_ref30","_callee65","arg","customPropertiesDict","coverGrid","coverDesign","_t16","_context67","DialogClosed","close","JSON","parse","_x52","_callee68","_values$CoverDate2","_values$CoverTitle2","_values$CoverSubtitle2","_values$DocType2","_context70","_ref31","_callee67","_context69","_x53","_callee70","autoTextName","_t17","_context72","_ref32","_callee69","endOfDoc","_context71","sectionNext","_x54","URL"],"sourceRoot":""}