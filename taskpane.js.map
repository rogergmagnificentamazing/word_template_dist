{"version":3,"file":"taskpane.js","mappings":"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","sources":["webpack://office-addin-taskpane/webpack/bootstrap","webpack://office-addin-taskpane/webpack/runtime/define property getters","webpack://office-addin-taskpane/webpack/runtime/global","webpack://office-addin-taskpane/webpack/runtime/hasOwnProperty shorthand","webpack://office-addin-taskpane/webpack/runtime/publicPath","webpack://office-addin-taskpane/webpack/runtime/jsonp chunk loading","webpack://office-addin-taskpane/./src/taskpane/taskpane.ts","webpack://office-addin-taskpane/./src/taskpane/taskpane.html"],"sourcesContent":["// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n// expose the modules object (__webpack_modules__)\n__webpack_require__.m = __webpack_modules__;\n\n","// define getter functions for harmony exports\n__webpack_require__.d = function(exports, definition) {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.g = (function() {\n\tif (typeof globalThis === 'object') return globalThis;\n\ttry {\n\t\treturn this || new Function('return this')();\n\t} catch (e) {\n\t\tif (typeof window === 'object') return window;\n\t}\n})();","__webpack_require__.o = function(obj, prop) { return Object.prototype.hasOwnProperty.call(obj, prop); }","var scriptUrl;\nif (__webpack_require__.g.importScripts) scriptUrl = __webpack_require__.g.location + \"\";\nvar document = __webpack_require__.g.document;\nif (!scriptUrl && document) {\n\tif (document.currentScript && document.currentScript.tagName.toUpperCase() === 'SCRIPT')\n\t\tscriptUrl = document.currentScript.src;\n\tif (!scriptUrl) {\n\t\tvar scripts = document.getElementsByTagName(\"script\");\n\t\tif(scripts.length) {\n\t\t\tvar i = scripts.length - 1;\n\t\t\twhile (i > -1 && (!scriptUrl || !/^http(s?):/.test(scriptUrl))) scriptUrl = scripts[i--].src;\n\t\t}\n\t}\n}\n// When supporting browsers where an automatic publicPath is not supported you must specify an output.publicPath manually via configuration\n// or pass an empty string (\"\") and set the __webpack_public_path__ variable from your code to use your own logic.\nif (!scriptUrl) throw new Error(\"Automatic publicPath is not supported in this browser\");\nscriptUrl = scriptUrl.replace(/^blob:/, \"\").replace(/#.*$/, \"\").replace(/\\?.*$/, \"\").replace(/\\/[^\\/]+$/, \"/\");\n__webpack_require__.p = scriptUrl;","__webpack_require__.b = document.baseURI || self.location.href;\n\n// object to store loaded and loading chunks\n// undefined = chunk not loaded, null = chunk preloaded/prefetched\n// [resolve, reject, Promise] = chunk loading, 0 = chunk loaded\nvar installedChunks = {\n\t926: 0\n};\n\n// no chunk on demand loading\n\n// no prefetching\n\n// no preloaded\n\n// no HMR\n\n// no HMR manifest\n\n// no on chunks loaded\n\n// no jsonp function","/*\n * Copyright (c) Microsoft Corporation. All rights reserved. Licensed under the MIT license.\n * See LICENSE in the project root for license information.\n */\n\n/* global document, Office, Word */\n\n(window as any).addinCommand = {\n  pasteUnformatted,\n  setStyle,\n  setCoverHeadingFontSize,\n  clearFormatting,\n  insertAutoText,\n  dynamicTable,\n  insertTableCaption,\n  insertImageIntoWord,\n  screenshotFormatGuide,\n  insertBackCover,\n  insertPageBreakAtSelection,\n  updateCoverProperties,\n  updateTOC,\n  insertFigureCaption,\n  a4Orientation,\n  getOOXML,\n  getOOXMLDocument,\n  pasteOOXML,\n  pasteOOXMLAsDocument,\n  chooseTemplate\n};\n\n\nOffice.onReady(async (info) => {\n\n  console.log(\"onready in taskpane.\")\n  Office.actions.associate(\"launchTaskpane\", launchTaskpane);\n Office.actions.associate(\"launcHelpTaskpane\", launcHelpTaskpane);\n\n  //\n  \n  // Register the function with Office want to call from the Ribbon.\n  Office.actions.associate(\"action\", action);\n\n  // todo :ribbon test, confirmed ribbon not supported\n  // await updateRibbon();\n});\n\n// placeholder action for ribbon command \nfunction action(event: Office.AddinCommands.Event)\n{\n\n    event.completed();\n\n}\n\nasync function updateRibbon() {\n\n  /* todo: can enable buttons but can't hide */\n  \n  console.log(\"attempting to update ribbon\");\n  await Office.ribbon.requestUpdate({\n    tabs: [\n      {\n        id: \"CustomTab\",\n        visible: false\n      }\n    ]\n  }).then(() => {\n    console.log(\"Custom tab hidden.\");\n  }).catch((error) => {\n    console.error(\"Failed to hide tab:\", error);\n  });\n\n}\n\nexport async function run() {\n  return Word.run(async (context) => {\n    /**\n     * Insert your Word code here\n     */\n\n    // insert a paragraph at the end of the document.\n    const paragraph = context.document.body.insertParagraph(\"Hello World\", Word.InsertLocation.end);\n\n    // change the paragraph color to blue.\n    paragraph.font.color = \"blue\";\n\n    await context.sync();\n  });\n}\n\nasync function launcHelpTaskpane(event)\n{\n   await launchTaskpane(event);\n\n   // todo: should probably check if taskpane actually launched.\n    window.showTab(\"help\");\n\n}\n\nasync function launchTaskpane(event) {\n\n  console.log(\"launch taskpane\");\n\n  // TODO: BUG BUG, IF THIS THROWS AND WE DON'T CALL EVENT.COMPLETE() add-in UI is frozen\n\n  // check if the template has been configured\n  // todo: should just be  acheck function but \n  // do here since currently only place to check.\n  const keys = [\"CoverOption\", \"CoverDesign\"];\n  let customPropertiesDict = await getCustomPropertiesAsJson(keys);\n  if (!customPropertiesDict[\"CoverOption\"])\n  {\n     // if cover option not defined then set it up.\n     // MAGOO\n     await chooseTemplate();\n\n     // the dialog is async so can't wait.\n     // need to have taskpane be launched again via a callback.\n\n   //  event.completed();\n   //  return;\n  }\n\n  customPropertiesDict = await getCustomPropertiesAsJson(keys);\n  if (!customPropertiesDict[\"CoverOption\"])\n  {\n     showAlert(\"properties not set after showing to choose template\");\n     event.completed();\n    return;\n  }\n\n  Office.addin.showAsTaskpane()\n    .then(() => {\n      // Optional: initialize UI or state\n       event.completed();\n    })\n    .catch((error) => {\n      console.error(\"Failed to show taskpane:\", error);\n      event.completed();\n    });\n\n}\n\n/* office doesn't allow clipboard access so use the browser.\n  User will be asked if accessing clipboard is okay\n*/\nexport function pasteUnformatted() {\n  navigator.clipboard.readText().then((clipText) => {\n    Word.run(async (context) => {\n      const selection = context.document.getSelection();\n      selection.insertText(clipText, Word.InsertLocation.replace);\n      await context.sync();\n    });\n  }).catch((err) => {\n    console.error(\"Clipboard access failed:\", err);\n  });\n}\n\n/*\n Set the Style\n*/\n\nexport async function setStyle(styleName) {\n\n  console.log(\"setStyle \" + styleName);\n\n   try {\n    await Word.run(async (context) => {\n      const selection = context.document.getSelection();\n      selection.style = styleName;\n      await context.sync();\n    });\n  } catch (error) {\n\n    // Todo: make a common helper\n    console.log(\"Error applying style:\", styleName, \"Most likely style doesn't exist in document.\");\n\n    if (error instanceof OfficeExtension.Error) {\n        console.error(\"Debug info:\", {\n      message: error.message,\n      code: error.code,\n      trace: error.traceMessages,\n    });\n  }\n\n\n  }\n}\n\n\n/*\nOffice.JS doesn't have a \"Clear Formatting\" so have to manually reset each of the\nproperties we care about resetting to the Style.\n*/\nexport async function clearFormatting() {\n  try {\n    await Word.run(async (context) => {\n      const selection = context.document.getSelection();\n      const font = selection.font;\n\n      // Safely reset local formatting overrides\n      font.bold = false;\n      font.italic = false;\n      font.underline = \"None\";\n      font.color = \"auto\";\n      font.highlightColor = \"None\";\n      font.strikeThrough = false;\n      font.subscript = false;\n      font.superscript = false;\n\n      await context.sync();\n      console.log(\"Local formatting reset to style defaults.\");\n    });\n  } catch (error) {\n    console.error(\"Error resetting formatting:\", error);\n    if (error instanceof OfficeExtension.Error) {\n      console.error(\"Details:\", {\n        message: error.message,\n        code: error.code,\n        trace: error.traceMessages,\n      });\n    }\n  }\n}\n\n\n/* \nTodo: example if using custom.xml for the autotext.\nCould also store the .xml online and Fetch if don't want to store in the document.\n*/\n/*\ntodo: if do the fetch cache after first call so don't fetch and parse every time\n*/\n\nvar netwealth_CacheXml = null;\nvar ahrc_CacheXml = null;\n\nasync function getAutoTextOOXML(autoText_identifier)\n{\n\n let  xmlDoc = null;\n\n    /*\n    // make sure xml is loaded\n    if (!netwealth_CacheXml) {\n      // Step 1: Fetch custom.xml from assets\n      //const response = await fetch(\"./assets/netwealth_custom.xml\");\n\n           const response = await fetch(\"./assets/netwealth_custom.xml\");\n\n      if (!response.ok) {\n        throw new Error(`Failed to fetch custom.xml: ${response.statusText}`);\n      }\n\n      const xmlText = await response.text();\n\n      // Step 2: Parse XML and locate the snippet\n      const parser = new DOMParser();\n      xmlDoc = parser.parseFromString(xmlText, \"application/xml\");\n      netwealth_CacheXml = xmlDoc;\n    }\n*/\n\n      // make sure xml is loaded\n    if (!ahrc_CacheXml) {\n      // Step 1: Fetch custom.xml from assets\n      const response = await fetch(\"./assets/ahrc_custom.xml\");\n      if (!response.ok) {\n        throw new Error(`Failed to fetch custom.xml: ${response.statusText}`);\n      }\n\n      const xmlText = await response.text();\n\n      // Step 2: Parse XML and locate the snippet\n      const parser = new DOMParser();\n      xmlDoc = parser.parseFromString(xmlText, \"application/xml\");\n      ahrc_CacheXml = xmlDoc;\n    }\n\n    //  hack we just check both xmls for prototypeing.\n    let snippetNode = null; // netwealth_CacheXml.querySelector(`Snippet[id='${autoText_identifier}']`);\n\n    if (!snippetNode) {\n      snippetNode = ahrc_CacheXml.querySelector(`Snippet[id='${autoText_identifier}']`);\n      if (!snippetNode) {\n      throw new Error(`Snippet with id '${autoText_identifier}' not found.`);\n      }\n    }\n\n    const snippet = snippetNode.textContent;\n\n    return snippet\n}\n\nexport async function insertAutoText(autoText_identifier, bookmarkName = null) {\n  try {\n\n    let snippet = await getAutoTextOOXML(autoText_identifier);\n\n    // Step 3: Insert OOXML into Word document\n    await Word.run(async (context) => {\n      let insertRange = null;\n      if (bookmarkName) {\n          insertRange = context.document.getBookmarkRange(bookmarkName);\n          insertRange.load(\"text\");\n          await context.sync();\n\n          // TODO: CHECK FOR ERRORS.\n      }\n      else\n      {\n          insertRange = context.document.getSelection();\n      }\n\n\n      // insertOoxml merges and doesn't honor the replace so clear out the range first.\n      insertRange.clear();\n      await context.sync();\n\n\n       insertRange.insertOoxml(snippet, Word.InsertLocation.replace);\n      await context.sync();\n    });\n\n  } catch (error) {\n    console.error(\"Error inserting autotext:\", error);\n    if (error instanceof OfficeExtension.Error) {\n      console.error(\"Details:\", {\n        message: error.message,\n        code: error.code,\n        trace: error.traceMessages,\n      });\n    }\n  }\n}\n\nexport async function insertAutoTextContentXml(autoText_identifier) {\n  try {\n        await Word.run(async (context) => {\n          const parts = context.document.customXmlParts.getByNamespace(\"http://schemas.adu/addin/autotext\");\n          parts.load(\"items\");\n          await context.sync();\n\n          if (parts.items.length === 0) {\n            throw new Error(\"No matching CustomXmlParts found.\");\n          }\n\n          const xmlPart = parts.items[0]; // Now confidently scoped\n          const xml = xmlPart.getXml();\n          await context.sync();\n\n          const parser = new DOMParser();\n          const xmlDoc = parser.parseFromString(xml.value, \"text/xml\");\n          const snippetNode = xmlDoc.querySelector(`Snippet[id='${autoText_identifier}']`);\n\n          if (!snippetNode) {\n            throw new Error(`Snippet with id '${autoText_identifier}' not found.`);\n          }\n\n          const snippet = snippetNode.textContent;\n\n          const selection = context.document.getSelection();\n          selection.insertOoxml(snippet, Word.InsertLocation.replace);\n\n          await context.sync();\n        });\n\n  } catch (error) {\n    console.error(\"Error inserting autotext:\", error);\n    if (error instanceof OfficeExtension.Error) {\n      console.error(\"Details:\", {\n        message: error.message,\n        code: error.code,\n        trace: error.traceMessages,\n      });\n    }\n  }\n}\n\n/*\ntodo: test code for changing style font size\nOffice.js doesn't support changing the font size, \nCould looking into using OOXML direction\n*/\nexport async function setCoverHeadingFontSize(size: number) {\n  try {\n    await Word.run(async (context) => {\n      const props = context.document.properties.customProperties;\n      const styles = context.document.getStyles();\n      \n      props.load(\"items\");\n      const coverHeadingStyle = styles.getByNameOrNullObject(\"Cover Heading\");\n      coverHeadingStyle.load(\"font\");\n      await context.sync();\n\n      const getProp = (name: string) => {\n        const prop = props.items.find(p => p.key === name);\n        return prop ? prop.value : null;\n      };\n\n      const coverChosen = getProp(\"CoverChosen\");\n      const docType = getProp(\"DocumentType\");\n\n      // Todo: clean this up.\n      const caption = \"setCoverHeadingFontSize\";     // Replace with actual value\n      const docTypeLabel = \"\"; // Replace with actual value\n\n      if (coverChosen === \"1\" || coverChosen === \"2\") {\n        console.log(`${caption} ${docTypeLabel}: This option is not designed for the cover you've chosen.`);\n        return;\n      } else if (docType === \"CustomNoCover\") {\n        console.log(`${caption} ${docTypeLabel}: This option is not designed for the custom layout you've chosen.`);\n        return;\n      } else if (docType === \"Simple\") {\n        console.log(`${caption} ${docTypeLabel}: This option is not designed for the simple layout you've chosen.`);\n        return;\n      }\n\n      if (coverHeadingStyle.isNullObject) {\n        console.log(\"Style 'Cover Heading' not found.\");\n        return;\n      }\n\n      coverHeadingStyle.font.size = size;\n      await context.sync();\n\n      console.log(`Updated 'Cover Heading' font size to ${size}pt.`);\n    });\n  } catch (error) {\n    console.error(\"Error during validation or style update:\", error);\n  }\n}\n\n/*\nCode for testing the Insert Table code\n\n*/\n\nasync function dynamicTable()\n{\n  \n   console.trace(\"dynamictable\");\n   let options = {}\n\n   options.numRows = 3;\n   options.numCols = 3;\n   options.coloredBorders = true;\n   options.lineBreaks = false;\n\n   options.headerRow = true;\n   options.firstColumn = true;\n   options.lastColumn = true;\n   options.totalRow = true;\n   options.centerAligned = true;\n\n   insertOrFormatTable(options);\n\n}\n\nasync function insertOrFormatTable(options) {\n  try {\n    await Word.run(async (context) => {\n      const selection = context.document.getSelection();\n      selection.load(\"tables\");\n      await context.sync();\n\n      // todo: this doesn't work, need to determine if in Table or not.\n      let table;\n      if (selection.tables.items.length === 0) {\n        const range = selection.insertParagraph(\"\", Word.InsertLocation.after).getRange();\n        table = range.insertTable(options.numRows, options.numCols, Word.InsertLocation.after, [[\"\"]]);\n      } else {\n        table = selection.tables.items[0];\n      }\n\n      table.load([\"rows\", \"columns\", \"style\"]);\n      await context.sync();\n\n      table.style = \"Table Text\";\n\n      if (options.coloredBorders) {\n        table.style = options.lineBreaks ? \"netwealth Combined Table4\" : \"netwealth Combined Table2\";\n      } else if (options.blackBorders) {\n        table.style = options.lineBreaks ? \"netwealth Combined Table3\" : \"netwealth Combined Table\";\n      }\n\n      if (options.headerRow) {\n        table.headerRowCount = 1;\n        const headerRow = table.rows.getFirst();\n        headerRow.load(\"cells\");\n        await context.sync();\n\n        await applyStyleToCellParagraphs(headerRow.cells.items, \"Table Heading\", context);\n\n      }\n\n      /*\n        Todo: office.js doesn't have a last column need to figure out cells by looking at\n         each row and determining the column\n      // Last Column\n      if (options.lastColumn) {\n        table.lastColumn = true;\n        const lastCol = table.columns.getLast();\n        lastCol.load(\"cells\");\n        await context.sync();\n\n        await applyStyleToCellParagraphs(lastCol.cells.items, \"Table LastColumn\", context);\n      }\n      */\n\n      /*\n      // TODO: there is no rows.getLast(); need to find ourselves\n      // Total Row\n      if (options.totalRow) {\n        table.totalRowCount = 1;\n        const lastRow = table.rows.getLast();\n        lastRow.load(\"cells\");\n        await context.sync();\n\n        await applyStyleToCellParagraphs(lastRow.cells.items, \"Table TotalRow\", context);\n      }\n      */\n\n\n      /*\n      // TODO: not loading the proper context ehre and getting errors. \n\n  if (options.centerAligned) {\n    \n      // Step 1: Load rows collection\n      table.rows.load(\"items\");\n      await context.sync();\n\n      // Step 2: Load cells for each row\n      for (const row of table.rows.items) {\n        row.load(\"cells\");\n      }\n      await context.sync();\n\n        const colCount = table.rows.items[0].cells.items.length;\n\n      // Load paragraphs in each cell (columns 2+)\n      for (const row of table.rows.items) {\n        for (let c = 1; c < colCount; c++) {\n          const cell = row.cells.items[c];\n          cell.body.paragraphs.load(\"items\");\n        }\n      }\n      await context.sync();\n\n      // Apply center alignment\n      for (const row of table.rows.items) {\n        for (let c = 1; c < colCount; c++) {\n          const cell = row.cells.items[c];\n          cell.body.paragraphs.items.forEach(p => {\n            p.paragraphFormat.alignment = Word.Alignment.center;\n          });\n        }\n      }\n      await context.sync();\n    }\n\n    */\n\n      await context.sync();\n    });\n  } catch (error) {\n    console.error(\"Error inserting or formatting table:\", error);\n    // Optional: surface error to UI\n    // showNotification(\"Table formatting failed: \" + error.message);\n  }\n}\n\nasync function applyStyleToCellParagraphs(cells, styleName, context) {\n  cells.forEach(cell => cell.load(\"body\"));\n  await context.sync();\n\n  cells.forEach(cell => {\n    const paragraphs = cell.body.paragraphs;\n    paragraphs.load(\"items\");\n  });\n  await context.sync();\n\n  cells.forEach(cell => {\n    cell.body.paragraphs.items.forEach(paragraph => {\n      paragraph.style = styleName;\n    });\n  });\n  await context.sync();\n}\n\n/**\n * Updates all fields in the main body of the document in controlled batches.\n * Adjusts the batch size based on the document's complexity and API limits.\n * todo: may be able to also filter by label such as Table, Figure, so only updates affected\n * versus all SEQ fields\n */\nasync function updateAllFieldsInBatches(fieldType = \"Seq\") {\n  await Word.run(async (context) => {\n    const allFields = context.document.body.fields;\n    allFields.load(\"items, type\"); // Load 'type' property to identify TOC fields\n    await context.sync();\n\n    const otherFields = allFields.items.filter((field) => field.type === fieldType);\n   // const otherFields = allFields.items.filter((field) => field.type !== \"TOC\");\n\n    if (otherFields.length > 0) {\n      console.log(`Updating ${otherFields.length} regular fields in batches...`);\n      const batchSize = 50;\n      for (let i = 0; i < otherFields.length; i += batchSize) {\n        const batchEnd = Math.min(i + batchSize, otherFields.length);\n        for (let j = i; j < batchEnd; j++) {\n          otherFields[j].updateResult();\n        }\n        await context.sync();\n      }\n      console.log(\"Finished updating regular fields.\");\n    }\n\n    /*\n    if (tocFields.length > 0) {\n      console.log(`Updating ${tocFields.length} Table of Contents fields...`);\n      // Display a loading indicator here for the user.\n      for (let tocField of tocFields) {\n        tocField.updateResult(); // Queue update for each TOC field\n      }\n      await context.sync(); // Sync TOC updates separately.\n      // Hide the loading indicator here.\n      console.log(\"Finished updating TOC fields.\");\n    }\n  */\n  });\n}\n\n\n\nasync function insertTableCaption(label=\"Table\") {\n\n\n  await Word.run(async (context) => {\n    const range = context.document.getSelection();\n\n    // Get the text before and after the cursor\n    range.load(\"text\");\n    await context.sync();\n\n    // Clear the current selection (like pressing Enter)\n    range.clear();\n\n    // Replace the selection with a paragraph break\n    // !!Important to have text after the \\r or else range won't update to the\n    // new paragraph for some reason.\n    range.insertText(label + \" \", Word.InsertLocation.replace)\n\n    // Move to the newly created paragraph\n    const newParagraph = range.paragraphs.getLast();\n\n    // Move the selection to the new paragraph\n    //newParagraph.select();\n\n    newParagraph.style = \"Caption\"; \n\n    // Get a range just after the inserted text\n    const afterRange = range.getRange(Word.RangeLocation.after);\n\n    // Move the selection to that position\n    afterRange.select();\n\n    await context.sync();\n  });\n\n\n\n  let sectionOoxml = `<pkg:package xmlns:pkg=\"http://schemas.microsoft.com/office/2006/xmlPackage\">\n    <pkg:part pkg:name=\"/_rels/.rels\" pkg:contentType=\"application/vnd.openxmlformats-package.relationships+xml\" pkg:padding=\"512\">\n      <pkg:xmlData>\n        <Relationships xmlns=\"http://schemas.openxmlformats.org/package/2006/relationships\">\n          <Relationship Id=\"rId1\" Type=\"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument\" Target=\"word/document.xml\"/>\n        </Relationships>\n      </pkg:xmlData>\n    </pkg:part>\n\n    <!-- The missing part: Relationships for document.xml -->\n    <pkg:part pkg:name=\"/word/_rels/document.xml.rels\" pkg:contentType=\"application/vnd.openxmlformats-package.relationships+xml\">\n      <pkg:xmlData>\n        <Relationships xmlns=\"http://schemas.openxmlformats.org/package/2006/relationships\">\n          <Relationship Id=\"rId2\" Type=\"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles\" Target=\"styles.xml\"/>\n        </Relationships>\n      </pkg:xmlData>\n    </pkg:part>\n\n\n     <!-- Add the styles definition part -->\n  <pkg:part pkg:name=\"/word/styles.xml\" pkg:contentType=\"application/vnd.openxmlformats-officedocument.wordprocessingml.styles+xml\">\n    <pkg:xmlData>\n      <w:styles xmlns:w=\"http://schemas.openxmlformats.org/wordprocessingml/2006/main\">\n      </w:styles>\n    </pkg:xmlData>\n  </pkg:part>\n\n\n    <pkg:part pkg:name=\"/word/document.xml\" pkg:contentType=\"application/vnd.openxmlformats-officedocument.wordprocessingml.document.main+xml\">\n      <pkg:xmlData>\n\n\n        <w:document xmlns:w=\"http://schemas.openxmlformats.org/wordprocessingml/2006/main\">\n          <w:body>\n\n          <w:p>\n            <!-- important the original markup is \\* but in javascript have to add \\\\* -->\n              <w:fldSimple w:instr=\" SEQ ${label} \\\\* ARABIC \">\n                  <w:r>\n                      <w:rPr>\n                          <w:noProof />\n                      </w:rPr>\n                      <w:t>1</w:t>\n                  </w:r>\n              </w:fldSimple>\n\n              <!-- Separator -->\n              <w:r>\n                <w:t xml:space=\"preserve\"> - </w:t>\n              </w:r>\n          </w:p>\n          \n          </w:body>\n        </w:document>\n\n      </pkg:xmlData>\n    </pkg:part>\n  </pkg:package>`;\n\n\n    await Word.run(async (context) => {\n  \n  try {\n    const selection = context.document.getSelection();\n    let afterRange = selection.getRange(Word.RangeLocation.after);\n    afterRange.insertOoxml(sectionOoxml, Word.InsertLocation.replace);\n\n    // Move the selection to that position\n    afterRange = afterRange.getRange(Word.RangeLocation.after);\n    afterRange.select();\n\n    await context.sync();\n    console.log(\"caption successfully.\");\n  } catch (error) {\n    console.error(\"Failed to set caption:\", error);\n    // Optional fallback: insert API-based break if OOXML fails\n  }\n\n\n/*\n  // hack location to update fields after insert\n    const field = context.document.getSelection().fields.getFirstOrNullObject();\n    field.select(); // This can help trigger the update\n    await context.sync();\n    field.updateResult();\n    await context.sync();\n*/\n  \n    /*\n    const fields = context.document.body.fields;\n    fields.load(\"items\");\n    await context.sync();\n\n    for (let field of fields.items) {\n   //   console.log(field.code); // This is the field instruction\n      field.updateResult();\n    }\n\n    context.sync();\n    */\n\n\n    /*\n    // Insert a new paragraph after the selection\n    const captionParagraph = selection.insertParagraph(\"\", Word.InsertLocation.after);\n\n    // Insert caption label and suffix\n    captionParagraph.insertText(\"Table - \", Word.InsertLocation.start);\n    await context.sync();\n\n   // todo: doens't seem to be an autotext  insertAutoText(\"InsertCaption1\");\n\n   \n    // Apply formatting\n    captionParagraph.style = \"Caption\"; // Must exist in the document\n    captionParagraph.font.bold = false;\n    */\n\n  });\n\n  // todo: bug bug still throws especially when fields have a table of contents\n  // todo: may be able to \n   await updateAllFieldsInBatches(\"Seq\");\n\n}\n\n/*\nTODO: shouldn't add the same <input> tag every time, check for existing and/or add cleanup code.\n*/\nasync function insertImageIntoWord() {\n  const input = document.createElement(\"input\");\n  input.type = \"file\";\n  input.accept = \"image/*\";\n  input.style.display = \"none\";\n\n  input.onchange = function () {\n    const file = input.files[0];\n    if (!file) return;\n\n    const reader = new FileReader();\n    reader.onload = function () {\n      const result = reader.result;\n\n      // Ensure it's a data URL and extract base64\n      const base64 = result.startsWith(\"data:image\")\n        ? result.substring(result.indexOf(\",\") + 1)\n        : null;\n\n      if (!base64) {\n        console.error(\"Invalid image format or reader result.\");\n        return;\n      }\n\n      Word.run(async (context) => {\n        const selection = context.document.getSelection();\n        selection.insertInlinePictureFromBase64(base64, Word.InsertLocation.replace);\n        await context.sync();\n\n        // Style the paragraph at the current selection\n        const paragraph = selection.paragraphs.getFirst();\n        paragraph.load(\"style\");\n        await context.sync();\n\n        // todo: VBA code set the style to \"Picture\" but that style doesn't exist. Not sure why not\n        // causing error.\n        paragraph.style = \"Normal\";\n        await context.sync();\n      });\n    };\n\n    reader.readAsDataURL(file); // Ensures result is a data URL\n  };\n\n  document.body.appendChild(input);\n  input.click();\n}\n\nasync function screenshotFormatGuide() {\n\n   // make a new paragraph where selections paragraph ends\n   await Word.run(async (context) => {\n        const selection = context.document.getSelection();\n\n        // Get the paragraph containing the selection\n        const currentParagraph = selection.paragraphs.getFirst();\n        currentParagraph.load(\"range\");\n        await context.sync();\n\n        // Move cursor to the end of that paragraph\n        const endOfParagraph = currentParagraph.getRange(Word.RangeLocation.end);\n\n        // Insert a new paragraph after it\n        const newParagraph = endOfParagraph.insertParagraph(\"\", Word.InsertLocation.after);\n\n        // Load the range of the new paragraph\n      //  const newRange = newParagraph.getRange();\n       // newRange.select(); // Move the selection to the new paragraph\n\n        // Collapse the range to its end (insertion point only)\n        // this keeps the inserted auto text from being selected when done.\n        const collapsedRange = newParagraph.getRange(Word.RangeLocation.end);\n        collapsedRange.select(); // Moves cursor without selecting content\n\n\n        await context.sync();\n\n        // Type your desired text\n        //newParagraph.insertText(\"Your text goes here.\", Word.InsertLocation.start);\n\n        await context.sync();\n      });\n\n  //    .AttachedTemplate.AutoTextEntries(\"ScreenShotFormat\").Insert Where:=Selection.Range, RichText:=True\n      insertAutoText(\"ScreenShotFormat\");\n\n}\n\n\n\nasync function getOOXML() {\n  await Word.run(async (context) => {\n    const range = context.document.getSelection();\n    const ooxml = range.getOoxml();\n    await context.sync();\n\n    const ooxmlString = ooxml.value;\n    console.log(ooxmlString); // This is your OOXML string\n\n    // Attempt to copy to clipboard\n    try {\n      await navigator.clipboard.writeText(ooxmlString);\n      console.log(\"OOXML copied to clipboard.\");\n    } catch (err) {\n      console.error(\"Failed to copy OOXML to clipboard:\", err);\n    }\n  });\n}\n\nasync function getOOXMLDocument() {\n  await Word.run(async (context) => {\n    const body = context.document.body;\n    const ooxml = body.getOoxml();\n    await context.sync();\n\n    const ooxmlString = ooxml.value;\n    console.log(ooxmlString); // This is your OOXML string\n\n    // Attempt to copy to clipboard\n    try {\n      await navigator.clipboard.writeText(ooxmlString);\n      console.log(\"Document OOXML copied to clipboard.\");\n    } catch (err) {\n      console.error(\"Failed to copy Document OOXML to clipboard:\", err);\n    }\n  });\n}\n\nasync function pasteOOXMLAsDocument() {\n  try {\n    // Read OOXML string from clipboard\n    const ooxmlString = await navigator.clipboard.readText();\n\n    await Word.run(async (context) => {\n      const body = context.document.body;\n      body.insertOoxml(ooxmlString, Word.InsertLocation.replace);\n      await context.sync();\n      console.log(\"Entire document replaced with OOXML from clipboard.\");\n    });\n  } catch (err) {\n    console.error(\"Failed to paste OOXML from clipboard:\", err);\n  }\n}\n\nasync function pasteOOXML() {\n  try {\n    // Read OOXML string from clipboard\n    const ooxmlString = await navigator.clipboard.readText();\n\n    await Word.run(async (context) => {\n      const range = context.document.getSelection();\n      range.insertOoxml(ooxmlString, Word.InsertLocation.after);\n      await context.sync();\n      console.log(\"OOXML pasted from clipboard.\");\n    });\n  } catch (err) {\n    console.error(\"Failed to paste OOXML from clipboard:\", err);\n  }\n}\n\nasync function showAlert(message) {\n   console.log(\"TODO: no alerts implemented\", message);\n   \n}\n\nasync function insertBuildingBlock(context, name, range) {\n  // Simulate AutoText via content control or template logic\n  range.select();\n  await context.sync();\n\n  // TODO: CONSIDER THE RANGE BEING PASSED TO INSERT AUTOTEXT\n  await insertAutoText(name);\n}\n\nfunction isValidBookmarkName(name) {\n  // Must start with a letter and contain only letters, numbers, or underscores\n  return /^[A-Za-z][A-Za-z0-9_]*$/.test(name);\n}\n\nasync function bookmarkExists(bookmarkName ) {\n  if (!isValidBookmarkName(bookmarkName)) {\n    console.warn(`Bookmark name \"${bookmarkName}\" is unsafe for Office.js`);\n    return false;\n  }\n\n  let exists = false;\n\n  try {\n    await Word.run(async (ctx) => {\n      const range = ctx.document.getBookmarkRangeOrNullObject(bookmarkName);\n      range.load();\n      await ctx.sync();\n\n    //  exists = typeof range.text === \"string\";\n      exists = true;\n    });\n  } catch (error) {\n    console.warn(`Bookmark lookup failed for \"${bookmarkName}\":`, error);\n    exists = false;\n  }\n\n  return exists;\n}\n\n/* todo bug bug this doesn't work. and break downstream rich api calls.\n*/\nasync function insertSectionBreakAtSelection(context, type = \"nextPage\") {\n  const selection = context.document.getSelection();\n  await context.sync();\n\n  // todo: there is an InsertBreak support for sections, should be able to use.\n//  selection.insertBreak(Word.BreakType.sectionNext, Word.InsertLocation.after);\n // await context.sync();\n\n\n \n\n// <w:type w:val=\"continuous\"/>\n// TODO: NEEDS TO BE TESTED,  SEEMS TO WORK FOR INSERTING SECTION BUT \n// didn't seem to pick up properties.\n\nlet sectionOoxml = `<pkg:package xmlns:pkg=\"http://schemas.microsoft.com/office/2006/xmlPackage\">\n  <pkg:part pkg:name=\"/_rels/.rels\" pkg:contentType=\"application/vnd.openxmlformats-package.relationships+xml\" pkg:padding=\"512\">\n    <pkg:xmlData>\n      <Relationships xmlns=\"http://schemas.openxmlformats.org/package/2006/relationships\">\n        <Relationship Id=\"rId1\" Type=\"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument\" Target=\"word/document.xml\"/>\n      </Relationships>\n    </pkg:xmlData>\n  </pkg:part>\n  <pkg:part pkg:name=\"/word/document.xml\" pkg:contentType=\"application/vnd.openxmlformats-officedocument.wordprocessingml.document.main+xml\">\n    <pkg:xmlData>\n      <w:document xmlns:w=\"http://schemas.openxmlformats.org/wordprocessingml/2006/main\" >\n        <w:body>\n          <w:p>\n            <w:pPr>\n              <w:sectPr>\n                <w:type w:val=\"nextPage\"/>\n              </w:sectPr>\n            </w:pPr>\n          </w:p>\n        </w:body>\n      </w:document>\n    </pkg:xmlData>\n  </pkg:part>\n</pkg:package>`;\n\n \n\n  try {\n    selection.insertOoxml(sectionOoxml, Word.InsertLocation.after);\n    await context.sync();\n    console.log(\"Section break inserted successfully.\");\n  } catch (error) {\n    console.error(\"Failed to insert section break:\", error);\n    // Optional fallback: insert API-based break if OOXML fails\n  }\n\n\n// doc part body test with image\n// !!! overwrites the image if already one at path but also need to provide so need to figure out\n//   best way to handle. Fine as long as user is working on same template OOXML is generated from.\nsectionOoxml = `<pkg:package xmlns:pkg=\"http://schemas.microsoft.com/office/2006/xmlPackage\">\n  <pkg:part pkg:name=\"/_rels/.rels\" pkg:contentType=\"application/vnd.openxmlformats-package.relationships+xml\" pkg:padding=\"512\">\n    <pkg:xmlData>\n      <Relationships xmlns=\"http://schemas.openxmlformats.org/package/2006/relationships\">\n        <Relationship Id=\"rId1\" Type=\"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument\" Target=\"word/document.xml\"/>\n      </Relationships>\n    </pkg:xmlData>\n  </pkg:part>\n  <pkg:part pkg:name=\"/word/_rels/document.xml.rels\"\n          pkg:contentType=\"application/vnd.openxmlformats-package.relationships+xml\">\n    <pkg:xmlData>\n      <Relationships xmlns=\"http://schemas.openxmlformats.org/package/2006/relationships\">\n        <Relationship Id=\"rId5\"\n                      Type=\"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image\"\n                      Target=\"media/image1.png\"/>\n      </Relationships>\n    </pkg:xmlData>\n  </pkg:part>\n\n  <pkg:part pkg:name=\"/word/media/image1.png\"\n            pkg:contentType=\"image/png\"\n            pkg:compression=\"store\">\n    <pkg:binaryData>\n      iVBORw0KGgoAAAANSUhEUgAAAAoAAAAKCAIAAAACUFjqAAAAFElEQVR42mP8z8AARAwMDPz//x8AAgMBAf0FhVgAAAAASUVORK5CYII=\n    </pkg:binaryData>\n  </pkg:part>\n\n  <pkg:part pkg:name=\"/word/document.xml\" pkg:contentType=\"application/vnd.openxmlformats-officedocument.wordprocessingml.document.main+xml\">\n    <pkg:xmlData>\n      <w:document xmlns:wpc=\"http://schemas.microsoft.com/office/word/2010/wordprocessingCanvas\"\n                    xmlns:cx=\"http://schemas.microsoft.com/office/drawing/2014/chartex\"\n                    xmlns:cx1=\"http://schemas.microsoft.com/office/drawing/2015/9/8/chartex\"\n                    xmlns:cx2=\"http://schemas.microsoft.com/office/drawing/2015/10/21/chartex\"\n                    xmlns:cx3=\"http://schemas.microsoft.com/office/drawing/2016/5/9/chartex\"\n                    xmlns:cx4=\"http://schemas.microsoft.com/office/drawing/2016/5/10/chartex\"\n                    xmlns:cx5=\"http://schemas.microsoft.com/office/drawing/2016/5/11/chartex\"\n                    xmlns:cx6=\"http://schemas.microsoft.com/office/drawing/2016/5/12/chartex\"\n                    xmlns:cx7=\"http://schemas.microsoft.com/office/drawing/2016/5/13/chartex\"\n                    xmlns:cx8=\"http://schemas.microsoft.com/office/drawing/2016/5/14/chartex\"\n                    xmlns:mc=\"http://schemas.openxmlformats.org/markup-compatibility/2006\"\n                    xmlns:aink=\"http://schemas.microsoft.com/office/drawing/2016/ink\"\n                    xmlns:am3d=\"http://schemas.microsoft.com/office/drawing/2017/model3d\"\n                    xmlns:o=\"urn:schemas-microsoft-com:office:office\"\n                    xmlns:oel=\"http://schemas.microsoft.com/office/2019/extlst\"\n                    xmlns:r=\"http://schemas.openxmlformats.org/officeDocument/2006/relationships\"\n                    xmlns:m=\"http://schemas.openxmlformats.org/officeDocument/2006/math\"\n                    xmlns:v=\"urn:schemas-microsoft-com:vml\"\n                    xmlns:wp14=\"http://schemas.microsoft.com/office/word/2010/wordprocessingDrawing\"\n                    xmlns:wp=\"http://schemas.openxmlformats.org/drawingml/2006/wordprocessingDrawing\"\n                    xmlns:w10=\"urn:schemas-microsoft-com:office:word\"\n                    xmlns:w=\"http://schemas.openxmlformats.org/wordprocessingml/2006/main\"\n                    xmlns:w14=\"http://schemas.microsoft.com/office/word/2010/wordml\"\n                    xmlns:w15=\"http://schemas.microsoft.com/office/word/2012/wordml\"\n                    xmlns:w16cex=\"http://schemas.microsoft.com/office/word/2018/wordml/cex\"\n                    xmlns:w16cid=\"http://schemas.microsoft.com/office/word/2016/wordml/cid\"\n                    xmlns:w16=\"http://schemas.microsoft.com/office/word/2018/wordml\"\n                    xmlns:w16du=\"http://schemas.microsoft.com/office/word/2023/wordml/word16du\"\n                    xmlns:w16sdtdh=\"http://schemas.microsoft.com/office/word/2020/wordml/sdtdatahash\"\n                    xmlns:w16sdtfl=\"http://schemas.microsoft.com/office/word/2024/wordml/sdtformatlock\"\n                    xmlns:w16se=\"http://schemas.microsoft.com/office/word/2015/wordml/symex\"\n                    xmlns:wpg=\"http://schemas.microsoft.com/office/word/2010/wordprocessingGroup\"\n                    xmlns:wpi=\"http://schemas.microsoft.com/office/word/2010/wordprocessingInk\"\n                    xmlns:wne=\"http://schemas.microsoft.com/office/word/2006/wordml\"\n                    xmlns:wps=\"http://schemas.microsoft.com/office/word/2010/wordprocessingShape\"\n                    mc:Ignorable=\"w14 w15 w16se w16cid w16 w16cex w16sdtdh w16sdtfl w16du wp14\">\n        <w:body>\n              <w:p w:rsidR=\"00E93316\"\n                     w:rsidRDefault=\"003503CB\"\n                     w:rsidP=\"003503CB\">\n                    <w:r>\n                        <w:drawing>\n                            <wp:inline distT=\"0\"\n                                       distB=\"0\"\n                                       distL=\"0\"\n                                       distR=\"0\"\n                                       wp14:anchorId=\"2A7721B7\"\n                                       wp14:editId=\"375537C8\" xmlns:wp=\"http://schemas.openxmlformats.org/drawingml/2006/wordprocessingDrawing\" xmlns:wp14=\"http://schemas.microsoft.com/office/word/2010/wordprocessingDrawing\">\n                                <wp:extent cx=\"1238423\"\n                                           cy=\"447737\" />\n                                <wp:effectExtent l=\"0\"\n                                                 t=\"0\"\n                                                 r=\"0\"\n                                                 b=\"0\" />\n                                <wp:docPr id=\"7\"\n                                          name=\"Picture 1\" />\n                                <wp:cNvGraphicFramePr>\n                                    <a:graphicFrameLocks xmlns:a=\"http://schemas.openxmlformats.org/drawingml/2006/main\"\n                                                         noChangeAspect=\"1\" />\n                                </wp:cNvGraphicFramePr>\n                                <a:graphic xmlns:a=\"http://schemas.openxmlformats.org/drawingml/2006/main\">\n                                    <a:graphicData uri=\"http://schemas.openxmlformats.org/drawingml/2006/picture\">\n                                        <pic:pic xmlns:pic=\"http://schemas.openxmlformats.org/drawingml/2006/picture\">\n                                            <pic:nvPicPr>\n                                                <pic:cNvPr id=\"7\"\n                                                           name=\"logo.png\" />\n                                                <pic:cNvPicPr />\n                                            </pic:nvPicPr>\n                                            <pic:blipFill>\n                                                <a:blip r:embed=\"rId5\" />\n                                                <a:stretch>\n                                                    <a:fillRect />\n                                                </a:stretch>\n                                            </pic:blipFill>\n                                            <pic:spPr>\n                                                <a:xfrm>\n                                                    <a:off x=\"0\"\n                                                           y=\"0\" />\n                                                    <a:ext cx=\"1238423\"\n                                                           cy=\"447737\" />\n                                                </a:xfrm>\n                                                <a:prstGeom prst=\"rect\">\n                                                    <a:avLst />\n                                                </a:prstGeom>\n                                            </pic:spPr>\n                                        </pic:pic>\n                                    </a:graphicData>\n                                </a:graphic>\n                            </wp:inline>\n                        </w:drawing>\n                    </w:r>\n                </w:p>\n        </w:body>\n      </w:document>\n    </pkg:xmlData>\n  </pkg:part>\n</pkg:package>`\n\n\n// end doc part body test\n/*\n\n  try {\n    selection.insertOoxml(sectionOoxml, Word.InsertLocation.after);\n    await context.sync();\n    console.log(\"Section break inserted successfully.\");\n  } catch (error) {\n    console.error(\"Failed to insert section break:\", error);\n    // Optional fallback: insert API-based break if OOXML fails\n  }\n    */\n\n  // todo: tried inserting a document fragment but it always failed. \n}\n\n\nfunction insertPageBreakAtSelection() {\n  Word.run(async (context) => {\n    const range = context.document.getSelection();\n    range.insertBreak(Word.BreakType.page, Word.InsertLocation.after);\n    await context.sync();\n  }).catch((error) => {\n    console.error(\"Failed to insert page break:\", error);\n  });\n}\n\n// test so can know if wrote values correctly\nasync function readCoverProperties() {\n  await Word.run(async (context) => {\n    const props = context.document.properties.customProperties;\n\n    // Load the collection so we can query safely\n    props.load(\"items\");\n    await context.sync();\n\n    const keys = [\n      \"CoverHeading\",\n      \"CoverHeading2\",\n      \"CoverHeading3\",\n      \"CoverDate\"\n    ];\n\n    for (const key of keys) {\n      const prop = props.getItemOrNullObject(key);\n      prop.load(\"value\");\n      await context.sync();\n\n      if (prop.isNullObject) {\n        console.log(`Property \"${key}\" not found.`);\n      } else {\n        console.log(`Property \"${key}\" = \"${prop.value}\"`);\n      }\n    }\n  }).catch((error) => {\n    console.error(\"Failed to read custom properties:\", error);\n  });\n}\n\nasync function updateTOC() {\n\n  await Word.run(async (context) => {\n    // todo: review, original VBA seemed to have more logic\n    await updateAllFieldsInBatches(\"TOC\");\n  }).catch((error) => {\n    console.error(\"TOC update failed:\", error);\n  });\n}\n\nasync function insertFigureCaption() {\n  await insertTableCaption(\"Figure\")\n}\n\n// todo: this doesn't really seem to work very well. may work if \nasync function getCurrentSection(context) {\n  const selection = context.document.getSelection();\n  const sections = context.document.sections;\n  sections.load(\"items\");\n  await context.sync();\n\n  for (let section of sections.items) {\n    const range = section.body.getRange(\"Whole\");\n    await context.sync();\n\n    const startsAfter = selection.compareLocationWith(range, Word.LocationRelation.after);\n    const endsBefore = selection.compareLocationWith(range, Word.LocationRelation.before);\n    await context.sync();\n\n    if (!startsAfter && !endsBefore) {\n      return section;\n    }\n  }\n\n  throw new Error(\"Current section not found.\");\n}\n\n\nasync function a4Orientation() {\n\n  console.log(\"TODO: A4 rotate not yet implemented\");\n  return;\n\nlet sectionOoxml = `<pkg:package xmlns:pkg=\"http://schemas.microsoft.com/office/2006/xmlPackage\">\n    <pkg:part pkg:name=\"/_rels/.rels\"\n              pkg:contentType=\"application/vnd.openxmlformats-package.relationships+xml\"\n              pkg:padding=\"512\">\n        <pkg:xmlData>\n            <Relationships xmlns=\"http://schemas.openxmlformats.org/package/2006/relationships\">\n                <Relationship Id=\"rId1\"\n                              Type=\"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument\"\n                              Target=\"word/document.xml\" />\n            </Relationships>\n        </pkg:xmlData>\n    </pkg:part>\n    <pkg:part pkg:name=\"/word/_rels/document.xml.rels\"\n              pkg:contentType=\"application/vnd.openxmlformats-package.relationships+xml\">\n        <pkg:xmlData>\n            <Relationships xmlns=\"http://schemas.openxmlformats.org/package/2006/relationships\">\n\n                <Relationship Id=\"rId7\"\n                              Type=\"http://schemas.openxmlformats.org/officeDocument/2006/relationships/footer\"\n                              Target=\"footer1.xml\" />\n                <Relationship Id=\"rId6\"\n                              Type=\"http://schemas.openxmlformats.org/officeDocument/2006/relationships/header\"\n                              Target=\"header1.xml\" />\n\n                <Relationship Id=\"rHeader10\"\n                              Type=\"http://schemas.openxmlformats.org/officeDocument/2006/relationships/header\"\n                              Target=\"header10.xml\" />\n                <Relationship Id=\"rFooter10\"\n                              Type=\"http://schemas.openxmlformats.org/officeDocument/2006/relationships/footer\"\n                              Target=\"footer10.xml\" />\n                <Relationship Id=\"rHeader20\"\n                              Type=\"http://schemas.openxmlformats.org/officeDocument/2006/relationships/header\"\n                              Target=\"header20.xml\" />\n                <Relationship Id=\"rFooter20\"\n                              Type=\"http://schemas.openxmlformats.org/officeDocument/2006/relationships/footer\"\n                              Target=\"footer20.xml\" />\n            </Relationships>\n        </pkg:xmlData>\n    </pkg:part>\n\n        <pkg:part pkg:name=\"/word/header1.xml\"\n              pkg:contentType=\"application/vnd.openxmlformats-officedocument.wordprocessingml.header+xml\">\n        <pkg:xmlData>\n            <w:hdr xmlns:wpc=\"http://schemas.microsoft.com/office/word/2010/wordprocessingCanvas\"\n                   xmlns:cx=\"http://schemas.microsoft.com/office/drawing/2014/chartex\"\n                   xmlns:cx1=\"http://schemas.microsoft.com/office/drawing/2015/9/8/chartex\"\n                   xmlns:cx2=\"http://schemas.microsoft.com/office/drawing/2015/10/21/chartex\"\n                   xmlns:cx3=\"http://schemas.microsoft.com/office/drawing/2016/5/9/chartex\"\n                   xmlns:cx4=\"http://schemas.microsoft.com/office/drawing/2016/5/10/chartex\"\n                   xmlns:cx5=\"http://schemas.microsoft.com/office/drawing/2016/5/11/chartex\"\n                   xmlns:cx6=\"http://schemas.microsoft.com/office/drawing/2016/5/12/chartex\"\n                   xmlns:cx7=\"http://schemas.microsoft.com/office/drawing/2016/5/13/chartex\"\n                   xmlns:cx8=\"http://schemas.microsoft.com/office/drawing/2016/5/14/chartex\"\n                   xmlns:mc=\"http://schemas.openxmlformats.org/markup-compatibility/2006\"\n                   xmlns:aink=\"http://schemas.microsoft.com/office/drawing/2016/ink\"\n                   xmlns:am3d=\"http://schemas.microsoft.com/office/drawing/2017/model3d\"\n                   xmlns:o=\"urn:schemas-microsoft-com:office:office\"\n                   xmlns:oel=\"http://schemas.microsoft.com/office/2019/extlst\"\n                   xmlns:r=\"http://schemas.openxmlformats.org/officeDocument/2006/relationships\"\n                   xmlns:m=\"http://schemas.openxmlformats.org/officeDocument/2006/math\"\n                   xmlns:v=\"urn:schemas-microsoft-com:vml\"\n                   xmlns:wp14=\"http://schemas.microsoft.com/office/word/2010/wordprocessingDrawing\"\n                   xmlns:wp=\"http://schemas.openxmlformats.org/drawingml/2006/wordprocessingDrawing\"\n                   xmlns:w10=\"urn:schemas-microsoft-com:office:word\"\n                   xmlns:w=\"http://schemas.openxmlformats.org/wordprocessingml/2006/main\"\n                   xmlns:w14=\"http://schemas.microsoft.com/office/word/2010/wordml\"\n                   xmlns:w15=\"http://schemas.microsoft.com/office/word/2012/wordml\"\n                   xmlns:w16cex=\"http://schemas.microsoft.com/office/word/2018/wordml/cex\"\n                   xmlns:w16cid=\"http://schemas.microsoft.com/office/word/2016/wordml/cid\"\n                   xmlns:w16=\"http://schemas.microsoft.com/office/word/2018/wordml\"\n                   xmlns:w16du=\"http://schemas.microsoft.com/office/word/2023/wordml/word16du\"\n                   xmlns:w16sdtdh=\"http://schemas.microsoft.com/office/word/2020/wordml/sdtdatahash\"\n                   xmlns:w16sdtfl=\"http://schemas.microsoft.com/office/word/2024/wordml/sdtformatlock\"\n                   xmlns:w16se=\"http://schemas.microsoft.com/office/word/2015/wordml/symex\"\n                   xmlns:wpg=\"http://schemas.microsoft.com/office/word/2010/wordprocessingGroup\"\n                   xmlns:wpi=\"http://schemas.microsoft.com/office/word/2010/wordprocessingInk\"\n                   xmlns:wne=\"http://schemas.microsoft.com/office/word/2006/wordml\"\n                   xmlns:wps=\"http://schemas.microsoft.com/office/word/2010/wordprocessingShape\"\n                   mc:Ignorable=\"w14 w15 w16se w16cid w16 w16cex w16sdtdh w16sdtfl w16du wp14\">\n                <w:p w14:paraId=\"7BB64F1F\"\n                     w14:textId=\"77777777\"\n                     w:rsidR=\"00293608\"\n                     w:rsidRDefault=\"00293608\">\n                    <w:pPr>\n                        <w:pStyle w:val=\"Header\" />\n                    </w:pPr>\n                    <w:r>\n                        <w:t xml:space=\"preserve\">mAIN </w:t>\n                    </w:r>\n                </w:p>\n                <w:p w14:paraId=\"1C066162\"\n                     w14:textId=\"77777777\"\n                     w:rsidR=\"00293608\"\n                     w:rsidRDefault=\"00293608\">\n                    <w:pPr>\n                        <w:pStyle w:val=\"Header\" />\n                    </w:pPr>\n                </w:p>\n            </w:hdr>\n        </pkg:xmlData>\n    </pkg:part>\n\n       <pkg:part pkg:name=\"/word/footer1.xml\"\n              pkg:contentType=\"application/vnd.openxmlformats-officedocument.wordprocessingml.footer+xml\">\n        <pkg:xmlData>\n            <w:ftr xmlns:wpc=\"http://schemas.microsoft.com/office/word/2010/wordprocessingCanvas\"\n                   xmlns:cx=\"http://schemas.microsoft.com/office/drawing/2014/chartex\"\n                   xmlns:cx1=\"http://schemas.microsoft.com/office/drawing/2015/9/8/chartex\"\n                   xmlns:cx2=\"http://schemas.microsoft.com/office/drawing/2015/10/21/chartex\"\n                   xmlns:cx3=\"http://schemas.microsoft.com/office/drawing/2016/5/9/chartex\"\n                   xmlns:cx4=\"http://schemas.microsoft.com/office/drawing/2016/5/10/chartex\"\n                   xmlns:cx5=\"http://schemas.microsoft.com/office/drawing/2016/5/11/chartex\"\n                   xmlns:cx6=\"http://schemas.microsoft.com/office/drawing/2016/5/12/chartex\"\n                   xmlns:cx7=\"http://schemas.microsoft.com/office/drawing/2016/5/13/chartex\"\n                   xmlns:cx8=\"http://schemas.microsoft.com/office/drawing/2016/5/14/chartex\"\n                   xmlns:mc=\"http://schemas.openxmlformats.org/markup-compatibility/2006\"\n                   xmlns:aink=\"http://schemas.microsoft.com/office/drawing/2016/ink\"\n                   xmlns:am3d=\"http://schemas.microsoft.com/office/drawing/2017/model3d\"\n                   xmlns:o=\"urn:schemas-microsoft-com:office:office\"\n                   xmlns:oel=\"http://schemas.microsoft.com/office/2019/extlst\"\n                   xmlns:r=\"http://schemas.openxmlformats.org/officeDocument/2006/relationships\"\n                   xmlns:m=\"http://schemas.openxmlformats.org/officeDocument/2006/math\"\n                   xmlns:v=\"urn:schemas-microsoft-com:vml\"\n                   xmlns:wp14=\"http://schemas.microsoft.com/office/word/2010/wordprocessingDrawing\"\n                   xmlns:wp=\"http://schemas.openxmlformats.org/drawingml/2006/wordprocessingDrawing\"\n                   xmlns:w10=\"urn:schemas-microsoft-com:office:word\"\n                   xmlns:w=\"http://schemas.openxmlformats.org/wordprocessingml/2006/main\"\n                   xmlns:w14=\"http://schemas.microsoft.com/office/word/2010/wordml\"\n                   xmlns:w15=\"http://schemas.microsoft.com/office/word/2012/wordml\"\n                   xmlns:w16cex=\"http://schemas.microsoft.com/office/word/2018/wordml/cex\"\n                   xmlns:w16cid=\"http://schemas.microsoft.com/office/word/2016/wordml/cid\"\n                   xmlns:w16=\"http://schemas.microsoft.com/office/word/2018/wordml\"\n                   xmlns:w16du=\"http://schemas.microsoft.com/office/word/2023/wordml/word16du\"\n                   xmlns:w16sdtdh=\"http://schemas.microsoft.com/office/word/2020/wordml/sdtdatahash\"\n                   xmlns:w16sdtfl=\"http://schemas.microsoft.com/office/word/2024/wordml/sdtformatlock\"\n                   xmlns:w16se=\"http://schemas.microsoft.com/office/word/2015/wordml/symex\"\n                   xmlns:wpg=\"http://schemas.microsoft.com/office/word/2010/wordprocessingGroup\"\n                   xmlns:wpi=\"http://schemas.microsoft.com/office/word/2010/wordprocessingInk\"\n                   xmlns:wne=\"http://schemas.microsoft.com/office/word/2006/wordml\"\n                   xmlns:wps=\"http://schemas.microsoft.com/office/word/2010/wordprocessingShape\"\n                   mc:Ignorable=\"w14 w15 w16se w16cid w16 w16cex w16sdtdh w16sdtfl w16du wp14\">\n                <w:p w14:paraId=\"1CA9D60A\"\n                     w14:textId=\"77777777\"\n                     w:rsidR=\"00293608\"\n                     w:rsidRDefault=\"00293608\">\n                    <w:pPr>\n                        <w:pStyle w:val=\"Footer\" />\n                    </w:pPr>\n                    <w:r>\n                        <w:t>Footer main</w:t>\n                    </w:r>\n                </w:p>\n                <w:p w14:paraId=\"3A8509D6\"\n                     w14:textId=\"77777777\"\n                     w:rsidR=\"00293608\"\n                     w:rsidRDefault=\"00293608\">\n                    <w:pPr>\n                        <w:pStyle w:val=\"Footer\" />\n                    </w:pPr>\n                </w:p>\n            </w:ftr>\n        </pkg:xmlData>\n    </pkg:part>\n    \n    <!-- Header part with linkToPrevious set to false -->\n    <pkg:part pkg:name=\"/word/header10.xml\"\n              pkg:contentType=\"application/vnd.openxmlformats-officedocument.wordprocessingml.header+xml\">\n        <pkg:xmlData>\n            <w:hdr xmlns:w=\"http://schemas.openxmlformats.org/wordprocessingml/2006/main\">\n                <w:linkToPrevious w:val=\"false\" />\n                <w:p>\n                    <w:r>\n                        <w:t>Landscape Section Header</w:t>\n                    </w:r>\n                </w:p>\n            </w:hdr>\n        </pkg:xmlData>\n    </pkg:part>\n    <!-- Footer part with linkToPrevious set to false -->\n    <pkg:part pkg:name=\"/word/footer10.xml\"\n              pkg:contentType=\"application/vnd.openxmlformats-officedocument.wordprocessingml.footer+xml\">\n        <pkg:xmlData>\n            <w:ftr xmlns:w=\"http://schemas.openxmlformats.org/wordprocessingml/2006/main\">\n                <w:linkToPrevious w:val=\"false\" />\n                <w:p>\n                    <w:r>\n                        <w:t>Landscape Section Footer</w:t>\n                    </w:r>\n                </w:p>\n            </w:ftr>\n        </pkg:xmlData>\n    </pkg:part>\n    <!-- Header part with linkToPrevious set to false -->\n    <pkg:part pkg:name=\"/word/header20.xml\"\n              pkg:contentType=\"application/vnd.openxmlformats-officedocument.wordprocessingml.header+xml\">\n        <pkg:xmlData>\n            <w:hdr xmlns:w=\"http://schemas.openxmlformats.org/wordprocessingml/2006/main\">\n                <w:linkToPrevious w:val=\"false\" />\n                <w:p>\n                    <w:r>\n                        <w:t>Header 2</w:t>\n                    </w:r>\n                </w:p>\n            </w:hdr>\n        </pkg:xmlData>\n    </pkg:part>\n    <!-- Footer part with linkToPrevious set to false -->\n    <pkg:part pkg:name=\"/word/footer20.xml\"\n              pkg:contentType=\"application/vnd.openxmlformats-officedocument.wordprocessingml.footer+xml\">\n        <pkg:xmlData>\n            <w:ftr xmlns:w=\"http://schemas.openxmlformats.org/wordprocessingml/2006/main\">\n                <w:linkToPrevious w:val=\"false\" />\n                <w:p>\n                    <w:r>\n                        <w:t>Footer2r</w:t>\n                    </w:r>\n                </w:p>\n            </w:ftr>\n        </pkg:xmlData>\n    </pkg:part>\n    <pkg:part pkg:name=\"/word/document.xml\"\n              pkg:contentType=\"application/vnd.openxmlformats-officedocument.wordprocessingml.document.main+xml\">\n        <pkg:xmlData>\n            <w:document xmlns:w=\"http://schemas.openxmlformats.org/wordprocessingml/2006/main\"\n                        xmlns:r=\"http://schemas.openxmlformats.org/officeDocument/2006/relationships\">\n                <w:body>\n                    <w:p>\n                    <w:r><w:t>First section content</w:t></w:r>\n                    </w:p>\n\n\t\t\t\t\t<!-- drop in a section to preserve current formatting. -->\n                    <w:p>\n                        <w:pPr>\n                            <w:sectPr w:rsidR=\"00000000\"\n                                    w:rsidSect=\"00293608\">\n                                <w:headerReference w:type=\"default\"\n                                                r:id=\"rId6\" />\n                                <w:footerReference w:type=\"default\"\n                                                r:id=\"rId7\" />\n                                <w:pgSz w:w=\"12240\"\n                                        w:h=\"15840\" />\n                                <w:pgMar w:top=\"1440\"\n                                        w:right=\"1440\"\n                                        w:bottom=\"1440\"\n                                        w:left=\"1440\"\n                                        w:header=\"720\"\n                                        w:footer=\"720\"\n                                        w:gutter=\"0\" />\n                                <w:cols w:space=\"720\" />\n                                <w:docGrid w:linePitch=\"360\" />\n                            </w:sectPr>\n                        </w:pPr>\n                        <w:r>\n                            <w:t xml:space=\"preserve\">\n                            </w:t>\n                        </w:r>\n                    </w:p>\n                        <w:p>\n                        <w:r><w:t>middle content</w:t></w:r>\n                    </w:p>\n                    <w:p w:rsidR=\"00895336\"\n                         w:rsidRDefault=\"00895336\">\n                        <w:pPr>\n                            <w:sectPr w:rsidR=\"00895336\"\n                                      w:rsidSect=\"00895336\">\n                                <w:pgSz w:w=\"16838\"\n                                        w:h=\"11906\"\n                                        w:orient=\"landscape\" />\n                                <w:headerReference w:type=\"default\"\n                                                   r:id=\"rHeader20\" />\n                                <w:footerReference w:type=\"default\"\n                                                   r:id=\"rFooter20\" />\n                            </w:sectPr>\n                        </w:pPr>\n                        <w:r>\n                            <w:t xml:space=\"preserve\">\n                            </w:t>\n                        </w:r>\n                    </w:p>\n                    \n\n                    <w:sectPr >\n                    </w:sectPr>\n                </w:body>\n            </w:document>\n        </pkg:xmlData>\n    </pkg:part>\n</pkg:package>`;\n\n \n\n  await Word.run(async (context) => {\n  try {\n\n    let selection = context.document.getSelection();\n\n    // Theory is if i insert a break above then word will do the proper copy/paste of the \n    // header so if first break in document the header/footer will copy correctly.\n    selection.insertBreak(Word.BreakType.sectionNext, Word.InsertLocation.after);\n    await context.sync();\n\n\n      // Move to the new location after the break\n    selection = selection.getRange(Word.RangeLocation.after);\n    selection.insertText(\"selection location after insert\", Word.InsertLocation.start);\n    await context.sync();\n\n    selection.insertOoxml(sectionOoxml, Word.InsertLocation.after);\n    await context.sync();\n\n    console.log(\"Section break inserted successfully.\");\n\n  \n\n  } catch (error) {\n    console.error(\"Failed to insert section break:\", error);\n    // Optional fallback: insert API-based break if OOXML fails\n  }\n    });\n\n\n\n\n}\n\n\n// todo: this is a backup of the insert working for flipping the page to wide and bac\n// but section wasn't unlinked and doesn't deal with when just wnat to add at end of\n// Todo: set. need to test.\n// doesn't look like it would work.\nasync function a4OrientationOld() {\n\n  /*\n  // context.document.body.insertSection(Word.SectionType.nextPage);\n  await Word.run(async (context) => {\n\n    const range = context.document.getSelection();\n   // range.insertBreak(Word.BreakType.sectionNext, Word.InsertLocation.after);\n    const section = await getCurrentSection(context);\n    section.pageSetup.orientation = Word.PageOrientation.portrait;\n    await context.sync();\n  });\n\n  */\n\n  // todo: have to unlink the section previous so can adjust the header.\n\nlet sectionOoxml = `<pkg:package xmlns:pkg=\"http://schemas.microsoft.com/office/2006/xmlPackage\">\n  <pkg:part pkg:name=\"/_rels/.rels\" pkg:contentType=\"application/vnd.openxmlformats-package.relationships+xml\" pkg:padding=\"512\">\n    <pkg:xmlData>\n      <Relationships xmlns=\"http://schemas.openxmlformats.org/package/2006/relationships\">\n        <Relationship Id=\"rId1\" Type=\"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument\" Target=\"word/document.xml\"/>\n      </Relationships>\n    </pkg:xmlData>\n  </pkg:part>\n  <pkg:part pkg:name=\"/word/document.xml\" pkg:contentType=\"application/vnd.openxmlformats-officedocument.wordprocessingml.document.main+xml\">\n    <pkg:xmlData>\n      <w:document xmlns:w=\"http://schemas.openxmlformats.org/wordprocessingml/2006/main\" >\n<w:body>\n                 <w:p w:rsidR=\"00895336\"\n                     w:rsidRDefault=\"00895336\">\n                    <w:r>\n                        <w:t>Before</w:t>\n                    </w:r>\n                </w:p>\n                <w:p w:rsidR=\"00895336\"\n                     w:rsidRDefault=\"00895336\" />\n                <w:p w:rsidR=\"00895336\"\n                     w:rsidRDefault=\"00895336\">\n                    <w:pPr>\n                        <w:sectPr w:rsidR=\"00895336\"\n                                  w:rsidSect=\"00895336\">\n                            <w:pgSz w:w=\"11906\" w:h=\"16838\" />\n                            <w:pgMar w:top=\"1440\"\n                                     w:right=\"1440\"\n                                     w:bottom=\"1440\"\n                                     w:left=\"1440\"\n                                     w:header=\"720\"\n                                     w:footer=\"720\"\n                                     w:gutter=\"0\" />\n                            <w:cols w:space=\"720\" />\n                            <w:docGrid w:linePitch=\"360\" />\n                        </w:sectPr>\n                    </w:pPr>\n                </w:p>\n                <w:p w:rsidR=\"00895336\"\n                     w:rsidRDefault=\"00895336\">\n                    <w:r>\n                        <w:t>In Section break</w:t>\n                    </w:r>\n                </w:p>\n                <w:p w:rsidR=\"00895336\"\n                     w:rsidRDefault=\"00895336\" />\n                <w:p w:rsidR=\"00895336\"\n                     w:rsidRDefault=\"00895336\" />\n                <w:p w:rsidR=\"00895336\"\n                     w:rsidRDefault=\"00895336\">\n                    <w:pPr>\n                        <w:sectPr w:rsidR=\"00895336\"\n                                  w:rsidSect=\"00895336\">\n                            <w:pgSz w:h=\"11906\" w:w=\"16838\"\n                                    w:orient=\"landscape\" />\n                            <w:pgMar w:top=\"1440\"\n                                     w:right=\"1440\"\n                                     w:bottom=\"1440\"\n                                     w:left=\"1440\"\n                                     w:header=\"720\"\n                                     w:footer=\"720\"\n                                     w:gutter=\"0\" />\n                            <w:cols w:space=\"720\" />\n                            <w:docGrid w:linePitch=\"360\" />\n                        </w:sectPr>\n                    </w:pPr>\n                </w:p>\n                <w:p w:rsidR=\"00895336\"\n                     w:rsidRDefault=\"00895336\">\n                    <w:r>\n                        <w:t>Back to Portrait</w:t>\n                    </w:r>\n                </w:p>\n                <w:p w:rsidR=\"00000000\"\n                     w:rsidRDefault=\"00000000\" />\n</w:body>\n      </w:document>\n    </pkg:xmlData>\n  </pkg:part>\n</pkg:package>`;\n\n \n  await Word.run(async (context) => {\n  try {\n    const selection = context.document.getSelection();\n    selection.insertOoxml(sectionOoxml, Word.InsertLocation.after);\n    await context.sync();\n    console.log(\"Section break inserted successfully.\");\n  } catch (error) {\n    console.error(\"Failed to insert section break:\", error);\n    // Optional fallback: insert API-based break if OOXML fails\n  }\n    });\n\n    // then need to insert \n    //  ActiveDocument.AttachedTemplate.AutoTextEntries(\"Header_Landscape\").Insert where:=Selection.Range, RichText:=True\n \n\n}\n\n/*\n\nOn Error Resume Next\n    With Me\n        .Caption = c_Caption & \" \" & c_DocType\n        .txtDate = ActiveDocument.CustomDocumentProperties(\"CoverDate\")\n        .txtCoverTitle = ActiveDocument.CustomDocumentProperties(\"CoverTitle\")\n        .txtCoverSubtitle = ActiveDocument.CustomDocumentProperties(\"CoverSubtitle\")\n        .txtDocType = ActiveDocument.CustomDocumentProperties(\"DocType\")\n    End With\n\n*/\n\nasync function getCustomPropertiesAsJson(propertyNames) {\n    return Word.run(async (context) => {\n        const props = context.document.properties.customProperties;\n        props.load(\"items\");\n        await context.sync();\n\n        const result = {};\n        for (const name of propertyNames) {\n            const match = props.items.find(p => p.key === name);\n            result[name] = match ? match.value : null;\n        }\n\n        return result;\n    });\n}\n\nasync function setCustomPropertiesFromJson(propertyDict) {\n    return Word.run(async (context) => {\n        const props = context.document.properties.customProperties;\n        props.load(\"items\");\n        await context.sync();\n\n        for (const [key, value] of Object.entries(propertyDict)) {\n            const existing = props.items.find(p => p.key === key);\n            if (existing) {\n                existing.value = String(value ?? \"\"); // Update existing\n            } else {\n                props.add(key, String(value ?? \"\")); // Add new\n            }\n        }\n\n        await context.sync();\n    });\n}\n\nfunction getLocalizedLongDate() {\n    const locale = \"en-AU\";\n    const now = new Date();\n\n    return now.toLocaleDateString(locale, {\n        day: \"numeric\",\n        month: \"long\",\n        year: \"numeric\"\n    });\n}\n\n\n// TODO: currently no way in office.js to delete the bookmark so unlike\n// VBA the bookmark will stick around\n// some discussion from msft to add some better bookark api.\nasync function clearBookmarkContent(bookmarkName) {\n    await Word.run(async (context) => {\n\n          const range = context.document.getBookmarkRange(bookmarkName);\n          range.load(\"text\");\n          await context.sync();\n\n          range.clear();\n          await context.sync();\n\n    });\n}\n\nasync function chooseTemplate() {\n    // Dynamically construct full URL to dialog.html\n  const baseUrl = window.location.origin;\n  const path = window.location.pathname;\n  const dir = path.substring(0, path.lastIndexOf(\"/\"));\n\n  // Get properties need for the dialog.\n  const keys = [\"CoverDate\", \"CoverTitle\", \"CoverSubtitle\", \"DocType\"];\n  const values = await getCustomPropertiesAsJson(keys);\n\n\n\n  // passing init variable as query params. If gets to big will need to switch to a message\n  // but pass query params ensures available when dialog first loaded for UI initialization.\n  const date = encodeURIComponent(values[\"CoverDate\"] ?? getLocalizedLongDate());\n  const title = encodeURIComponent(values[\"CoverTitle\"] ?? \"coverTitle\");\n  const subtitle = encodeURIComponent(values[\"CoverSubtitle\"] ?? \"coverSubtitle\");\n  const docType = encodeURIComponent(values[\"DocType\"] ?? \"docType\");\n\n\n  const dialogUrl = `${baseUrl}${dir}/frmReport.html?date=${date}&title=${title}&subtitle=${subtitle}&docType=${docType}&showCover=1`;\n\n  const result = await new Promise((resolve, reject)  => {\n    Office.context.ui.displayDialogAsync(\n      dialogUrl,\n      { height: 85, width: 40 },\n      function (asyncResult) {\n        const dialog = asyncResult.value;\n\n        dialog.addEventHandler(Office.EventType.DialogMessageReceived, async function (arg) {\n\n\n            // Handle X button or Esc key\n            if (event.type === Office.EventType.DialogClosed) {\n              console.log(\"Dialog was closed via X or Esc\");\n\n              dialog.close();\n              console.log(\"dialog was cancelled\");\n              resolve({});\n              return;\n            }\n\n            if (arg.message === \"cancel\") {\n              dialog.close();\n              console.log(\"dialog was cancelled\");\n              resolve({});\n              return;\n            }\n\n            const result = JSON.parse(arg.message);\n            console.log(\"User selections:\", result);\n\n            // todo: define the property names instead of hard code\n            // TODO: coverOption and coverDesign were variables in VBA Would could consider putting the values\n            // in Custom XML (if we can alter) so its not visible to the user if they go to custom properties.\n            let customPropertiesDict = {\n                \"CoverDate\" : result[\"date\"],\n                \"CoverTitle\" : result[\"title\"],\n                \"CoverSubtitle\" : result[\"subtitle\"],\n                \"DocType\" : result[\"docType\"],\n                \"CoverOption\" : result[\"coverOption\"], // \"noCover\" is when noCover is selected\n                \"CoverDesign\" : result[\"coverDesign\"]  // a string of \"1\", \"2\" .., \"5\"\n            }\n\n            \n\n    \n            let coverGrid = null;\n            let colorLogo = null;\n\n            // Do bookmark cleanup based on the cover.\n            if (customPropertiesDict[\"CoverOption\"] == \"noCover\")\n            {\n                // The \"NoCover\" bookmark isn't removed but bookmarks within the range will\n                //  such as coverGrid and coverLogo\n                // TODO: not sure why not just clear the other bookmarks if don't need versus\n                // having a noCover, \n                await clearBookmarkContent(\"NoCover\");\n            }\n            else\n            {\n              switch(customPropertiesDict[\"CoverDesign\"])\n              {\n                case \"1\":\n                  coverGrid = \"1\";\n                  colorLogo = \"CoverLogo_Colour\";\n                  break;\n              case \"2\":\n                  coverGrid = \"2\";\n                  colorLogo = \"CoverLogo_Colour\";\n                break;\n              case \"3\":\n                  coverGrid = \"2\";\n                  colorLogo = \"CoverLogo_White\";\n                  break;\n              case \"4\":\n                  coverGrid = \"2\";\n                  colorLogo = \"CoverLogo_White\";\n                  break;\n                case \"5\": // 5 doesn't have a colorLogo since clears out Cover5 contents\n                    coverGrid = \"5\";\n                    await clearBookmarkContent(\"Cover5\");\n\n                    // will search for bookmarks anywhere so even though CoverFooter is in the hader it will be found.\n                    await insertAutoText(\"CoverFooter\", \"CoverFooter\");\n                    break;\n                default:\n                  // todo shouldn't happen\n                  break;\n              }\n        \n            }\n\n            // Setup cover grid\n            if (coverGrid) {\n                await insertAutoText(\"CoverGrid_\" + coverGrid, \"CoverGrid\");\n            }\n\n    \n            // VBA has a check for CoverLogo bookmark but there isn't really a bookmark \"colorLogo\"\n            // todo: really need a way to check if bookmark exists\n            if (colorLogo) \n            {\n              //   await insertAutoText(colorLogo, \"CoverLogo\");\n            }\n\n            if (customPropertiesDict[\"CoverOption\"] != \"noCover\")\n            {\n                let coverDesign = customPropertiesDict[\"CoverDesign\"];\n                await insertAutoText(\"Cover_\" + coverDesign, \"Cover\");\n            }\n\n\n            // Set the custom properties JSON after the template in case\n            // the Autotext updates the properties as well\n            await setCustomPropertiesFromJson(customPropertiesDict);\n        \n            // Update the fields\n            await updateAllFieldsInBatches(\"DocProperty\");\n\n\n            // also update the Table of Contents if it exists\n            await updateTOC();\n\n            // Use result.date, result.title, etc. in your add-in logic\n            dialog.close();\n\n            resolve({});\n\n          });\n        }\n      );\n    });\n\n    return result;\n}\n\n\n// todo: this is a subset of setting up, just copy/pasted code to expedite prototype.\nasync function updateCoverProperties() {\n   // Dynamically construct full URL to dialog.html\n  const baseUrl = window.location.origin;\n  const path = window.location.pathname;\n  const dir = path.substring(0, path.lastIndexOf(\"/\"));\n\n  // Get properties need for the dialog.\n  const keys = [\"CoverDate\", \"CoverTitle\", \"CoverSubtitle\", \"DocType\"];\n  const values = await getCustomPropertiesAsJson(keys);\n\n\n  // passing init variable as query params. If gets to big will need to switch to a message\n  // but pass query params ensures available when dialog first loaded for UI initialization.\n  const date = encodeURIComponent(values[\"CoverDate\"] ?? getLocalizedLongDate());\n  const title = encodeURIComponent(values[\"CoverTitle\"] ?? \"coverTitle\");\n  const subtitle = encodeURIComponent(values[\"CoverSubtitle\"] ?? \"coverSubtitle\");\n  const docType = encodeURIComponent(values[\"DocType\"] ?? \"docType\");\n\n  // don't include &showCover=1 so only the properties are shown.\n  const dialogUrl = `${baseUrl}${dir}/frmReport.html?date=${date}&title=${title}&subtitle=${subtitle}&docType=${docType}`;\n\n  Office.context.ui.displayDialogAsync(\n    dialogUrl,\n    { height: 40, width: 20 },\n    function (asyncResult) {\n      const dialog = asyncResult.value;\n\n      dialog.addEventHandler(Office.EventType.DialogMessageReceived, async function (arg) {\n        if (arg.message === \"cancel\") {\n          dialog.close();\n          return;\n        }\n\n        const result = JSON.parse(arg.message);\n        console.log(\"User selections:\", result);\n\n        // todo: define the property names instead of hard code\n        // TODO: coverOption and coverDesign were variables in VBA Would could consider putting the values\n        // in Custom XML (if we can alter) so its not visible to the user if they go to custom properties.\n        let customPropertiesDict = {\n            \"CoverDate\" : result[\"date\"],\n            \"CoverTitle\" : result[\"title\"],\n            \"CoverSubtitle\" : result[\"subtitle\"],\n            \"DocType\" : result[\"docType\"],\n        }\n\n         // Set the custom properties JSON, \n          await setCustomPropertiesFromJson(customPropertiesDict);\n\n         // Update the fields that may be depending on it.\n         await updateAllFieldsInBatches(\"DocProperty\");\n\n        // Use result.date, result.title, etc. in your add-in logic\n        dialog.close();\n      });\n    }\n  );\n}\n\n\nasync function insertBackCover() {\n\n\n  // Get properties need for the dialog.\n  const keys = [\"CoverOption\", \"CoverDesign\"];\n  const customPropertiesDict = await getCustomPropertiesAsJson(keys);\n  let autoTextName = null;\n  if (customPropertiesDict[\"CoverOption\"] == \"noCover\")\n  {\n    showAlert(\"Insert Back Cover is not supported for NoCover template choice.\")\n  }\n  else\n  {\n    switch (customPropertiesDict[\"CoverDesign\"])\n    {\n        case \"1\":\n        case \"2\":\n          autoTextName = \"LastPage_White\";\n          break;\n        case \"3\":\n          autoTextName = \"LastPage_Green\";\n          break;\n        case \"4\":\n          autoTextName = \"LastPage_Blue\";\n          break;\n        default:\n           showAlert(`Insert Back Cover is not supported for Cover ${customPropertiesDict[\"CoverDesign\"]} template choice.`)\n          break;\n    }\n  }\n\n  // TODO: ADD A DIALOG FOR IF autoTextName is null MsgBox \"This function is not available for 'No Cover' option\", vbOKOnly, c_Caption\n  // TODO: REVIEW IF SHOULD HIDE THE BACKCOVER BUTTON COMPLETEly if doesn't apply\n  if (autoTextName)\n  {\n     let snippet = await getAutoTextOOXML(autoTextName);\n      await Word.run(async (context) => {\n\n        // Todo: cleanup and understand these selection rules\n        // I had to get the full range again after inserting the paragraph or else section break would be\n        // inserted before the paragraph not after. \n          // Step 1: Get the end of the document\n          let endOfDoc = context.document.body.getRange(Word.RangeLocation.end);\n\n          // Step 2: Collapse the range to a cursor\n          let collapsed = endOfDoc.getRange(Word.RangeLocation.end);\n\n          // Step 3: Insert a paragraph\n          collapsed.insertParagraph(\"\", Word.InsertLocation.after);\n\n          endOfDoc = context.document.body.getRange(Word.RangeLocation.end);\n          collapsed = endOfDoc.getRange(Word.RangeLocation.end);\n\n          // Step 4: Insert a section break (next page)\n          collapsed.insertBreak(Word.BreakType.sectionNext, Word.InsertLocation.after);\n\n           // Step 2: Collapse the range to a cursor again at new end.\n          collapsed = endOfDoc.getRange(Word.RangeLocation.end);\n\n          // Note: could also get an updated range from start of document.\n          collapsed = context.document.body.getRange(Word.RangeLocation.end);\n          \n          // insert the autotext snippet.\n          collapsed.insertOoxml(snippet, Word.InsertLocation.replace);\n        \n\n          await context.sync();\n      });\n\n\n  }\n\n}","// Imports\nvar ___HTML_LOADER_IMPORT_0___ = new URL(\"./taskpane.css\", import.meta.url);\n// Module\nvar code = \" <!DOCTYPE html> <html> <head> <meta charset=\\\"UTF-8\\\"/> <meta http-equiv=\\\"X-UA-Compatible\\\" content=\\\"IE=Edge\\\"/> <meta name=\\\"viewport\\\" content=\\\"width=device-width,initial-scale=1\\\"> <title>Contoso Task Pane Add-in</title> <\" + \"script src=\\\"https://appsforoffice.microsoft.com/lib/1/hosted/office.js\\\"><\" + \"/script> <link rel=\\\"stylesheet\\\" href=\\\"https://res-1.cdn.office.net/files/fabric-cdn-prod_20230815.002/office-ui-fabric-core/11.1.0/css/fabric.min.css\\\"/> <link href=\\\"\" + ___HTML_LOADER_IMPORT_0___ + \"\\\" rel=\\\"stylesheet\\\"/> <style>body,html{height:100%;margin:0;padding:0;font-family:Segoe UI,sans-serif;overflow:hidden}.tab-container{display:flex;flex-direction:column;height:100%;border:1px solid #ccc;border-radius:6px;overflow:hidden}.tab-header{display:flex;flex-wrap:wrap;background-color:#e0e0e0;border-bottom:1px solid #ccc}.tab{font-size:13px;padding:6px 12px;cursor:pointer;flex:0 0 auto;text-align:center;background-color:#d4d4d4;border:1px solid #ccc;border-bottom:none;border-top-left-radius:6px;border-top-right-radius:6px;margin-right:4px;position:relative;z-index:1}.tab.active{background-color:#fff;font-weight:700;z-index:2;border-color:#0078d4 #ccc #fff #ccc}.tab:hover{background-color:#c8c8c8}.tab-body{flex:1;padding:12px;background-color:#fff;border:1px solid #ccc;border-top:none;border-bottom-left-radius:6px;border-bottom-right-radius:6px;overflow-y:auto}.tab-content{display:none}.tab-content.active{display:block}.log-output{height:96px;overflow-y:auto;background-color:#f9f9f9;border-top:1px solid #ccc;font-size:12px;font-family:Consolas,monospace;padding:8px;white-space:pre-wrap;box-sizing:border-box}.ribbon-button-container{display:flex;flex-wrap:wrap;gap:12px;padding:8px}.ribbon-button{width:64px;height:80px;padding:4px;display:flex;flex-direction:column;align-items:center;justify-content:center;border:1px solid #ccc;border-radius:6px;background-color:#f3f3f3;cursor:pointer;transition:background-color .2s ease;text-align:center;position:relative}.ribbon-button:hover{background-color:#e0e0e0}.ribbon-button img{width:24px;height:24px;margin-bottom:6px}.ribbon-button span{font-size:12px;color:#333}.highlight-wrapper{position:relative}.highlight-menu{position:absolute;bottom:-1px;left:0;transform:translateY(100%);background-color:#fff;border:1px solid #ccc;border-radius:4px;box-shadow:0 2px 6px rgba(0,0,0,.15);z-index:10;width:100px}.highlight-menu div{padding:6px 10px;font-size:12px;cursor:pointer}.highlight-menu div:hover{background-color:#eee}.hidden{display:none}.dropdown-arrow{width:0;height:0;border-left:4px solid transparent;border-right:4px solid transparent;border-top:5px solid #333;margin-top:4px;margin:0 auto}i{display:inline-block;width:24px;height:24px}p{font-size:12px!important}</style> <\" + \"script>function showTab(e){document.querySelectorAll(\\\".tab-content\\\").forEach(e=>e.classList.remove(\\\"active\\\")),document.getElementById(e).classList.add(\\\"active\\\"),document.querySelectorAll(\\\".tab\\\").forEach(e=>e.classList.remove(\\\"active\\\")),document.querySelector(`.tab[onclick=\\\"showTab('${e}')\\\"]`).classList.add(\\\"active\\\")}function toggleHighlightMenu(e){if(console.log(\\\"toggle button\\\"),e.target.closest(\\\".highlight-menu\\\"))return;e.stopPropagation(),document.querySelectorAll(\\\".highlight-menu\\\").forEach(e=>e.classList.add(\\\"hidden\\\"));e.currentTarget.querySelector(\\\".highlight-menu\\\").classList.toggle(\\\"hidden\\\")}function handleClick(e){console.log(`Button clicked: ${e}`),document.querySelectorAll(\\\".highlight-menu\\\").forEach(e=>e.classList.add(\\\"hidden\\\"));const[t,o]=e.split(\\\"|\\\");switch(console.log(\\\"Action:\\\",t),o&&console.log(\\\"Metadata:\\\",o),t){case\\\"chooseTemplate\\\":addinCommand.chooseTemplate();break;case\\\"insertFigureCaption\\\":addinCommand.insertFigureCaption();break;case\\\"getOOXML\\\":addinCommand.getOOXML();break;case\\\"getOOXMLDocument\\\":addinCommand.getOOXMLDocument();break;case\\\"pasteOOXML\\\":addinCommand.pasteOOXML();break;case\\\"pasteOOXMLAsDocument\\\":addinCommand.pasteOOXMLAsDocument();break;case\\\"insertPageBreakAtSelection\\\":addinCommand.insertPageBreakAtSelection();break;case\\\"insertBackCover\\\":addinCommand.insertBackCover();break;case\\\"screenshotFormatGuide\\\":addinCommand.screenshotFormatGuide();break;case\\\"insertImageIntoWord\\\":addinCommand.insertImageIntoWord();break;case\\\"insertTableCaption\\\":addinCommand.insertTableCaption();break;case\\\"dynamicTable\\\":addinCommand.dynamicTable(o);break;case\\\"insertAutoText\\\":addinCommand.insertAutoText(o);break;case\\\"clearFormatting\\\":addinCommand.clearFormatting();break;case\\\"setCoverHeadingFontSize\\\":addinCommand.setCoverHeadingFontSize(o);case\\\"setStyle\\\":addinCommand.setStyle(o);break;case\\\"pasteUnformatted\\\":addinCommand.pasteUnformatted();break;case\\\"normalText\\\":addinCommand.setStyle(o);break;case\\\"updateCoverProperties\\\":addinCommand.updateCoverProperties();break;case\\\"updateTOC\\\":addinCommand.updateTOC();break;case\\\"a4Orientation\\\":addinCommand.a4Orientation();break;default:console.log(\\\"no command found for action\\\")}\\\"bold\\\"===t&&Word.run(async e=>{e.document.getSelection().font.bold=!0,await e.sync(),console.log(\\\"Selected text set to bold.\\\")}).catch(function(e){console.log(\\\"Error: \\\"+e),e instanceof OfficeExtension.Error&&console.log(\\\"Debug info: \\\"+JSON.stringify(e.debugInfo))})}document.addEventListener(\\\"click\\\",()=>{document.querySelectorAll(\\\".highlight-menu\\\").forEach(e=>e.classList.add(\\\"hidden\\\"))}),function(){const e=console.log;console.log=function(...t){e.apply(console,t);const o=document.getElementById(\\\"consoleLog\\\");if(o){const e=t.map(e=>\\\"object\\\"==typeof e?JSON.stringify(e,null,2):String(e)).join(\\\" \\\"),n=document.createElement(\\\"div\\\");n.textContent=e,o.appendChild(n),o.scrollTop=o.scrollHeight}}}(),function(){const e=console.error;console.error=function(...t){e.apply(console,t);const o=document.getElementById(\\\"consoleLog\\\");if(o){const e=t.map(e=>\\\"object\\\"==typeof e?JSON.stringify(e,null,2):String(e)).join(\\\" \\\"),n=document.createElement(\\\"div\\\");n.textContent=e,o.appendChild(n),o.scrollTop=o.scrollHeight}}}()<\" + \"/script> </head> <body class=\\\"\\\"> <div class=\\\"tab-container\\\"> <div class=\\\"tab-header\\\"> <div class=\\\"tab active\\\" onclick='showTab(\\\"template\\\")'>Template</div> <div class=\\\"tab\\\" onclick='showTab(\\\"styles\\\")'>Styles</div> <div class=\\\"tab\\\" onclick='showTab(\\\"tableTools\\\")'>Table Tools</div> <div class=\\\"tab\\\" onclick='showTab(\\\"pageLayout\\\")'>Page Layout</div> <div class=\\\"tab\\\" onclick='showTab(\\\"debug\\\")'>Debug</div> <div class=\\\"tab\\\" onclick='showTab(\\\"help\\\")'>Help</div> </div> <div class=\\\"tab-body\\\"> <div id=\\\"template\\\" class=\\\"tab-content active\\\"> <div class=\\\"ribbon-button-container\\\"> <div class=\\\"ribbon-button\\\" onclick='handleClick(\\\"insertBackCover\\\")'> <span>Insert Back Page</span> </div> <div class=\\\"ribbon-button\\\" onclick='handleClick(\\\"updateCoverProperties\\\")'> <span>Update Cover Details</span> </div> </div> </div> <div id=\\\"styles\\\" class=\\\"tab-content\\\"> <div class=\\\"ribbon-button-container\\\"> <div class=\\\"ribbon-button\\\" onclick='handleClick(\\\"pasteUnformatted\\\")'> <i aria-hidden=\\\"true\\\" iconname=\\\"Paste_24\\\" zclass=\\\"___1n6nxe4 f1o7jddm f14t3ns0 fmd4ok8 f71fsbu fdgdznj f1sj8vnk\\\" data-icon-name=\\\"Paste_24\\\"><svg height=\\\"100%\\\" width=\\\"100%\\\" viewBox=\\\"0,0,2048,2048\\\" focusable=\\\"false\\\"><path type=\\\"path\\\" class=\\\"OfficeIconColors_HighContrast\\\" d=\\\"M1621 768q35 0 61 25 25 25 25 60v854q0 35-25 60-25 25-61 25h-597q-35 0-60-25-25-25-25-60v-854q0-35 25-60 25-25 60-25h597z m-597-85q-71 0-121 50-50 50-50 120v854q0 71 50 120 50 50 121 50h597q71 0 121-50 50-50 50-120v-854q0-71-50-120-50-50-121-50h-597z m-256-171q-71 0-121-50-50-50-50-121h-128q-53 0-90 38-37 37-38 90v1195q0 53 38 91 37 37 90 37h256q18 0 31 12 12 12 12 31 0 18-12 30-12 12-31 12h-256q-88 0-151-62-62-62-62-151v-1195q0-88 62-151 62-62 151-62h151q23-39 61-62 40-24 87-23h341q47 0 87 23 39 23 61 62h151q88 0 151 62 62 62 62 151v86q0 18-12 30-12 12-30 12-18 0-31-12-12-12-12-30v-86q0-53-37-90-37-37-91-38h-128q0 71-50 121-50 50-121 50h-341z m0-256q-35 0-60 25-25 25-25 60 0 35 25 61 25 25 60 25h341q35 0 61-25 25-25 25-61 0-35-25-60-25-25-61-25h-341z\\\"></path><path type=\\\"path\\\" zclass=\\\"OfficeIconColors_m22\\\" d=\\\"M1621 768q35 0 61 25 25 25 25 60v854q0 35-25 60-25 25-61 25h-597q-35 0-60-25-25-25-25-60v-854q0-35 25-60 25-25 60-25h597z m-597-85q-71 0-121 50-50 50-50 120v854q0 71 50 120 50 50 121 50h597q71 0 121-50 50-50 50-120v-854q0-71-50-120-50-50-121-50h-597z\\\"></path><path type=\\\"path\\\" class=\\\"OfficeIconColors_m212\\\" d=\\\"M469 1835h299v-982q0-106 75-181 75-75 181-75h555v-128q0-71-50-120-50-50-121-50h-171q0 43-25 103-28 68-60 67h-427q-32 0-60-67-25-60-25-103h-171q-71 0-120 50-50 50-50 120v1195q0 71 50 121 50 50 120 50z\\\"></path><path type=\\\"path\\\" class=\\\"OfficeIconColors_m211\\\" d=\\\"M768 512q-71 0-121-50-50-50-50-121h-128q-53 0-90 38-37 37-38 90v1195q0 53 38 91 37 37 90 37h256q18 0 31 12 12 12 12 31 0 18-12 30-12 12-31 12h-256q-88 0-151-62-62-62-62-151v-1195q0-88 62-151 62-62 151-62h151q23-39 61-62 40-24 87-23h341q47 0 87 23 39 23 61 62h151q88 0 151 62 62 62 62 151v86q0 18-12 30-12 12-30 12-18 0-31-12-12-12-12-30v-86q0-53-37-90-37-37-91-38h-128q0 71-50 121-50 50-121 50h-341z m0-256q-35 0-60 25-25 25-25 60 0 35 25 61 25 25 60 25h341q35 0 61-25 25-25 25-61 0-35-25-60-25-25-61-25h-341z\\\"></path></svg></i> <span>Paste Unformatted</span> </div> <div class=\\\"ribbon-button\\\" onclick='handleClick(\\\"setStyle|Section Heading\\\")'> <Zimg src=\\\"https://static.thenounproject.com/png/20462-200.png\\\" alt=\\\"Highlight\\\"/> <span>Section Heading</span> </div> <div class=\\\"ribbon-button highlight-wrapper\\\" onclick=\\\"toggleHighlightMenu(event)\\\"> <Zimg src=\\\"https://static.thenounproject.com/png/20462-200.png\\\" alt=\\\"Highlight\\\"/> <span>Cover Styless</span> <div class=\\\"dropdown-arrow\\\"></div> <div class=\\\"highlight-menu hidden\\\"> <div onclick='handleClick(\\\"setStyle|Cover Heading\\\")'>Cover Heading</div> <div onclick='handleClick(\\\"setStyle|Cover Subheading\\\")'>Cover Subheading</div> <div onclick='handleClick(\\\"setStyle|Cover Details\\\")'>Cover Details</div> </div> </div> <div class=\\\"ribbon-button highlight-wrapper\\\" onclick=\\\"toggleHighlightMenu(event)\\\"> <Zimg src=\\\"https://static.thenounproject.com/png/20462-200.png\\\" alt=\\\"Highlight\\\"/> <span>Headings</span> <div class=\\\"dropdown-arrow\\\"></div> <div class=\\\"highlight-menu hidden\\\"> <div onclick='handleClick(\\\"setStyle|Heading 1\\\")'>Heading 1</div> <div onclick='handleClick(\\\"setStyle|Heading 2\\\")'>Heading 2</div> <div onclick='handleClick(\\\"setStyle|Heading 3\\\")'>Heading 3</div> </div> </div> <div class=\\\"ribbon-button highlight-wrapper\\\" onclick=\\\"toggleHighlightMenu(event)\\\"> <Zimg src=\\\"https://static.thenounproject.com/png/20462-200.png\\\" alt=\\\"Highlight\\\"/> <span>Bullets</span> <div class=\\\"dropdown-arrow\\\"></div> <div class=\\\"highlight-menu hidden\\\"> <div onclick='handleClick(\\\"setStyle|List Bullet\\\")'>List Bullet 1</div> <div onclick='handleClick(\\\"setStyle|List Bullet 2\\\")'>List Bullet 2</div> <div onclick='handleClick(\\\"setStyle|List Bullet 3\\\")'>List Bullet 3</div> <div onclick='handleClick(\\\"setStyle|List Bullet 4\\\")'>List Bullet 4</div> <div onclick='handleClick(\\\"setStyle|List Bullet 5\\\")'>List Bullet 5</div> </div> </div> <div class=\\\"ribbon-button highlight-wrapper\\\" onclick=\\\"toggleHighlightMenu(event)\\\"> <Zimg src=\\\"https://static.thenounproject.com/png/20462-200.png\\\" alt=\\\"Highlight\\\"/> <span>Numbering</span> <div class=\\\"dropdown-arrow\\\"></div> <div class=\\\"highlight-menu hidden\\\"> <div onclick='handleClick(\\\"setStyle|List Number\\\")'>List Number 1</div> <div onclick='handleClick(\\\"setStyle|List Number 2\\\")'>List Number 2</div> <div onclick='handleClick(\\\"setStyle|List Number 3\\\")'>List Number 3</div> </div> </div> </div> </div> <div id=\\\"tableTools\\\" class=\\\"tab-content\\\"> <div style=\\\"font-size:8\\\"> <p style=\\\"font-weight:700\\\">Table items not implemented:</p> <p>Insert Table: TODO: make a dialog to specify rows and columns instead of hardcoded.</p> </div> <div class=\\\"ribbon-button-container\\\"> <div class=\\\"ribbon-button\\\" onclick='handleClick(\\\"dynamicTable\\\")'> <i aria-hidden=\\\"true\\\" iconname=\\\"Table_24\\\" class=\\\"___1n6nxe4 f1o7jddm f14t3ns0 fmd4ok8 f71fsbu fdgdznj f1sj8vnk\\\" data-icon-name=\\\"Table_24\\\"><svg height=\\\"100%\\\" width=\\\"100%\\\" viewBox=\\\"0,0,2048,2048\\\" focusable=\\\"false\\\"><path type=\\\"path\\\" class=\\\"OfficeIconColors_HighContrast\\\" d=\\\"M256 469q0-88 62-151 62-62 151-62h1110q88 0 151 62 62 62 62 151v1110q0 88-62 151-62 62-151 62h-1110q-88 0-151-62-62-62-62-151v-1110z m85 299v512h342v-512h-342z m427 0v512h512v-512h-512z m597 0v512h342v-512h-342z m-896-427q-53 0-90 38-37 37-38 90v214h1366v-214q0-53-38-90-37-37-90-38h-1110z m-128 1024v214q0 53 38 90 37 37 90 38h214v-342h-342z m427 0v342h512v-342h-512z m597 0v342h214q53 0 90-38 37-37 38-90v-214h-342z\\\"></path><path type=\\\"path\\\" class=\\\"OfficeIconColors_m22\\\" d=\\\"M256 1579v-854h1536v854q0 88-62 151-62 62-151 62h-1110q-88 0-151-62-62-62-62-151z m85-214v214q0 53 38 90 37 37 90 38h214v-342h-342z m427 0v342h512v-342h-512z m597 0v342h214q53 0 90-38 37-37 38-90v-214h-342z m0-597v512h342v-512h-342z m-85 512v-512h-512v512h512z m-939 0h342v-512h-342v512z\\\"></path><path type=\\\"path\\\" class=\\\"OfficeIconColors_m223\\\" d=\\\"M1579 299h-1110q-71 0-120 50-50 50-50 120v256h1450v-256q0-71-50-120-50-50-120-50z\\\"></path><path type=\\\"path\\\" class=\\\"OfficeIconColors_m22\\\" d=\\\"M469 256q-88 0-151 62-62 62-62 151v1110q0 88 62 151 62 62 151 62h1110q88 0 151-62 62-62 62-151v-1110q0-88-62-151-62-62-151-62h-1110z m-128 213q0-53 38-90 37-37 90-38h1110q53 0 90 38 37 37 38 90v214h-1366v-214z m0 1110v-214h342v342h-214q-53 0-90-38-37-37-38-90z m427 128v-342h512v342h-512z m597 0v-342h342v214q0 53-38 90-37 37-90 38h-214z m0-427v-512h342v512h-342z m-85-512v512h-512v-512h512z m-597 512h-342v-512h342v512z\\\"></path><path type=\\\"path\\\" class=\\\"OfficeIconColors_m224\\\" d=\\\"M256 469q0-88 62-151 62-62 151-62h1110q88 0 151 62 62 62 62 151v299h-1536v-299z m213-128q-53 0-90 38-37 37-38 90v214h1366v-214q0-53-38-90-37-37-90-38h-1110z\\\"></path></svg></i> <span>Insert Table</span> </div> <div class=\\\"ribbon-button highlight-wrapper\\\" onclick=\\\"toggleHighlightMenu(event)\\\"> <i aria-hidden=\\\"true\\\" iconname=\\\"GrowFont_16\\\" class=\\\"___1n6nxe4 f1o7jddm f14t3ns0 fmd4ok8 f71fsbu fdgdznj f1sj8vnk\\\" data-icon-name=\\\"GrowFont_16\\\"><svg height=\\\"100%\\\" width=\\\"100%\\\" viewBox=\\\"0,0,2048,2048\\\" focusable=\\\"false\\\"><path type=\\\"path\\\" class=\\\"OfficeIconColors_HighContrast\\\" d=\\\"M1800 731q13 23 38 31 25 7 49-6 23-13 31-38 7-25-6-49l-264-475q-24-43-69-59-43-15-86 0-45 16-69 59l-264 475q-13 23-6 49 7 25 31 38 23 13 49 6 25-7 38-31l264-475 264 475z m-1096-347q20 0 37 12 17 12 23 30l512 1408q9 25-2 49-11 24-36 33-25 9-49-2-24-11-33-36l-171-470h-562l-171 470q-9 25-33 36-24 11-49 2-25-9-36-33-11-24-2-49l512-1408q7-19 23-30 17-12 37-12z m0 251l-234 645h468l-234-645z\\\"></path><path type=\\\"path\\\" class=\\\"OfficeIconColors_m24\\\" d=\\\"M1887 756q-23 13-49 6-25-7-38-31l-264-475-264 475q-13 23-38 31-25 7-49-6-23-13-31-38-7-25 6-49l264-475q24-43 69-59 43-15 86 0 45 16 69 59l264 475q13 23 6 49-7 25-31 38z\\\"></path><path type=\\\"path\\\" class=\\\"OfficeIconColors_m22\\\" d=\\\"M764 426q-7-19-23-30-17-12-37-12-20 0-37 12-17 12-23 30l-512 1408q-9 25 2 49 11 24 36 33 25 9 49-2 24-11 33-36l171-470h562l171 470q9 25 33 36 24 11 49 2 25-9 36-33 11-24 2-49l-512-1408z m174 854h-468l234-645 234 645z\\\"></path></svg></i> <span>Table Styles</span> <div class=\\\"dropdown-arrow\\\"></div> <div class=\\\"highlight-menu hidden\\\"> <div onclick='handleClick(\\\"setStyle|Table Heading\\\")'>Table Heading</div> <div onclick='handleClick(\\\"setStyle|Table Column\\\")'>Table Column</div> <div onclick='handleClick(\\\"setStyle|Table Text\\\")'>Table Text</div> </div> </div> <div class=\\\"ribbon-button\\\" onclick='handleClick(\\\"insertTableCaption\\\")'> <span>Insert Table Caption</span> </div> </div> </div> <div id=\\\"pageLayout\\\" class=\\\"tab-content\\\"> <div style=\\\"font-size:8\\\"> <p style=\\\"font-weight:700\\\">PageLaoyout items not implemented:</p> <p>A4 orientation: can't change through office.js. Investigating using OOXML but no solution found.</p> </div> <div class=\\\"ribbon-button-container\\\"> <div class=\\\"ribbon-button\\\" onclick='handleClick(\\\"updateTOC\\\")'> <span>Update TOC</span> </div> <div class=\\\"ribbon-button\\\" onclick='handleClick(\\\"a4Orientation\\\")'> <span>A4 Orientation</span> </div> <div class=\\\"ribbon-button\\\" onclick='handleClick(\\\"insertPageBreakAtSelection\\\")'> <span>Insert Page Break</span> </div> <div class=\\\"ribbon-button\\\" onclick='handleClick(\\\"insertFigureCaption\\\")'> <span>Insert Figure Caption</span> </div> <div class=\\\"ribbon-button\\\" onclick='handleClick(\\\"insertImageIntoWord\\\")'> <span>Insert Picture</span> </div> <div class=\\\"ribbon-button\\\" onclick='handleClick(\\\"insertAutoText|CaseStudy\\\")'> <span>Insert Case Study</span> </div> <div class=\\\"ribbon-button\\\" onclick='handleClick(\\\"insertAutoText|Checklist\\\")'> <span>Insert Checklist</span> </div> <div class=\\\"ribbon-button\\\" onclick='handleClick(\\\"insertAutoText|Quote\\\")'> <span>Insert Quote</span> </div> <div class=\\\"ribbon-button\\\" onclick='handleClick(\\\"insertAutoText|PulloutBox\\\")'> <span>Insert Pullout Box</span> </div> <div class=\\\"ribbon-button\\\" onclick='handleClick(\\\"insertAutoText|FeatureBox\\\")'> <span>Insert Feature Box</span> </div> </div> </div> <div id=\\\"debug\\\" class=\\\"tab-content\\\"> <div>The debug tab won't be visible in production.</div> <div class=\\\"ribbon-button-container\\\"> <div class=\\\"ribbon-button\\\" onclick='handleClick(\\\"getOOXML\\\")'> <span>Copy selection OOXML</span> </div> <div class=\\\"ribbon-button\\\" onclick='handleClick(\\\"getOOXMLDocument\\\")'> <span>Copy document OOXML</span> </div> <div class=\\\"ribbon-button\\\" onclick='handleClick(\\\"pasteOOXML\\\")'> <span>Paste OOXML at selection</span> </div> <div class=\\\"ribbon-button\\\" onclick='handleClick(\\\"pasteOOXMLAsDocument\\\")'> <span>Paste OOXML as document</span> </div> </div> </div> <div id=\\\"help\\\" class=\\\"tab-content\\\"> <div> <div> <img src=\\\"https://upsidedown.com.au/wp-content/uploads/2019/03/Templates-logo-animation.png\\\" alt=\\\"UPSIDE TEMPLATES Logo\\\" style=\\\"height:60px\\\"> <h2 style=\\\"margin:10px 0\\\">About this template</h2> </div> <p>This template was created by <strong>UpsideDown Productions</strong>:</p> <p>Tel: +61 (0)2 9411 4548<br> <a href=\\\"http://www.upsidedown.com.au\\\" target=\\\"_blank\\\">www.upsidedown.com.au</a><br> </p></div> </div> </div> <div id=\\\"consoleLog\\\" class=\\\"log-output\\\"></div> </div></body> </html> \";\n// Exports\nexport default code;"],"names":["__webpack_module_cache__","__webpack_require__","moduleId","cachedModule","undefined","exports","module","__webpack_modules__","m","d","definition","key","o","Object","defineProperty","enumerable","get","g","globalThis","this","Function","e","window","obj","prop","prototype","hasOwnProperty","call","scriptUrl","importScripts","location","document","currentScript","tagName","toUpperCase","src","scripts","getElementsByTagName","length","i","test","Error","replace","p","b","baseURI","self","href","t","r","Symbol","n","iterator","toStringTag","c","Generator","u","create","_regeneratorDefine2","f","y","G","v","a","bind","l","TypeError","done","value","return","GeneratorFunction","GeneratorFunctionPrototype","getPrototypeOf","setPrototypeOf","__proto__","displayName","_regenerator","w","_invoke","configurable","writable","asyncGeneratorStep","Promise","resolve","then","_asyncToGenerator","arguments","apply","_next","_throw","action","event","completed","launcHelpTaskpane","_x2","_launcHelpTaskpane","_callee7","_context7","launchTaskpane","showTab","_x3","_launchTaskpane","_callee8","keys","_context8","console","log","getCustomPropertiesAsJson","chooseTemplate","showAlert","Office","addin","showAsTaskpane","catch","error","_setStyle","_callee0","styleName","_t","_context0","Word","run","_ref5","_callee9","context","_context9","getSelection","style","sync","_x24","OfficeExtension","message","code","trace","traceMessages","_clearFormatting","_callee10","_t2","_context10","_ref6","_callee1","selection","font","_context1","bold","italic","underline","color","highlightColor","strikeThrough","subscript","superscript","_x25","addinCommand","pasteUnformatted","navigator","clipboard","readText","clipText","_ref2","_callee2","_context2","insertText","InsertLocation","_x4","err","setStyle","_x5","setCoverHeadingFontSize","_x9","_setCoverHeadingFontSize","clearFormatting","insertAutoText","dynamicTable","_dynamicTable","insertTableCaption","insertImageIntoWord","_insertImageIntoWord","screenshotFormatGuide","_screenshotFormatGuide","insertBackCover","_insertBackCover","insertPageBreakAtSelection","_ref3","_callee3","_context3","insertBreak","BreakType","page","after","_x18","updateCoverProperties","_updateCoverProperties","updateTOC","insertFigureCaption","_insertFigureCaption","a4Orientation","_a4Orientation","getOOXML","_getOOXML","getOOXMLDocument","_getOOXMLDocument","pasteOOXML","_pasteOOXML","pasteOOXMLAsDocument","_pasteOOXMLAsDocument","onReady","_ref","_callee","info","_context","actions","associate","_x","ahrc_CacheXml","getAutoTextOOXML","_x6","_getAutoTextOOXML","_callee11","autoText_identifier","xmlDoc","response","xmlText","parser","snippetNode","snippet","_context11","fetch","ok","concat","statusText","text","DOMParser","parseFromString","querySelector","textContent","_x7","_insertAutoText","_callee13","bookmarkName","_t3","_args13","_context13","_ref7","_callee12","insertRange","_context12","getBookmarkRange","load","clear","insertOoxml","_x26","_callee17","size","_t5","_context17","_ref9","_callee16","props","styles","coverHeadingStyle","getProp","coverChosen","docType","caption","docTypeLabel","_context16","properties","customProperties","getStyles","getByNameOrNullObject","name","items","find","isNullObject","_x28","_callee18","options","_context18","numRows","numCols","coloredBorders","lineBreaks","headerRow","firstColumn","lastColumn","totalRow","centerAligned","insertOrFormatTable","_x0","_insertOrFormatTable","_callee20","_t6","_context20","_ref0","_callee19","table","range","_context19","tables","insertParagraph","getRange","insertTable","blackBorders","headerRowCount","rows","getFirst","applyStyleToCellParagraphs","cells","_x29","_x1","_x10","_x11","_applyStyleToCellParagraphs","_callee21","_context21","forEach","cell","body","paragraphs","paragraph","updateAllFieldsInBatches","_updateAllFieldsInBatches","_callee23","fieldType","_args23","_context23","_ref1","_callee22","allFields","otherFields","batchSize","batchEnd","j","_context22","fields","filter","field","type","Math","min","updateResult","_x30","_insertTableCaption","_callee26","label","sectionOoxml","_args26","_context26","_ref10","_callee24","_context24","getLast","RangeLocation","select","_x31","_ref11","_callee25","afterRange","_t7","_context25","_x32","_callee28","input","_context28","createElement","accept","display","onchange","file","files","reader","FileReader","onload","result","base64","startsWith","substring","indexOf","_ref12","_callee27","_context27","insertInlinePictureFromBase64","_x33","readAsDataURL","appendChild","click","_callee30","_context30","_ref13","_callee29","currentParagraph","endOfParagraph","_context29","end","_x34","_callee32","_context32","_ref14","_callee31","ooxml","ooxmlString","_t8","_context31","getOoxml","writeText","_x35","_callee34","_context34","_ref15","_callee33","_t9","_context33","_x36","_callee36","_t0","_context36","_ref16","_callee35","_context35","_x37","_callee38","_t1","_context38","_ref17","_callee37","_context37","_x38","_x12","_showAlert","_callee39","_context39","_updateTOC","_callee47","_context47","_ref20","_callee46","_context46","_x41","_callee48","_context48","_callee51","_context51","_x20","_getCustomPropertiesAsJson","_callee55","propertyNames","_context56","_ref23","_callee54","_iterator2","_step2","_loop","_t15","_context55","_createForOfIteratorHelper","match","_context54","s","_regeneratorValues","_x44","setCustomPropertiesFromJson","_x21","_setCustomPropertiesFromJson","_callee57","propertyDict","_context59","_ref24","_callee56","_loop2","_i2","_Object$entries","_context58","_Object$entries$_i","existing","_context57","_slicedToArray","String","add","entries","_x45","getLocalizedLongDate","Date","toLocaleDateString","day","month","year","clearBookmarkContent","_x22","_clearBookmarkContent","_callee59","_context61","_ref25","_callee58","_context60","_x46","_chooseTemplate","_callee61","_values$CoverDate","_values$CoverTitle","_values$CoverSubtitle","_values$DocType","baseUrl","path","dir","values","date","title","subtitle","dialogUrl","_context63","origin","pathname","lastIndexOf","encodeURIComponent","reject","ui","displayDialogAsync","height","width","asyncResult","dialog","addEventHandler","EventType","DialogMessageReceived","_ref26","_callee60","arg","customPropertiesDict","coverGrid","coverDesign","_t16","_context62","DialogClosed","close","JSON","parse","_x47","_callee63","_values$CoverDate2","_values$CoverTitle2","_values$CoverSubtitle2","_values$DocType2","_context65","_ref27","_callee62","_context64","_x48","_callee65","autoTextName","_t17","_context67","_ref28","_callee64","endOfDoc","_context66","sectionNext","_x49","URL"],"sourceRoot":""}