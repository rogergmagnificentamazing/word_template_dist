{"version":3,"file":"taskpane.js","mappings":"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","sources":["webpack://office-addin-taskpane/webpack/bootstrap","webpack://office-addin-taskpane/webpack/runtime/define property getters","webpack://office-addin-taskpane/webpack/runtime/global","webpack://office-addin-taskpane/webpack/runtime/hasOwnProperty shorthand","webpack://office-addin-taskpane/webpack/runtime/publicPath","webpack://office-addin-taskpane/webpack/runtime/jsonp chunk loading","webpack://office-addin-taskpane/./src/taskpane/taskpane.ts","webpack://office-addin-taskpane/./src/taskpane/taskpane.html"],"sourcesContent":["// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n// expose the modules object (__webpack_modules__)\n__webpack_require__.m = __webpack_modules__;\n\n","// define getter functions for harmony exports\n__webpack_require__.d = function(exports, definition) {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.g = (function() {\n\tif (typeof globalThis === 'object') return globalThis;\n\ttry {\n\t\treturn this || new Function('return this')();\n\t} catch (e) {\n\t\tif (typeof window === 'object') return window;\n\t}\n})();","__webpack_require__.o = function(obj, prop) { return Object.prototype.hasOwnProperty.call(obj, prop); }","var scriptUrl;\nif (__webpack_require__.g.importScripts) scriptUrl = __webpack_require__.g.location + \"\";\nvar document = __webpack_require__.g.document;\nif (!scriptUrl && document) {\n\tif (document.currentScript && document.currentScript.tagName.toUpperCase() === 'SCRIPT')\n\t\tscriptUrl = document.currentScript.src;\n\tif (!scriptUrl) {\n\t\tvar scripts = document.getElementsByTagName(\"script\");\n\t\tif(scripts.length) {\n\t\t\tvar i = scripts.length - 1;\n\t\t\twhile (i > -1 && (!scriptUrl || !/^http(s?):/.test(scriptUrl))) scriptUrl = scripts[i--].src;\n\t\t}\n\t}\n}\n// When supporting browsers where an automatic publicPath is not supported you must specify an output.publicPath manually via configuration\n// or pass an empty string (\"\") and set the __webpack_public_path__ variable from your code to use your own logic.\nif (!scriptUrl) throw new Error(\"Automatic publicPath is not supported in this browser\");\nscriptUrl = scriptUrl.replace(/^blob:/, \"\").replace(/#.*$/, \"\").replace(/\\?.*$/, \"\").replace(/\\/[^\\/]+$/, \"/\");\n__webpack_require__.p = scriptUrl;","__webpack_require__.b = document.baseURI || self.location.href;\n\n// object to store loaded and loading chunks\n// undefined = chunk not loaded, null = chunk preloaded/prefetched\n// [resolve, reject, Promise] = chunk loading, 0 = chunk loaded\nvar installedChunks = {\n\t926: 0\n};\n\n// no chunk on demand loading\n\n// no prefetching\n\n// no preloaded\n\n// no HMR\n\n// no HMR manifest\n\n// no on chunks loaded\n\n// no jsonp function","/*\n * Copyright (c) Microsoft Corporation. All rights reserved. Licensed under the MIT license.\n * See LICENSE in the project root for license information.\n */\n\n/* global document, Office, Word */\n\n(window as any).addinCommand = {\n  pasteUnformatted,\n  setStyle,\n  setCoverHeadingFontSize,\n  clearFormatting,\n  insertAutoText,\n  dynamicTable,\n  insertTableCaption,\n  insertImageIntoWord,\n  screenshotFormatGuide,\n  insertBackCover,\n  insertPageBreakAtSelection,\n  updateCoverProperties,\n  updateTOC,\n  insertFigureCaption,\n  a4Orientation,\n  getOOXML,\n  getOOXMLDocument,\n  pasteOOXML,\n  pasteOOXMLAsDocument,\n  chooseTemplate\n};\n\n\nOffice.onReady(async (info) => {\n\n  console.log(\"onready in taskpane.\")\n  Office.actions.associate(\"launchTaskpane\", launchTaskpane);\n Office.actions.associate(\"launcHelpTaskpane\", launcHelpTaskpane);\n\n  //\n  \n  // Register the function with Office want to call from the Ribbon.\n  Office.actions.associate(\"action\", action);\n\n  // todo :ribbon test, confirmed ribbon not supported\n  // await updateRibbon();\n});\n\n// placeholder action for ribbon command \nfunction action(event: Office.AddinCommands.Event)\n{\n\n    event.completed();\n\n}\n\nasync function updateRibbon() {\n\n  /* todo: can enable buttons but can't hide */\n  \n  console.log(\"attempting to update ribbon\");\n  await Office.ribbon.requestUpdate({\n    tabs: [\n      {\n        id: \"CustomTab\",\n        visible: false\n      }\n    ]\n  }).then(() => {\n    console.log(\"Custom tab hidden.\");\n  }).catch((error) => {\n    console.error(\"Failed to hide tab:\", error);\n  });\n\n}\n\nexport async function run() {\n  return Word.run(async (context) => {\n    /**\n     * Insert your Word code here\n     */\n\n    // insert a paragraph at the end of the document.\n    const paragraph = context.document.body.insertParagraph(\"Hello World\", Word.InsertLocation.end);\n\n    // change the paragraph color to blue.\n    paragraph.font.color = \"blue\";\n\n    await context.sync();\n  });\n}\n\nasync function launcHelpTaskpane(event)\n{\n   await launchTaskpane(event);\n\n   // todo: should probably check if taskpane actually launched.\n    window.showTab(\"help\");\n\n}\n\nasync function launchTaskpane(event) {\n\n  console.log(\"launch taskpane\");\n\n  // TODO: BUG BUG, IF THIS THROWS AND WE DON'T CALL EVENT.COMPLETE() add-in UI is frozen\n\n  // check if the template has been configured\n  // todo: should just be  acheck function but \n  // do here since currently only place to check.\n  const keys = [\"CoverOption\", \"CoverDesign\"];\n  let customPropertiesDict = await getCustomPropertiesAsJson(keys);\n  if (!customPropertiesDict[\"CoverOption\"])\n  {\n     // if cover option not defined then set it up.\n     // MAGOO\n     await chooseTemplate();\n\n     // the dialog is async so can't wait.\n     // need to have taskpane be launched again via a callback.\n\n   //  event.completed();\n   //  return;\n  }\n\n  customPropertiesDict = await getCustomPropertiesAsJson(keys);\n  if (!customPropertiesDict[\"CoverOption\"])\n  {\n     showAlert(\"properties not set after showing to choose template\");\n     event.completed();\n    return;\n  }\n\n  Office.addin.showAsTaskpane()\n    .then(() => {\n      // Optional: initialize UI or state\n       event.completed();\n    })\n    .catch((error) => {\n      console.error(\"Failed to show taskpane:\", error);\n      event.completed();\n    });\n\n}\n\n/* office doesn't allow clipboard access so use the browser.\n  User will be asked if accessing clipboard is okay\n*/\nexport function pasteUnformatted() {\n  navigator.clipboard.readText().then((clipText) => {\n    Word.run(async (context) => {\n      const selection = context.document.getSelection();\n      selection.insertText(clipText, Word.InsertLocation.replace);\n      await context.sync();\n    });\n  }).catch((err) => {\n    console.error(\"Clipboard access failed:\", err);\n  });\n}\n\n/*\n Set the Style\n*/\n\nexport async function setStyle(styleName) {\n\n  console.log(\"setStyle \" + styleName);\n\n   try {\n    await Word.run(async (context) => {\n      const selection = context.document.getSelection();\n      selection.style = styleName;\n      await context.sync();\n    });\n  } catch (error) {\n\n    // Todo: make a common helper\n    console.log(\"Error applying style:\", styleName, \"Most likely style doesn't exist in document.\");\n\n    if (error instanceof OfficeExtension.Error) {\n        console.error(\"Debug info:\", {\n      message: error.message,\n      code: error.code,\n      trace: error.traceMessages,\n    });\n  }\n\n\n  }\n}\n\n\n/*\nOffice.JS doesn't have a \"Clear Formatting\" so have to manually reset each of the\nproperties we care about resetting to the Style.\n*/\nexport async function clearFormatting() {\n  try {\n    await Word.run(async (context) => {\n      const selection = context.document.getSelection();\n      const font = selection.font;\n\n      // Safely reset local formatting overrides\n      font.bold = false;\n      font.italic = false;\n      font.underline = \"None\";\n      font.color = \"auto\";\n      font.highlightColor = \"None\";\n      font.strikeThrough = false;\n      font.subscript = false;\n      font.superscript = false;\n\n      await context.sync();\n      console.log(\"Local formatting reset to style defaults.\");\n    });\n  } catch (error) {\n    console.error(\"Error resetting formatting:\", error);\n    if (error instanceof OfficeExtension.Error) {\n      console.error(\"Details:\", {\n        message: error.message,\n        code: error.code,\n        trace: error.traceMessages,\n      });\n    }\n  }\n}\n\n\n/* \nTodo: example if using custom.xml for the autotext.\nCould also store the .xml online and Fetch if don't want to store in the document.\n*/\n/*\ntodo: if do the fetch cache after first call so don't fetch and parse every time\n*/\n\nvar netwealth_CacheXml = null;\nvar ahrc_CacheXml = null;\n\nasync function getAutoTextOOXML(autoText_identifier)\n{\n\n let  xmlDoc = null;\n\n    /*\n    // make sure xml is loaded\n    if (!netwealth_CacheXml) {\n      // Step 1: Fetch custom.xml from assets\n      //const response = await fetch(\"./assets/netwealth_custom.xml\");\n\n           const response = await fetch(\"./assets/netwealth_custom.xml\");\n\n      if (!response.ok) {\n        throw new Error(`Failed to fetch custom.xml: ${response.statusText}`);\n      }\n\n      const xmlText = await response.text();\n\n      // Step 2: Parse XML and locate the snippet\n      const parser = new DOMParser();\n      xmlDoc = parser.parseFromString(xmlText, \"application/xml\");\n      netwealth_CacheXml = xmlDoc;\n    }\n*/\n\n      // make sure xml is loaded\n    if (!ahrc_CacheXml) {\n      // Step 1: Fetch custom.xml from assets\n      const response = await fetch(\"./assets/ahrc_custom.xml\");\n      if (!response.ok) {\n        throw new Error(`Failed to fetch custom.xml: ${response.statusText}`);\n      }\n\n      const xmlText = await response.text();\n\n      // Step 2: Parse XML and locate the snippet\n      const parser = new DOMParser();\n      xmlDoc = parser.parseFromString(xmlText, \"application/xml\");\n      ahrc_CacheXml = xmlDoc;\n    }\n\n    //  hack we just check both xmls for prototypeing.\n    let snippetNode = null; // netwealth_CacheXml.querySelector(`Snippet[id='${autoText_identifier}']`);\n\n    if (!snippetNode) {\n      snippetNode = ahrc_CacheXml.querySelector(`Snippet[id='${autoText_identifier}']`);\n      if (!snippetNode) {\n      throw new Error(`Snippet with id '${autoText_identifier}' not found.`);\n      }\n    }\n\n    const snippet = snippetNode.textContent;\n\n    return snippet\n}\n\nexport async function insertAutoText(autoText_identifier, bookmarkName = null) {\n  try {\n\n    let snippet = await getAutoTextOOXML(autoText_identifier);\n\n    // Step 3: Insert OOXML into Word document\n    await Word.run(async (context) => {\n      let insertRange = null;\n      if (bookmarkName) {\n          insertRange = context.document.getBookmarkRange(bookmarkName);\n          insertRange.load(\"text\");\n          await context.sync();\n\n          // TODO: CHECK FOR ERRORS.\n      }\n      else\n      {\n          insertRange = context.document.getSelection();\n      }\n\n\n      // insertOoxml merges and doesn't honor the replace so clear out the range first.\n      insertRange.clear();\n      await context.sync();\n\n\n       insertRange.insertOoxml(snippet, Word.InsertLocation.replace);\n      await context.sync();\n    });\n\n  } catch (error) {\n    console.error(\"Error inserting autotext:\", error);\n    if (error instanceof OfficeExtension.Error) {\n      console.error(\"Details:\", {\n        message: error.message,\n        code: error.code,\n        trace: error.traceMessages,\n      });\n    }\n  }\n}\n\nexport async function insertAutoTextContentXml(autoText_identifier) {\n  try {\n        await Word.run(async (context) => {\n          const parts = context.document.customXmlParts.getByNamespace(\"http://schemas.adu/addin/autotext\");\n          parts.load(\"items\");\n          await context.sync();\n\n          if (parts.items.length === 0) {\n            throw new Error(\"No matching CustomXmlParts found.\");\n          }\n\n          const xmlPart = parts.items[0]; // Now confidently scoped\n          const xml = xmlPart.getXml();\n          await context.sync();\n\n          const parser = new DOMParser();\n          const xmlDoc = parser.parseFromString(xml.value, \"text/xml\");\n          const snippetNode = xmlDoc.querySelector(`Snippet[id='${autoText_identifier}']`);\n\n          if (!snippetNode) {\n            throw new Error(`Snippet with id '${autoText_identifier}' not found.`);\n          }\n\n          const snippet = snippetNode.textContent;\n\n          const selection = context.document.getSelection();\n          selection.insertOoxml(snippet, Word.InsertLocation.replace);\n\n          await context.sync();\n        });\n\n  } catch (error) {\n    console.error(\"Error inserting autotext:\", error);\n    if (error instanceof OfficeExtension.Error) {\n      console.error(\"Details:\", {\n        message: error.message,\n        code: error.code,\n        trace: error.traceMessages,\n      });\n    }\n  }\n}\n\n/*\ntodo: test code for changing style font size\nOffice.js doesn't support changing the font size, \nCould looking into using OOXML direction\n*/\nexport async function setCoverHeadingFontSize(size: number) {\n  try {\n    await Word.run(async (context) => {\n      const props = context.document.properties.customProperties;\n      const styles = context.document.getStyles();\n      \n      props.load(\"items\");\n      const coverHeadingStyle = styles.getByNameOrNullObject(\"Cover Heading\");\n      coverHeadingStyle.load(\"font\");\n      await context.sync();\n\n      const getProp = (name: string) => {\n        const prop = props.items.find(p => p.key === name);\n        return prop ? prop.value : null;\n      };\n\n      const coverChosen = getProp(\"CoverChosen\");\n      const docType = getProp(\"DocumentType\");\n\n      // Todo: clean this up.\n      const caption = \"setCoverHeadingFontSize\";     // Replace with actual value\n      const docTypeLabel = \"\"; // Replace with actual value\n\n      if (coverChosen === \"1\" || coverChosen === \"2\") {\n        console.log(`${caption} ${docTypeLabel}: This option is not designed for the cover you've chosen.`);\n        return;\n      } else if (docType === \"CustomNoCover\") {\n        console.log(`${caption} ${docTypeLabel}: This option is not designed for the custom layout you've chosen.`);\n        return;\n      } else if (docType === \"Simple\") {\n        console.log(`${caption} ${docTypeLabel}: This option is not designed for the simple layout you've chosen.`);\n        return;\n      }\n\n      if (coverHeadingStyle.isNullObject) {\n        console.log(\"Style 'Cover Heading' not found.\");\n        return;\n      }\n\n      coverHeadingStyle.font.size = size;\n      await context.sync();\n\n      console.log(`Updated 'Cover Heading' font size to ${size}pt.`);\n    });\n  } catch (error) {\n    console.error(\"Error during validation or style update:\", error);\n  }\n}\n\n/*\nCode for testing the Insert Table code\n\n*/\n\nasync function dynamicTable()\n{\n  \n   console.trace(\"dynamictable\");\n   let options = {}\n\n   options.numRows = 3;\n   options.numCols = 3;\n   options.coloredBorders = true;\n   options.lineBreaks = false;\n\n   options.headerRow = true;\n   options.firstColumn = true;\n   options.lastColumn = true;\n   options.totalRow = true;\n   options.centerAligned = true;\n\n   insertOrFormatTable(options);\n\n}\n\nasync function insertOrFormatTable(options) {\n  try {\n    await Word.run(async (context) => {\n      const selection = context.document.getSelection();\n      selection.load(\"tables\");\n      await context.sync();\n\n      // todo: this doesn't work, need to determine if in Table or not.\n      let table;\n      if (selection.tables.items.length === 0) {\n        const range = selection.insertParagraph(\"\", Word.InsertLocation.after).getRange();\n        table = range.insertTable(options.numRows, options.numCols, Word.InsertLocation.after, [[\"\"]]);\n      } else {\n        table = selection.tables.items[0];\n      }\n\n      table.load([\"rows\", \"columns\", \"style\"]);\n      await context.sync();\n\n      table.style = \"Table Text\";\n\n      if (options.coloredBorders) {\n        table.style = options.lineBreaks ? \"netwealth Combined Table4\" : \"netwealth Combined Table2\";\n      } else if (options.blackBorders) {\n        table.style = options.lineBreaks ? \"netwealth Combined Table3\" : \"netwealth Combined Table\";\n      }\n\n      if (options.headerRow) {\n        table.headerRowCount = 1;\n        const headerRow = table.rows.getFirst();\n        headerRow.load(\"cells\");\n        await context.sync();\n\n        await applyStyleToCellParagraphs(headerRow.cells.items, \"Table Heading\", context);\n\n      }\n\n      /*\n        Todo: office.js doesn't have a last column need to figure out cells by looking at\n         each row and determining the column\n      // Last Column\n      if (options.lastColumn) {\n        table.lastColumn = true;\n        const lastCol = table.columns.getLast();\n        lastCol.load(\"cells\");\n        await context.sync();\n\n        await applyStyleToCellParagraphs(lastCol.cells.items, \"Table LastColumn\", context);\n      }\n      */\n\n      /*\n      // TODO: there is no rows.getLast(); need to find ourselves\n      // Total Row\n      if (options.totalRow) {\n        table.totalRowCount = 1;\n        const lastRow = table.rows.getLast();\n        lastRow.load(\"cells\");\n        await context.sync();\n\n        await applyStyleToCellParagraphs(lastRow.cells.items, \"Table TotalRow\", context);\n      }\n      */\n\n\n      /*\n      // TODO: not loading the proper context ehre and getting errors. \n\n  if (options.centerAligned) {\n    \n      // Step 1: Load rows collection\n      table.rows.load(\"items\");\n      await context.sync();\n\n      // Step 2: Load cells for each row\n      for (const row of table.rows.items) {\n        row.load(\"cells\");\n      }\n      await context.sync();\n\n        const colCount = table.rows.items[0].cells.items.length;\n\n      // Load paragraphs in each cell (columns 2+)\n      for (const row of table.rows.items) {\n        for (let c = 1; c < colCount; c++) {\n          const cell = row.cells.items[c];\n          cell.body.paragraphs.load(\"items\");\n        }\n      }\n      await context.sync();\n\n      // Apply center alignment\n      for (const row of table.rows.items) {\n        for (let c = 1; c < colCount; c++) {\n          const cell = row.cells.items[c];\n          cell.body.paragraphs.items.forEach(p => {\n            p.paragraphFormat.alignment = Word.Alignment.center;\n          });\n        }\n      }\n      await context.sync();\n    }\n\n    */\n\n      await context.sync();\n    });\n  } catch (error) {\n    console.error(\"Error inserting or formatting table:\", error);\n    // Optional: surface error to UI\n    // showNotification(\"Table formatting failed: \" + error.message);\n  }\n}\n\nasync function applyStyleToCellParagraphs(cells, styleName, context) {\n  cells.forEach(cell => cell.load(\"body\"));\n  await context.sync();\n\n  cells.forEach(cell => {\n    const paragraphs = cell.body.paragraphs;\n    paragraphs.load(\"items\");\n  });\n  await context.sync();\n\n  cells.forEach(cell => {\n    cell.body.paragraphs.items.forEach(paragraph => {\n      paragraph.style = styleName;\n    });\n  });\n  await context.sync();\n}\n\n/**\n * Updates all fields in the main body of the document in controlled batches.\n * Adjusts the batch size based on the document's complexity and API limits.\n * todo: may be able to also filter by label such as Table, Figure, so only updates affected\n * versus all SEQ fields\n */\nasync function updateAllFieldsInBatches(fieldType = \"Seq\") {\n  await Word.run(async (context) => {\n    const batchSize = 50;\n    let totalUpdated = 0;\n\n    // Helper to update fields in a given range\n    async function updateFieldsInRange(range, label) {\n      const fields = range.fields;\n      fields.load(\"items, type\");\n      await context.sync();\n\n      const matchingFields = fields.items.filter((field) => field.type === fieldType);\n      if (matchingFields.length > 0) {\n        console.log(`Updating ${matchingFields.length} ${label} fields in batches...`);\n        for (let i = 0; i < matchingFields.length; i += batchSize) {\n          const batchEnd = Math.min(i + batchSize, matchingFields.length);\n          for (let j = i; j < batchEnd; j++) {\n            matchingFields[j].updateResult();\n          }\n          await context.sync();\n        }\n        totalUpdated += matchingFields.length;\n      }\n    }\n\n    // Update fields in the main body\n    await updateFieldsInRange(context.document.body, \"body\");\n\n    // Update fields in all headers across sections\n    const sections = context.document.sections;\n    sections.load(\"items\");\n    await context.sync();\n\n    for (const section of sections.items) {\n      const headers = [\n        section.getHeader(\"Primary\"),\n        section.getHeader(\"FirstPage\"),\n        section.getHeader(\"EvenPages\"),\n      ];\n      for (const header of headers) {\n        await updateFieldsInRange(header, \"header\");\n      }\n    }\n\n    console.log(`Finished updating ${totalUpdated} fields total.`);\n  });\n}\n\n\n\nasync function insertTableCaption(label=\"Table\") {\n\n\n  await Word.run(async (context) => {\n    const range = context.document.getSelection();\n\n    // Get the text before and after the cursor\n    range.load(\"text\");\n    await context.sync();\n\n    // Clear the current selection (like pressing Enter)\n    range.clear();\n\n    // Replace the selection with a paragraph break\n    // !!Important to have text after the \\r or else range won't update to the\n    // new paragraph for some reason.\n    range.insertText(label + \" \", Word.InsertLocation.replace)\n\n    // Move to the newly created paragraph\n    const newParagraph = range.paragraphs.getLast();\n\n    // Move the selection to the new paragraph\n    //newParagraph.select();\n\n    newParagraph.style = \"Caption\"; \n\n    // Get a range just after the inserted text\n    const afterRange = range.getRange(Word.RangeLocation.after);\n\n    // Move the selection to that position\n    afterRange.select();\n\n    await context.sync();\n  });\n\n\n\n  let sectionOoxml = `<pkg:package xmlns:pkg=\"http://schemas.microsoft.com/office/2006/xmlPackage\">\n    <pkg:part pkg:name=\"/_rels/.rels\" pkg:contentType=\"application/vnd.openxmlformats-package.relationships+xml\" pkg:padding=\"512\">\n      <pkg:xmlData>\n        <Relationships xmlns=\"http://schemas.openxmlformats.org/package/2006/relationships\">\n          <Relationship Id=\"rId1\" Type=\"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument\" Target=\"word/document.xml\"/>\n        </Relationships>\n      </pkg:xmlData>\n    </pkg:part>\n\n    <!-- The missing part: Relationships for document.xml -->\n    <pkg:part pkg:name=\"/word/_rels/document.xml.rels\" pkg:contentType=\"application/vnd.openxmlformats-package.relationships+xml\">\n      <pkg:xmlData>\n        <Relationships xmlns=\"http://schemas.openxmlformats.org/package/2006/relationships\">\n          <Relationship Id=\"rId2\" Type=\"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles\" Target=\"styles.xml\"/>\n        </Relationships>\n      </pkg:xmlData>\n    </pkg:part>\n\n\n     <!-- Add the styles definition part -->\n  <pkg:part pkg:name=\"/word/styles.xml\" pkg:contentType=\"application/vnd.openxmlformats-officedocument.wordprocessingml.styles+xml\">\n    <pkg:xmlData>\n      <w:styles xmlns:w=\"http://schemas.openxmlformats.org/wordprocessingml/2006/main\">\n      </w:styles>\n    </pkg:xmlData>\n  </pkg:part>\n\n\n    <pkg:part pkg:name=\"/word/document.xml\" pkg:contentType=\"application/vnd.openxmlformats-officedocument.wordprocessingml.document.main+xml\">\n      <pkg:xmlData>\n\n\n        <w:document xmlns:w=\"http://schemas.openxmlformats.org/wordprocessingml/2006/main\">\n          <w:body>\n\n          <w:p>\n            <!-- important the original markup is \\* but in javascript have to add \\\\* -->\n              <w:fldSimple w:instr=\" SEQ ${label} \\\\* ARABIC \">\n                  <w:r>\n                      <w:rPr>\n                          <w:noProof />\n                      </w:rPr>\n                      <w:t>1</w:t>\n                  </w:r>\n              </w:fldSimple>\n\n              <!-- Separator -->\n              <w:r>\n                <w:t xml:space=\"preserve\"> - </w:t>\n              </w:r>\n          </w:p>\n          \n          </w:body>\n        </w:document>\n\n      </pkg:xmlData>\n    </pkg:part>\n  </pkg:package>`;\n\n\n    await Word.run(async (context) => {\n  \n  try {\n    const selection = context.document.getSelection();\n    let afterRange = selection.getRange(Word.RangeLocation.after);\n    afterRange.insertOoxml(sectionOoxml, Word.InsertLocation.replace);\n\n    // Move the selection to that position\n    afterRange = afterRange.getRange(Word.RangeLocation.after);\n    afterRange.select();\n\n    await context.sync();\n    console.log(\"caption successfully.\");\n  } catch (error) {\n    console.error(\"Failed to set caption:\", error);\n    // Optional fallback: insert API-based break if OOXML fails\n  }\n\n\n/*\n  // hack location to update fields after insert\n    const field = context.document.getSelection().fields.getFirstOrNullObject();\n    field.select(); // This can help trigger the update\n    await context.sync();\n    field.updateResult();\n    await context.sync();\n*/\n  \n    /*\n    const fields = context.document.body.fields;\n    fields.load(\"items\");\n    await context.sync();\n\n    for (let field of fields.items) {\n   //   console.log(field.code); // This is the field instruction\n      field.updateResult();\n    }\n\n    context.sync();\n    */\n\n\n    /*\n    // Insert a new paragraph after the selection\n    const captionParagraph = selection.insertParagraph(\"\", Word.InsertLocation.after);\n\n    // Insert caption label and suffix\n    captionParagraph.insertText(\"Table - \", Word.InsertLocation.start);\n    await context.sync();\n\n   // todo: doens't seem to be an autotext  insertAutoText(\"InsertCaption1\");\n\n   \n    // Apply formatting\n    captionParagraph.style = \"Caption\"; // Must exist in the document\n    captionParagraph.font.bold = false;\n    */\n\n  });\n\n  // todo: bug bug still throws especially when fields have a table of contents\n  // todo: may be able to \n   await updateAllFieldsInBatches(\"Seq\");\n\n}\n\n/*\nTODO: shouldn't add the same <input> tag every time, check for existing and/or add cleanup code.\n*/\nasync function insertImageIntoWord() {\n  const input = document.createElement(\"input\");\n  input.type = \"file\";\n  input.accept = \"image/*\";\n  input.style.display = \"none\";\n\n  input.onchange = function () {\n    const file = input.files[0];\n    if (!file) return;\n\n    const reader = new FileReader();\n    reader.onload = function () {\n      const result = reader.result;\n\n      // Ensure it's a data URL and extract base64\n      const base64 = result.startsWith(\"data:image\")\n        ? result.substring(result.indexOf(\",\") + 1)\n        : null;\n\n      if (!base64) {\n        console.error(\"Invalid image format or reader result.\");\n        return;\n      }\n\n      Word.run(async (context) => {\n        const selection = context.document.getSelection();\n        selection.insertInlinePictureFromBase64(base64, Word.InsertLocation.replace);\n        await context.sync();\n\n        // Style the paragraph at the current selection\n        const paragraph = selection.paragraphs.getFirst();\n        paragraph.load(\"style\");\n        await context.sync();\n\n        // todo: VBA code set the style to \"Picture\" but that style doesn't exist. Not sure why not\n        // causing error.\n        paragraph.style = \"Normal\";\n        await context.sync();\n      });\n    };\n\n    reader.readAsDataURL(file); // Ensures result is a data URL\n  };\n\n  document.body.appendChild(input);\n  input.click();\n}\n\nasync function screenshotFormatGuide() {\n\n   // make a new paragraph where selections paragraph ends\n   await Word.run(async (context) => {\n        const selection = context.document.getSelection();\n\n        // Get the paragraph containing the selection\n        const currentParagraph = selection.paragraphs.getFirst();\n        currentParagraph.load(\"range\");\n        await context.sync();\n\n        // Move cursor to the end of that paragraph\n        const endOfParagraph = currentParagraph.getRange(Word.RangeLocation.end);\n\n        // Insert a new paragraph after it\n        const newParagraph = endOfParagraph.insertParagraph(\"\", Word.InsertLocation.after);\n\n        // Load the range of the new paragraph\n      //  const newRange = newParagraph.getRange();\n       // newRange.select(); // Move the selection to the new paragraph\n\n        // Collapse the range to its end (insertion point only)\n        // this keeps the inserted auto text from being selected when done.\n        const collapsedRange = newParagraph.getRange(Word.RangeLocation.end);\n        collapsedRange.select(); // Moves cursor without selecting content\n\n\n        await context.sync();\n\n        // Type your desired text\n        //newParagraph.insertText(\"Your text goes here.\", Word.InsertLocation.start);\n\n        await context.sync();\n      });\n\n  //    .AttachedTemplate.AutoTextEntries(\"ScreenShotFormat\").Insert Where:=Selection.Range, RichText:=True\n      insertAutoText(\"ScreenShotFormat\");\n\n}\n\n\n\nasync function getOOXML() {\n  await Word.run(async (context) => {\n    const range = context.document.getSelection();\n    const ooxml = range.getOoxml();\n    await context.sync();\n\n    const ooxmlString = ooxml.value;\n    console.log(ooxmlString); // This is your OOXML string\n\n    // Attempt to copy to clipboard\n    try {\n      await navigator.clipboard.writeText(ooxmlString);\n      console.log(\"OOXML copied to clipboard.\");\n    } catch (err) {\n      console.error(\"Failed to copy OOXML to clipboard:\", err);\n    }\n  });\n}\n\nasync function getOOXMLDocument() {\n  await Word.run(async (context) => {\n    const body = context.document.body;\n    const ooxml = body.getOoxml();\n    await context.sync();\n\n    const ooxmlString = ooxml.value;\n    console.log(ooxmlString); // This is your OOXML string\n\n    // Attempt to copy to clipboard\n    try {\n      await navigator.clipboard.writeText(ooxmlString);\n      console.log(\"Document OOXML copied to clipboard.\");\n    } catch (err) {\n      console.error(\"Failed to copy Document OOXML to clipboard:\", err);\n    }\n  });\n}\n\nasync function pasteOOXMLAsDocument() {\n  try {\n    // Read OOXML string from clipboard\n    const ooxmlString = await navigator.clipboard.readText();\n\n    await Word.run(async (context) => {\n      const body = context.document.body;\n      body.insertOoxml(ooxmlString, Word.InsertLocation.replace);\n      await context.sync();\n      console.log(\"Entire document replaced with OOXML from clipboard.\");\n    });\n  } catch (err) {\n    console.error(\"Failed to paste OOXML from clipboard:\", err);\n  }\n}\n\nasync function pasteOOXML() {\n  try {\n    // Read OOXML string from clipboard\n    const ooxmlString = await navigator.clipboard.readText();\n\n    await Word.run(async (context) => {\n      const range = context.document.getSelection();\n      range.insertOoxml(ooxmlString, Word.InsertLocation.after);\n      await context.sync();\n      console.log(\"OOXML pasted from clipboard.\");\n    });\n  } catch (err) {\n    console.error(\"Failed to paste OOXML from clipboard:\", err);\n  }\n}\n\nasync function showAlert(message) {\n   console.log(\"TODO: no alerts implemented\", message);\n   \n}\n\nasync function insertBuildingBlock(context, name, range) {\n  // Simulate AutoText via content control or template logic\n  range.select();\n  await context.sync();\n\n  // TODO: CONSIDER THE RANGE BEING PASSED TO INSERT AUTOTEXT\n  await insertAutoText(name);\n}\n\nfunction isValidBookmarkName(name) {\n  // Must start with a letter and contain only letters, numbers, or underscores\n  return /^[A-Za-z][A-Za-z0-9_]*$/.test(name);\n}\n\nasync function bookmarkExists(bookmarkName ) {\n  if (!isValidBookmarkName(bookmarkName)) {\n    console.warn(`Bookmark name \"${bookmarkName}\" is unsafe for Office.js`);\n    return false;\n  }\n\n  let exists = false;\n\n  try {\n    await Word.run(async (ctx) => {\n      const range = ctx.document.getBookmarkRangeOrNullObject(bookmarkName);\n      range.load();\n      await ctx.sync();\n\n    //  exists = typeof range.text === \"string\";\n      exists = true;\n    });\n  } catch (error) {\n    console.warn(`Bookmark lookup failed for \"${bookmarkName}\":`, error);\n    exists = false;\n  }\n\n  return exists;\n}\n\n/* todo bug bug this doesn't work. and break downstream rich api calls.\n*/\nasync function insertSectionBreakAtSelection(context, type = \"nextPage\") {\n  const selection = context.document.getSelection();\n  await context.sync();\n\n  // todo: there is an InsertBreak support for sections, should be able to use.\n//  selection.insertBreak(Word.BreakType.sectionNext, Word.InsertLocation.after);\n // await context.sync();\n\n\n \n\n// <w:type w:val=\"continuous\"/>\n// TODO: NEEDS TO BE TESTED,  SEEMS TO WORK FOR INSERTING SECTION BUT \n// didn't seem to pick up properties.\n\nlet sectionOoxml = `<pkg:package xmlns:pkg=\"http://schemas.microsoft.com/office/2006/xmlPackage\">\n  <pkg:part pkg:name=\"/_rels/.rels\" pkg:contentType=\"application/vnd.openxmlformats-package.relationships+xml\" pkg:padding=\"512\">\n    <pkg:xmlData>\n      <Relationships xmlns=\"http://schemas.openxmlformats.org/package/2006/relationships\">\n        <Relationship Id=\"rId1\" Type=\"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument\" Target=\"word/document.xml\"/>\n      </Relationships>\n    </pkg:xmlData>\n  </pkg:part>\n  <pkg:part pkg:name=\"/word/document.xml\" pkg:contentType=\"application/vnd.openxmlformats-officedocument.wordprocessingml.document.main+xml\">\n    <pkg:xmlData>\n      <w:document xmlns:w=\"http://schemas.openxmlformats.org/wordprocessingml/2006/main\" >\n        <w:body>\n          <w:p>\n            <w:pPr>\n              <w:sectPr>\n                <w:type w:val=\"nextPage\"/>\n              </w:sectPr>\n            </w:pPr>\n          </w:p>\n        </w:body>\n      </w:document>\n    </pkg:xmlData>\n  </pkg:part>\n</pkg:package>`;\n\n \n\n  try {\n    selection.insertOoxml(sectionOoxml, Word.InsertLocation.after);\n    await context.sync();\n    console.log(\"Section break inserted successfully.\");\n  } catch (error) {\n    console.error(\"Failed to insert section break:\", error);\n    // Optional fallback: insert API-based break if OOXML fails\n  }\n\n\n// doc part body test with image\n// !!! overwrites the image if already one at path but also need to provide so need to figure out\n//   best way to handle. Fine as long as user is working on same template OOXML is generated from.\nsectionOoxml = `<pkg:package xmlns:pkg=\"http://schemas.microsoft.com/office/2006/xmlPackage\">\n  <pkg:part pkg:name=\"/_rels/.rels\" pkg:contentType=\"application/vnd.openxmlformats-package.relationships+xml\" pkg:padding=\"512\">\n    <pkg:xmlData>\n      <Relationships xmlns=\"http://schemas.openxmlformats.org/package/2006/relationships\">\n        <Relationship Id=\"rId1\" Type=\"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument\" Target=\"word/document.xml\"/>\n      </Relationships>\n    </pkg:xmlData>\n  </pkg:part>\n  <pkg:part pkg:name=\"/word/_rels/document.xml.rels\"\n          pkg:contentType=\"application/vnd.openxmlformats-package.relationships+xml\">\n    <pkg:xmlData>\n      <Relationships xmlns=\"http://schemas.openxmlformats.org/package/2006/relationships\">\n        <Relationship Id=\"rId5\"\n                      Type=\"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image\"\n                      Target=\"media/image1.png\"/>\n      </Relationships>\n    </pkg:xmlData>\n  </pkg:part>\n\n  <pkg:part pkg:name=\"/word/media/image1.png\"\n            pkg:contentType=\"image/png\"\n            pkg:compression=\"store\">\n    <pkg:binaryData>\n      iVBORw0KGgoAAAANSUhEUgAAAAoAAAAKCAIAAAACUFjqAAAAFElEQVR42mP8z8AARAwMDPz//x8AAgMBAf0FhVgAAAAASUVORK5CYII=\n    </pkg:binaryData>\n  </pkg:part>\n\n  <pkg:part pkg:name=\"/word/document.xml\" pkg:contentType=\"application/vnd.openxmlformats-officedocument.wordprocessingml.document.main+xml\">\n    <pkg:xmlData>\n      <w:document xmlns:wpc=\"http://schemas.microsoft.com/office/word/2010/wordprocessingCanvas\"\n                    xmlns:cx=\"http://schemas.microsoft.com/office/drawing/2014/chartex\"\n                    xmlns:cx1=\"http://schemas.microsoft.com/office/drawing/2015/9/8/chartex\"\n                    xmlns:cx2=\"http://schemas.microsoft.com/office/drawing/2015/10/21/chartex\"\n                    xmlns:cx3=\"http://schemas.microsoft.com/office/drawing/2016/5/9/chartex\"\n                    xmlns:cx4=\"http://schemas.microsoft.com/office/drawing/2016/5/10/chartex\"\n                    xmlns:cx5=\"http://schemas.microsoft.com/office/drawing/2016/5/11/chartex\"\n                    xmlns:cx6=\"http://schemas.microsoft.com/office/drawing/2016/5/12/chartex\"\n                    xmlns:cx7=\"http://schemas.microsoft.com/office/drawing/2016/5/13/chartex\"\n                    xmlns:cx8=\"http://schemas.microsoft.com/office/drawing/2016/5/14/chartex\"\n                    xmlns:mc=\"http://schemas.openxmlformats.org/markup-compatibility/2006\"\n                    xmlns:aink=\"http://schemas.microsoft.com/office/drawing/2016/ink\"\n                    xmlns:am3d=\"http://schemas.microsoft.com/office/drawing/2017/model3d\"\n                    xmlns:o=\"urn:schemas-microsoft-com:office:office\"\n                    xmlns:oel=\"http://schemas.microsoft.com/office/2019/extlst\"\n                    xmlns:r=\"http://schemas.openxmlformats.org/officeDocument/2006/relationships\"\n                    xmlns:m=\"http://schemas.openxmlformats.org/officeDocument/2006/math\"\n                    xmlns:v=\"urn:schemas-microsoft-com:vml\"\n                    xmlns:wp14=\"http://schemas.microsoft.com/office/word/2010/wordprocessingDrawing\"\n                    xmlns:wp=\"http://schemas.openxmlformats.org/drawingml/2006/wordprocessingDrawing\"\n                    xmlns:w10=\"urn:schemas-microsoft-com:office:word\"\n                    xmlns:w=\"http://schemas.openxmlformats.org/wordprocessingml/2006/main\"\n                    xmlns:w14=\"http://schemas.microsoft.com/office/word/2010/wordml\"\n                    xmlns:w15=\"http://schemas.microsoft.com/office/word/2012/wordml\"\n                    xmlns:w16cex=\"http://schemas.microsoft.com/office/word/2018/wordml/cex\"\n                    xmlns:w16cid=\"http://schemas.microsoft.com/office/word/2016/wordml/cid\"\n                    xmlns:w16=\"http://schemas.microsoft.com/office/word/2018/wordml\"\n                    xmlns:w16du=\"http://schemas.microsoft.com/office/word/2023/wordml/word16du\"\n                    xmlns:w16sdtdh=\"http://schemas.microsoft.com/office/word/2020/wordml/sdtdatahash\"\n                    xmlns:w16sdtfl=\"http://schemas.microsoft.com/office/word/2024/wordml/sdtformatlock\"\n                    xmlns:w16se=\"http://schemas.microsoft.com/office/word/2015/wordml/symex\"\n                    xmlns:wpg=\"http://schemas.microsoft.com/office/word/2010/wordprocessingGroup\"\n                    xmlns:wpi=\"http://schemas.microsoft.com/office/word/2010/wordprocessingInk\"\n                    xmlns:wne=\"http://schemas.microsoft.com/office/word/2006/wordml\"\n                    xmlns:wps=\"http://schemas.microsoft.com/office/word/2010/wordprocessingShape\"\n                    mc:Ignorable=\"w14 w15 w16se w16cid w16 w16cex w16sdtdh w16sdtfl w16du wp14\">\n        <w:body>\n              <w:p w:rsidR=\"00E93316\"\n                     w:rsidRDefault=\"003503CB\"\n                     w:rsidP=\"003503CB\">\n                    <w:r>\n                        <w:drawing>\n                            <wp:inline distT=\"0\"\n                                       distB=\"0\"\n                                       distL=\"0\"\n                                       distR=\"0\"\n                                       wp14:anchorId=\"2A7721B7\"\n                                       wp14:editId=\"375537C8\" xmlns:wp=\"http://schemas.openxmlformats.org/drawingml/2006/wordprocessingDrawing\" xmlns:wp14=\"http://schemas.microsoft.com/office/word/2010/wordprocessingDrawing\">\n                                <wp:extent cx=\"1238423\"\n                                           cy=\"447737\" />\n                                <wp:effectExtent l=\"0\"\n                                                 t=\"0\"\n                                                 r=\"0\"\n                                                 b=\"0\" />\n                                <wp:docPr id=\"7\"\n                                          name=\"Picture 1\" />\n                                <wp:cNvGraphicFramePr>\n                                    <a:graphicFrameLocks xmlns:a=\"http://schemas.openxmlformats.org/drawingml/2006/main\"\n                                                         noChangeAspect=\"1\" />\n                                </wp:cNvGraphicFramePr>\n                                <a:graphic xmlns:a=\"http://schemas.openxmlformats.org/drawingml/2006/main\">\n                                    <a:graphicData uri=\"http://schemas.openxmlformats.org/drawingml/2006/picture\">\n                                        <pic:pic xmlns:pic=\"http://schemas.openxmlformats.org/drawingml/2006/picture\">\n                                            <pic:nvPicPr>\n                                                <pic:cNvPr id=\"7\"\n                                                           name=\"logo.png\" />\n                                                <pic:cNvPicPr />\n                                            </pic:nvPicPr>\n                                            <pic:blipFill>\n                                                <a:blip r:embed=\"rId5\" />\n                                                <a:stretch>\n                                                    <a:fillRect />\n                                                </a:stretch>\n                                            </pic:blipFill>\n                                            <pic:spPr>\n                                                <a:xfrm>\n                                                    <a:off x=\"0\"\n                                                           y=\"0\" />\n                                                    <a:ext cx=\"1238423\"\n                                                           cy=\"447737\" />\n                                                </a:xfrm>\n                                                <a:prstGeom prst=\"rect\">\n                                                    <a:avLst />\n                                                </a:prstGeom>\n                                            </pic:spPr>\n                                        </pic:pic>\n                                    </a:graphicData>\n                                </a:graphic>\n                            </wp:inline>\n                        </w:drawing>\n                    </w:r>\n                </w:p>\n        </w:body>\n      </w:document>\n    </pkg:xmlData>\n  </pkg:part>\n</pkg:package>`\n\n\n// end doc part body test\n/*\n\n  try {\n    selection.insertOoxml(sectionOoxml, Word.InsertLocation.after);\n    await context.sync();\n    console.log(\"Section break inserted successfully.\");\n  } catch (error) {\n    console.error(\"Failed to insert section break:\", error);\n    // Optional fallback: insert API-based break if OOXML fails\n  }\n    */\n\n  // todo: tried inserting a document fragment but it always failed. \n}\n\n\nfunction insertPageBreakAtSelection() {\n  Word.run(async (context) => {\n    const range = context.document.getSelection();\n    range.insertBreak(Word.BreakType.page, Word.InsertLocation.after);\n    await context.sync();\n  }).catch((error) => {\n    console.error(\"Failed to insert page break:\", error);\n  });\n}\n\n// test so can know if wrote values correctly\nasync function readCoverProperties() {\n  await Word.run(async (context) => {\n    const props = context.document.properties.customProperties;\n\n    // Load the collection so we can query safely\n    props.load(\"items\");\n    await context.sync();\n\n    const keys = [\n      \"CoverHeading\",\n      \"CoverHeading2\",\n      \"CoverHeading3\",\n      \"CoverDate\"\n    ];\n\n    for (const key of keys) {\n      const prop = props.getItemOrNullObject(key);\n      prop.load(\"value\");\n      await context.sync();\n\n      if (prop.isNullObject) {\n        console.log(`Property \"${key}\" not found.`);\n      } else {\n        console.log(`Property \"${key}\" = \"${prop.value}\"`);\n      }\n    }\n  }).catch((error) => {\n    console.error(\"Failed to read custom properties:\", error);\n  });\n}\n\nasync function updateTOC() {\n\n  await Word.run(async (context) => {\n    // todo: review, original VBA seemed to have more logic\n    await updateAllFieldsInBatches(\"TOC\");\n  }).catch((error) => {\n    console.error(\"TOC update failed:\", error);\n  });\n}\n\nasync function insertFigureCaption() {\n  await insertTableCaption(\"Figure\")\n}\n\n// todo: this doesn't really seem to work very well. may work if \nasync function getCurrentSection(context) {\n  const selection = context.document.getSelection();\n  const sections = context.document.sections;\n  sections.load(\"items\");\n  await context.sync();\n\n  for (let section of sections.items) {\n    const range = section.body.getRange(\"Whole\");\n    await context.sync();\n\n    const startsAfter = selection.compareLocationWith(range, Word.LocationRelation.after);\n    const endsBefore = selection.compareLocationWith(range, Word.LocationRelation.before);\n    await context.sync();\n\n    if (!startsAfter && !endsBefore) {\n      return section;\n    }\n  }\n\n  throw new Error(\"Current section not found.\");\n}\n\nasync function getSectionIndexFromSelection() {\n  return await Word.run(async (context) => {\n    const selection = context.document.getSelection();\n    const selectionRange = selection.getRange();\n    selectionRange.load(\"text\");\n\n    const sections = context.document.sections;\n    sections.load(\"items\");\n\n    await context.sync();\n\n    for (let i = 0; i < sections.items.length; i++) {\n      const sectionBodyRange = sections.items[i].body.getRange();\n      sectionBodyRange.load(\"text\");\n\n      await context.sync();\n\n      const location = selectionRange.compareLocationWith(sectionBodyRange);\n\n      await context.sync();\n\n      if (location.value ===  Word.LocationRelation.inside || location.value === Word.LocationRelation.equal) {\n        console.log(`Selection is in section ${i}`);\n        return i;\n      }\n    }\n\n    console.log(\"Selection not found in any section.\");\n    return -1;\n  });\n}\n\nasync function a4Orientation() {\n\n  // todo: make sure this hands selections across section boundaries logically.\n  let sectionIndex = await getSectionIndexFromSelection();\n  console.log(sectionIndex);\n  \n  if (sectionIndex < 0) {\n    console.log(\"selection is not within a section. todo: show alert\");\n    return;\n  }\n\n  // todo: bug bug need a way to see if all these are set and need to restore each one\n  // todo: could also include headers as part of big insert ooxml and why the\n  // first header and other settings aren't also reset and how to check if \n  // need to set.\n  let headerOoxml = null;\n  let footerOoxml = null;\n\n  let firstPageheaderOoxml = null;\n  let firstPagefooterOoxml= null;\n\n\n  await Word.run(async (context) => {\n    // Get the sections collection of the document.\n    const sections = context.document.sections;\n\n    // Load the items from the sections collection.\n    sections.load('items');\n    await context.sync();\n\n    // Get the current sections header and footer \n    const secondSection = sections.items[sectionIndex];\n\n    // Get the primary header and footer bodies for the second section.\n    const primaryHeader = secondSection.getHeader(Word.HeaderFooterType.primary);\n    const primaryFooter = secondSection.getFooter(Word.HeaderFooterType.primary);\n\n    // Get the OOXML representation of the header and footer bodies.\n    let zheaderOoxml = primaryHeader.getOoxml();\n    let zfooterOoxml = primaryFooter.getOoxml();\n\n    // Sync the document state to get the OOXML values.\n    await context.sync();\n\n    headerOoxml = zheaderOoxml.value;\n    footerOoxml = zfooterOoxml.value;\n\n    // TODO: BUG BUG, SHOW ALSO GET THE oddPages so cover all potential header cases.\n\n     // Get the FIRST header and footer bodies for the second section.\n    const firstHeader = secondSection.getHeader(Word.HeaderFooterType.firstPage);\n    const firstFooter = secondSection.getFooter(Word.HeaderFooterType.firstPage);\n\n    // Get the OOXML representation of the header and footer bodies.\n    let zheaderOoxml2 = firstHeader.getOoxml();\n    let zfooterOoxml2 = firstFooter.getOoxml();\n\n    // Sync the document state to get the OOXML values.\n    await context.sync();\n\n\n    firstPageheaderOoxml = zheaderOoxml2.value;\n    firstPagefooterOoxml = zfooterOoxml2.value;\n\n    /*\n    // Log the OOXML values to the console.\n    console.log('Primary Header OOXML for the second section:');\n    console.log(headerOoxml.value);\n    console.log('Primary Footer OOXML for the second section:');\n    console.log(footerOoxml.value);\n    */\n\n    /*\n    // now flip the content\n     const firstSection = sections.items[0];\n\n    const FprimaryHeader = firstSection.getHeader(Word.HeaderFooterType.primary);\n    const FprimaryFooter = firstSection.getFooter(Word.HeaderFooterType.primary);\n\n    FprimaryHeader.insertOoxml(headerOoxml.value, Word.InsertLocation.replace);\n    FprimaryFooter.insertOoxml(footerOoxml.value, Word.InsertLocation.replace);\n\n    await context.sync();\n    */\n  \n  }).catch((error) => {\n    console.error('An error occurred:', error);\n  });\n\n\n\n  //console.log(\"TODO: A4 rotate not yet implemented\");\n  // return;\n\nlet sectionOoxml = `<pkg:package xmlns:pkg=\"http://schemas.microsoft.com/office/2006/xmlPackage\">\n    <pkg:part pkg:name=\"/_rels/.rels\"\n              pkg:contentType=\"application/vnd.openxmlformats-package.relationships+xml\"\n              pkg:padding=\"512\">\n        <pkg:xmlData>\n            <Relationships xmlns=\"http://schemas.openxmlformats.org/package/2006/relationships\">\n                <Relationship Id=\"rId1\"\n                              Type=\"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument\"\n                              Target=\"word/document.xml\" />\n            </Relationships>\n        </pkg:xmlData>\n    </pkg:part>\n    <pkg:part pkg:name=\"/word/_rels/document.xml.rels\"\n              pkg:contentType=\"application/vnd.openxmlformats-package.relationships+xml\">\n        <pkg:xmlData>\n            <Relationships xmlns=\"http://schemas.openxmlformats.org/package/2006/relationships\">\n\n                <Relationship Id=\"rId7\"\n                              Type=\"http://schemas.openxmlformats.org/officeDocument/2006/relationships/footer\"\n                              Target=\"footer1.xml\" />\n                <Relationship Id=\"rId6\"\n                              Type=\"http://schemas.openxmlformats.org/officeDocument/2006/relationships/header\"\n                              Target=\"header1.xml\" />\n\n                <Relationship Id=\"rHeader10\"\n                              Type=\"http://schemas.openxmlformats.org/officeDocument/2006/relationships/header\"\n                              Target=\"header10.xml\" />\n                <Relationship Id=\"rFooter10\"\n                              Type=\"http://schemas.openxmlformats.org/officeDocument/2006/relationships/footer\"\n                              Target=\"footer10.xml\" />\n                <Relationship Id=\"rHeader20\"\n                              Type=\"http://schemas.openxmlformats.org/officeDocument/2006/relationships/header\"\n                              Target=\"header20.xml\" />\n                <Relationship Id=\"rFooter20\"\n                              Type=\"http://schemas.openxmlformats.org/officeDocument/2006/relationships/footer\"\n                              Target=\"footer20.xml\" />\n            </Relationships>\n        </pkg:xmlData>\n    </pkg:part>\n\n        <pkg:part pkg:name=\"/word/header1.xml\"\n              pkg:contentType=\"application/vnd.openxmlformats-officedocument.wordprocessingml.header+xml\">\n        <pkg:xmlData>\n            <w:hdr xmlns:wpc=\"http://schemas.microsoft.com/office/word/2010/wordprocessingCanvas\"\n                   xmlns:cx=\"http://schemas.microsoft.com/office/drawing/2014/chartex\"\n                   xmlns:cx1=\"http://schemas.microsoft.com/office/drawing/2015/9/8/chartex\"\n                   xmlns:cx2=\"http://schemas.microsoft.com/office/drawing/2015/10/21/chartex\"\n                   xmlns:cx3=\"http://schemas.microsoft.com/office/drawing/2016/5/9/chartex\"\n                   xmlns:cx4=\"http://schemas.microsoft.com/office/drawing/2016/5/10/chartex\"\n                   xmlns:cx5=\"http://schemas.microsoft.com/office/drawing/2016/5/11/chartex\"\n                   xmlns:cx6=\"http://schemas.microsoft.com/office/drawing/2016/5/12/chartex\"\n                   xmlns:cx7=\"http://schemas.microsoft.com/office/drawing/2016/5/13/chartex\"\n                   xmlns:cx8=\"http://schemas.microsoft.com/office/drawing/2016/5/14/chartex\"\n                   xmlns:mc=\"http://schemas.openxmlformats.org/markup-compatibility/2006\"\n                   xmlns:aink=\"http://schemas.microsoft.com/office/drawing/2016/ink\"\n                   xmlns:am3d=\"http://schemas.microsoft.com/office/drawing/2017/model3d\"\n                   xmlns:o=\"urn:schemas-microsoft-com:office:office\"\n                   xmlns:oel=\"http://schemas.microsoft.com/office/2019/extlst\"\n                   xmlns:r=\"http://schemas.openxmlformats.org/officeDocument/2006/relationships\"\n                   xmlns:m=\"http://schemas.openxmlformats.org/officeDocument/2006/math\"\n                   xmlns:v=\"urn:schemas-microsoft-com:vml\"\n                   xmlns:wp14=\"http://schemas.microsoft.com/office/word/2010/wordprocessingDrawing\"\n                   xmlns:wp=\"http://schemas.openxmlformats.org/drawingml/2006/wordprocessingDrawing\"\n                   xmlns:w10=\"urn:schemas-microsoft-com:office:word\"\n                   xmlns:w=\"http://schemas.openxmlformats.org/wordprocessingml/2006/main\"\n                   xmlns:w14=\"http://schemas.microsoft.com/office/word/2010/wordml\"\n                   xmlns:w15=\"http://schemas.microsoft.com/office/word/2012/wordml\"\n                   xmlns:w16cex=\"http://schemas.microsoft.com/office/word/2018/wordml/cex\"\n                   xmlns:w16cid=\"http://schemas.microsoft.com/office/word/2016/wordml/cid\"\n                   xmlns:w16=\"http://schemas.microsoft.com/office/word/2018/wordml\"\n                   xmlns:w16du=\"http://schemas.microsoft.com/office/word/2023/wordml/word16du\"\n                   xmlns:w16sdtdh=\"http://schemas.microsoft.com/office/word/2020/wordml/sdtdatahash\"\n                   xmlns:w16sdtfl=\"http://schemas.microsoft.com/office/word/2024/wordml/sdtformatlock\"\n                   xmlns:w16se=\"http://schemas.microsoft.com/office/word/2015/wordml/symex\"\n                   xmlns:wpg=\"http://schemas.microsoft.com/office/word/2010/wordprocessingGroup\"\n                   xmlns:wpi=\"http://schemas.microsoft.com/office/word/2010/wordprocessingInk\"\n                   xmlns:wne=\"http://schemas.microsoft.com/office/word/2006/wordml\"\n                   xmlns:wps=\"http://schemas.microsoft.com/office/word/2010/wordprocessingShape\"\n                   mc:Ignorable=\"w14 w15 w16se w16cid w16 w16cex w16sdtdh w16sdtfl w16du wp14\">\n            </w:hdr>\n        </pkg:xmlData>\n    </pkg:part>\n\n       <pkg:part pkg:name=\"/word/footer1.xml\"\n              pkg:contentType=\"application/vnd.openxmlformats-officedocument.wordprocessingml.footer+xml\">\n        <pkg:xmlData>\n            <w:ftr xmlns:wpc=\"http://schemas.microsoft.com/office/word/2010/wordprocessingCanvas\"\n                   xmlns:cx=\"http://schemas.microsoft.com/office/drawing/2014/chartex\"\n                   xmlns:cx1=\"http://schemas.microsoft.com/office/drawing/2015/9/8/chartex\"\n                   xmlns:cx2=\"http://schemas.microsoft.com/office/drawing/2015/10/21/chartex\"\n                   xmlns:cx3=\"http://schemas.microsoft.com/office/drawing/2016/5/9/chartex\"\n                   xmlns:cx4=\"http://schemas.microsoft.com/office/drawing/2016/5/10/chartex\"\n                   xmlns:cx5=\"http://schemas.microsoft.com/office/drawing/2016/5/11/chartex\"\n                   xmlns:cx6=\"http://schemas.microsoft.com/office/drawing/2016/5/12/chartex\"\n                   xmlns:cx7=\"http://schemas.microsoft.com/office/drawing/2016/5/13/chartex\"\n                   xmlns:cx8=\"http://schemas.microsoft.com/office/drawing/2016/5/14/chartex\"\n                   xmlns:mc=\"http://schemas.openxmlformats.org/markup-compatibility/2006\"\n                   xmlns:aink=\"http://schemas.microsoft.com/office/drawing/2016/ink\"\n                   xmlns:am3d=\"http://schemas.microsoft.com/office/drawing/2017/model3d\"\n                   xmlns:o=\"urn:schemas-microsoft-com:office:office\"\n                   xmlns:oel=\"http://schemas.microsoft.com/office/2019/extlst\"\n                   xmlns:r=\"http://schemas.openxmlformats.org/officeDocument/2006/relationships\"\n                   xmlns:m=\"http://schemas.openxmlformats.org/officeDocument/2006/math\"\n                   xmlns:v=\"urn:schemas-microsoft-com:vml\"\n                   xmlns:wp14=\"http://schemas.microsoft.com/office/word/2010/wordprocessingDrawing\"\n                   xmlns:wp=\"http://schemas.openxmlformats.org/drawingml/2006/wordprocessingDrawing\"\n                   xmlns:w10=\"urn:schemas-microsoft-com:office:word\"\n                   xmlns:w=\"http://schemas.openxmlformats.org/wordprocessingml/2006/main\"\n                   xmlns:w14=\"http://schemas.microsoft.com/office/word/2010/wordml\"\n                   xmlns:w15=\"http://schemas.microsoft.com/office/word/2012/wordml\"\n                   xmlns:w16cex=\"http://schemas.microsoft.com/office/word/2018/wordml/cex\"\n                   xmlns:w16cid=\"http://schemas.microsoft.com/office/word/2016/wordml/cid\"\n                   xmlns:w16=\"http://schemas.microsoft.com/office/word/2018/wordml\"\n                   xmlns:w16du=\"http://schemas.microsoft.com/office/word/2023/wordml/word16du\"\n                   xmlns:w16sdtdh=\"http://schemas.microsoft.com/office/word/2020/wordml/sdtdatahash\"\n                   xmlns:w16sdtfl=\"http://schemas.microsoft.com/office/word/2024/wordml/sdtformatlock\"\n                   xmlns:w16se=\"http://schemas.microsoft.com/office/word/2015/wordml/symex\"\n                   xmlns:wpg=\"http://schemas.microsoft.com/office/word/2010/wordprocessingGroup\"\n                   xmlns:wpi=\"http://schemas.microsoft.com/office/word/2010/wordprocessingInk\"\n                   xmlns:wne=\"http://schemas.microsoft.com/office/word/2006/wordml\"\n                   xmlns:wps=\"http://schemas.microsoft.com/office/word/2010/wordprocessingShape\"\n                   mc:Ignorable=\"w14 w15 w16se w16cid w16 w16cex w16sdtdh w16sdtfl w16du wp14\">\n            </w:ftr>\n        </pkg:xmlData>\n    </pkg:part>\n    \n    <!-- Header part with linkToPrevious set to false -->\n    <pkg:part pkg:name=\"/word/header10.xml\"\n              pkg:contentType=\"application/vnd.openxmlformats-officedocument.wordprocessingml.header+xml\">\n        <pkg:xmlData>\n            <w:hdr xmlns:w=\"http://schemas.openxmlformats.org/wordprocessingml/2006/main\">\n                <w:linkToPrevious w:val=\"false\" />\n            </w:hdr>\n        </pkg:xmlData>\n    </pkg:part>\n    <!-- Footer part with linkToPrevious set to false -->\n    <pkg:part pkg:name=\"/word/footer10.xml\"\n              pkg:contentType=\"application/vnd.openxmlformats-officedocument.wordprocessingml.footer+xml\">\n        <pkg:xmlData>\n            <w:ftr xmlns:w=\"http://schemas.openxmlformats.org/wordprocessingml/2006/main\">\n                <w:linkToPrevious w:val=\"false\" />\n            </w:ftr>\n        </pkg:xmlData>\n    </pkg:part>\n    <!-- Header part with linkToPrevious set to false -->\n    <pkg:part pkg:name=\"/word/header20.xml\"\n              pkg:contentType=\"application/vnd.openxmlformats-officedocument.wordprocessingml.header+xml\">\n        <pkg:xmlData>\n            <w:hdr xmlns:w=\"http://schemas.openxmlformats.org/wordprocessingml/2006/main\">\n                <w:linkToPrevious w:val=\"false\" />\n            </w:hdr>\n        </pkg:xmlData>\n    </pkg:part>\n    <!-- Footer part with linkToPrevious set to false -->\n    <pkg:part pkg:name=\"/word/footer20.xml\"\n              pkg:contentType=\"application/vnd.openxmlformats-officedocument.wordprocessingml.footer+xml\">\n        <pkg:xmlData>\n            <w:ftr xmlns:w=\"http://schemas.openxmlformats.org/wordprocessingml/2006/main\">\n                <w:linkToPrevious w:val=\"false\" />\n            </w:ftr>\n        </pkg:xmlData>\n    </pkg:part>\n    <pkg:part pkg:name=\"/word/document.xml\"\n              pkg:contentType=\"application/vnd.openxmlformats-officedocument.wordprocessingml.document.main+xml\">\n        <pkg:xmlData>\n            <w:document xmlns:w=\"http://schemas.openxmlformats.org/wordprocessingml/2006/main\"\n                        xmlns:r=\"http://schemas.openxmlformats.org/officeDocument/2006/relationships\">\n                <w:body>\n\t\t\t\t\t<!-- drop in a section to preserve current formatting. -->\n                    <w:p></w:p>\n                    <w:p>\n                        <w:pPr>\n                            <w:sectPr w:rsidR=\"00000000\"\n                                    w:rsidSect=\"00293608\">\n                                <w:headerReference w:type=\"default\"\n                                                r:id=\"rId6\" />\n                                <w:footerReference w:type=\"default\"\n                                                r:id=\"rId7\" />\n                                <w:pgSz w:w=\"12240\"\n                                        w:h=\"15840\" />\n                                <w:pgMar w:top=\"1440\"\n                                        w:right=\"1440\"\n                                        w:bottom=\"1440\"\n                                        w:left=\"1440\"\n                                        w:header=\"720\"\n                                        w:footer=\"720\"\n                                        w:gutter=\"0\" />\n                                <w:cols w:space=\"720\" />\n                                <w:docGrid w:linePitch=\"360\" />\n                            </w:sectPr>\n                        </w:pPr>\n                    </w:p>\n                    <w:p></w:p>\n                    <w:p></w:p>\n                    <w:p w:rsidR=\"00895336\"\n                         w:rsidRDefault=\"00895336\">\n                        <w:pPr>\n                            <w:sectPr w:rsidR=\"00895336\"\n                                      w:rsidSect=\"00895336\">\n                                <w:pgSz w:w=\"16838\"\n                                        w:h=\"11906\"\n                                        w:orient=\"landscape\" />\n                                <w:headerReference w:type=\"default\"\n                                                   r:id=\"rHeader20\" />\n                                <w:footerReference w:type=\"default\"\n                                                   r:id=\"rFooter20\" />\n                            </w:sectPr>\n                        </w:pPr>\n                    </w:p>\n                    <w:sectPr >\n                    </w:sectPr>\n                </w:body>\n            </w:document>\n        </pkg:xmlData>\n    </pkg:part>\n</pkg:package>`;\n\n \n\n  await Word.run(async (context) => {\n  try {\n\n    let selection = context.document.getSelection();\n    /*\n    \n\n    // Theory is if i insert a break above then word will do the proper copy/paste of the \n    // header so if first break in document the header/footer will copy correctly.\n    selection.insertBreak(Word.BreakType.sectionNext, Word.InsertLocation.after);\n    await context.sync();\n\n\n      // Move to the new location after the break\n    selection = selection.getRange(Word.RangeLocation.after);\n    selection.insertText(\"selection location after insert\", Word.InsertLocation.start);\n    await context.sync();\n     */\n\n    selection.insertOoxml(sectionOoxml, Word.InsertLocation.after);\n    await context.sync();\n\n    console.log(\"Section break inserted successfully.\");\n\n  \n\n  } catch (error) {\n    console.error(\"Failed to insert section break:\", error);\n    // Optional fallback: insert API-based break if OOXML fails\n  }\n    });\n\n\n    // okay now restore the headers and footers\n    // making some assumptions that the sections are sequential now in the collction.\n\n\n  await Word.run(async (context) => {\n      // Get the sections collection of the document.\n      // Get the sections collection of the document.\n      const sections = context.document.sections;\n\n      // Load the items from the sections collection.\n      sections.load('items');\n      await context.sync();\n\n      // restore original header footer on section which was removed by the unlink \n      let firstSection = sections.items[sectionIndex];\n\n      let FprimaryHeader = firstSection.getHeader(Word.HeaderFooterType.primary);\n      let FprimaryFooter = firstSection.getFooter(Word.HeaderFooterType.primary);\n\n      FprimaryHeader.insertOoxml(headerOoxml, Word.InsertLocation.replace);\n      FprimaryFooter.insertOoxml(footerOoxml, Word.InsertLocation.replace);\n\n\n      await context.sync();\n\n      // set the first page header  firstPageheaderOoxml = zheaderOoxml.value; firstPagefooterOoxml = zfooterOoxml.value;\n      FprimaryHeader = firstSection.getHeader(Word.HeaderFooterType.firstPage);\n      FprimaryFooter = firstSection.getFooter(Word.HeaderFooterType.firstPage);\n\n      FprimaryHeader.insertOoxml(firstPageheaderOoxml, Word.InsertLocation.replace);\n      FprimaryFooter.insertOoxml(firstPagefooterOoxml, Word.InsertLocation.replace);\n\n\n      await context.sync();\n\n      // hack, set first page header on next section in case first of document\n      // that has the different first page we don't have a way to currently reset it.\n      // todo: some new word api looks like may be way to turn off.\n      firstSection = sections.items[sectionIndex + 2];\n\n      FprimaryHeader = firstSection.getHeader(Word.HeaderFooterType.firstPage);\n      FprimaryFooter = firstSection.getFooter(Word.HeaderFooterType.firstPage);\n\n      FprimaryHeader.insertOoxml(headerOoxml, Word.InsertLocation.replace);\n      FprimaryFooter.insertOoxml(footerOoxml, Word.InsertLocation.replace);\n\n      await context.sync();\n\n\n    }).catch((error) => {\n      console.error('An error occurred:', error);\n    });\n\n    // Todo: the example template VBA seems to always insert a single header regardless\n    // of the template choice with autotext Header_Landscape\n\n  let landscapeHeaderOOXML = await getAutoTextOOXML(\"Header_Landscape\");\n  await Word.run(async (context) => {\n      // Get the sections collection of the document.\n      // Get the sections collection of the document.\n      const sections = context.document.sections;\n\n      // Load the items from the sections collection.\n      sections.load('items');\n      await context.sync();\n\n      \n      // now lets setup the wide orientation.\n      // TODO: CODE ASSUMES that this method run when page in portrait.\n      let newSection = sections.items[sectionIndex + 1];\n\n      let primaryHeader = newSection.getHeader(Word.HeaderFooterType.primary);\n      let primaryFooter = newSection.getFooter(Word.HeaderFooterType.primary);\n\n      primaryHeader.insertOoxml(landscapeHeaderOOXML, Word.InsertLocation.replace);\n\n      // footer use the same ooxml\n      primaryFooter.insertOoxml(footerOoxml, Word.InsertLocation.replace);\n\n      await context.sync();\n    }).catch((error) => {\n      console.error('An error occurred:', error);\n    });\n  \n\n    // update fields that may be in the header or need to update for the new page insert.\n    await updateAllFieldsInBatches(\"DocProperty\");\n    \n    // todo: this works but should probably mimic not updating same as insert manually\n    // also could  be slow for large documents just to get out of sync again from editing.\n    // await updateTOC();\n\n\n}\n\n\n\n\nasync function getCustomPropertiesAsJson(propertyNames) {\n    return Word.run(async (context) => {\n        const props = context.document.properties.customProperties;\n        props.load(\"items\");\n        await context.sync();\n\n        const result = {};\n        for (const name of propertyNames) {\n            const match = props.items.find(p => p.key === name);\n            result[name] = match ? match.value : null;\n        }\n\n        return result;\n    });\n}\n\nasync function setCustomPropertiesFromJson(propertyDict) {\n    return Word.run(async (context) => {\n        const props = context.document.properties.customProperties;\n        props.load(\"items\");\n        await context.sync();\n\n        for (const [key, value] of Object.entries(propertyDict)) {\n            const existing = props.items.find(p => p.key === key);\n            if (existing) {\n                existing.value = String(value ?? \"\"); // Update existing\n            } else {\n                props.add(key, String(value ?? \"\")); // Add new\n            }\n        }\n\n        await context.sync();\n    });\n}\n\nfunction getLocalizedLongDate() {\n    const locale = \"en-AU\";\n    const now = new Date();\n\n    return now.toLocaleDateString(locale, {\n        day: \"numeric\",\n        month: \"long\",\n        year: \"numeric\"\n    });\n}\n\n\n// TODO: currently no way in office.js to delete the bookmark so unlike\n// VBA the bookmark will stick around\n// some discussion from msft to add some better bookark api.\nasync function clearBookmarkContent(bookmarkName) {\n    await Word.run(async (context) => {\n\n          const range = context.document.getBookmarkRange(bookmarkName);\n          range.load(\"text\");\n          await context.sync();\n\n          range.clear();\n          await context.sync();\n\n    });\n}\n\nasync function chooseTemplate() {\n    // Dynamically construct full URL to dialog.html\n  const baseUrl = window.location.origin;\n  const path = window.location.pathname;\n  const dir = path.substring(0, path.lastIndexOf(\"/\"));\n\n  // Get properties need for the dialog.\n  const keys = [\"CoverDate\", \"CoverTitle\", \"CoverSubtitle\", \"DocType\"];\n  const values = await getCustomPropertiesAsJson(keys);\n\n\n\n  // passing init variable as query params. If gets to big will need to switch to a message\n  // but pass query params ensures available when dialog first loaded for UI initialization.\n  const date = encodeURIComponent(values[\"CoverDate\"] ?? getLocalizedLongDate());\n  const title = encodeURIComponent(values[\"CoverTitle\"] ?? \"coverTitle\");\n  const subtitle = encodeURIComponent(values[\"CoverSubtitle\"] ?? \"coverSubtitle\");\n  const docType = encodeURIComponent(values[\"DocType\"] ?? \"docType\");\n\n\n  const dialogUrl = `${baseUrl}${dir}/frmReport.html?date=${date}&title=${title}&subtitle=${subtitle}&docType=${docType}&showCover=1`;\n\n // const result = await new Promise((resolve, reject)  => {\n    Office.context.ui.displayDialogAsync(\n      dialogUrl,\n      { height: 85, width: 40 },\n      function (asyncResult) {\n        const dialog = asyncResult.value;\n\n        dialog.addEventHandler(Office.EventType.DialogMessageReceived, async function (arg) {\n\n\n            // Handle X button or Esc key\n            if (event.type === Office.EventType.DialogClosed) {\n              console.log(\"Dialog was closed via X or Esc\");\n\n              dialog.close();\n              console.log(\"dialog was cancelled\");\n            //  resolve({});\n              return;\n            }\n\n            if (arg.message === \"cancel\") {\n              dialog.close();\n              console.log(\"dialog was cancelled\");\n            //  resolve({});\n              return;\n            }\n\n            const result = JSON.parse(arg.message);\n            console.log(\"User selections:\", result);\n\n            // todo: define the property names instead of hard code\n            // TODO: coverOption and coverDesign were variables in VBA Would could consider putting the values\n            // in Custom XML (if we can alter) so its not visible to the user if they go to custom properties.\n            let customPropertiesDict = {\n                \"CoverDate\" : result[\"date\"],\n                \"CoverTitle\" : result[\"title\"],\n                \"CoverSubtitle\" : result[\"subtitle\"],\n                \"DocType\" : result[\"docType\"],\n                \"CoverOption\" : result[\"coverOption\"], // \"noCover\" is when noCover is selected\n                \"CoverDesign\" : result[\"coverDesign\"]  // a string of \"1\", \"2\" .., \"5\"\n            }\n\n            \n\n    \n            let coverGrid = null;\n            let colorLogo = null;\n\n            // Do bookmark cleanup based on the cover.\n            if (customPropertiesDict[\"CoverOption\"] == \"noCover\")\n            {\n                // The \"NoCover\" bookmark isn't removed but bookmarks within the range will\n                //  such as coverGrid and coverLogo\n                // TODO: not sure why not just clear the other bookmarks if don't need versus\n                // having a noCover, \n                await clearBookmarkContent(\"NoCover\");\n            }\n            else\n            {\n              switch(customPropertiesDict[\"CoverDesign\"])\n              {\n                case \"1\":\n                  coverGrid = \"1\";\n                  colorLogo = \"CoverLogo_Colour\";\n                  break;\n              case \"2\":\n                  coverGrid = \"2\";\n                  colorLogo = \"CoverLogo_Colour\";\n                break;\n              case \"3\":\n                  coverGrid = \"2\";\n                  colorLogo = \"CoverLogo_White\";\n                  break;\n              case \"4\":\n                  coverGrid = \"2\";\n                  colorLogo = \"CoverLogo_White\";\n                  break;\n                case \"5\": // 5 doesn't have a colorLogo since clears out Cover5 contents\n                    coverGrid = \"5\";\n                    await clearBookmarkContent(\"Cover5\");\n\n                    // will search for bookmarks anywhere so even though CoverFooter is in the hader it will be found.\n                    await insertAutoText(\"CoverFooter\", \"CoverFooter\");\n                    break;\n                default:\n                  // todo shouldn't happen\n                  break;\n              }\n        \n            }\n\n            // Setup cover grid\n            if (coverGrid) {\n                await insertAutoText(\"CoverGrid_\" + coverGrid, \"CoverGrid\");\n            }\n\n    \n            // VBA has a check for CoverLogo bookmark but there isn't really a bookmark \"colorLogo\"\n            // todo: really need a way to check if bookmark exists\n            if (colorLogo) \n            {\n              //   await insertAutoText(colorLogo, \"CoverLogo\");\n            }\n\n            if (customPropertiesDict[\"CoverOption\"] != \"noCover\")\n            {\n                let coverDesign = customPropertiesDict[\"CoverDesign\"];\n                await insertAutoText(\"Cover_\" + coverDesign, \"Cover\");\n            }\n\n\n            // Set the custom properties JSON after the template in case\n            // the Autotext updates the properties as well\n            await setCustomPropertiesFromJson(customPropertiesDict);\n        \n            // Update the fields\n            await updateAllFieldsInBatches(\"DocProperty\");\n\n\n            // also update the Table of Contents if it exists\n            await updateTOC();\n\n            // Use result.date, result.title, etc. in your add-in logic\n            dialog.close();\n\n         //   resolve({});\n\n          });\n        }\n      );\n //   });\n\n    return result;\n}\n\n\n// todo: this is a subset of setting up, just copy/pasted code to expedite prototype.\nasync function updateCoverProperties() {\n   // Dynamically construct full URL to dialog.html\n  const baseUrl = window.location.origin;\n  const path = window.location.pathname;\n  const dir = path.substring(0, path.lastIndexOf(\"/\"));\n\n  // Get properties need for the dialog.\n  const keys = [\"CoverDate\", \"CoverTitle\", \"CoverSubtitle\", \"DocType\"];\n  const values = await getCustomPropertiesAsJson(keys);\n\n\n  // passing init variable as query params. If gets to big will need to switch to a message\n  // but pass query params ensures available when dialog first loaded for UI initialization.\n  const date = encodeURIComponent(values[\"CoverDate\"] ?? getLocalizedLongDate());\n  const title = encodeURIComponent(values[\"CoverTitle\"] ?? \"coverTitle\");\n  const subtitle = encodeURIComponent(values[\"CoverSubtitle\"] ?? \"coverSubtitle\");\n  const docType = encodeURIComponent(values[\"DocType\"] ?? \"docType\");\n\n  // don't include &showCover=1 so only the properties are shown.\n  const dialogUrl = `${baseUrl}${dir}/frmReport.html?date=${date}&title=${title}&subtitle=${subtitle}&docType=${docType}`;\n\n  Office.context.ui.displayDialogAsync(\n    dialogUrl,\n    { height: 40, width: 20 },\n    function (asyncResult) {\n      const dialog = asyncResult.value;\n\n      dialog.addEventHandler(Office.EventType.DialogMessageReceived, async function (arg) {\n        if (arg.message === \"cancel\") {\n          dialog.close();\n          return;\n        }\n\n        const result = JSON.parse(arg.message);\n        console.log(\"User selections:\", result);\n\n        // todo: define the property names instead of hard code\n        // TODO: coverOption and coverDesign were variables in VBA Would could consider putting the values\n        // in Custom XML (if we can alter) so its not visible to the user if they go to custom properties.\n        let customPropertiesDict = {\n            \"CoverDate\" : result[\"date\"],\n            \"CoverTitle\" : result[\"title\"],\n            \"CoverSubtitle\" : result[\"subtitle\"],\n            \"DocType\" : result[\"docType\"],\n        }\n\n         // Set the custom properties JSON, \n          await setCustomPropertiesFromJson(customPropertiesDict);\n\n         // Update the fields that may be depending on it.\n         await updateAllFieldsInBatches(\"DocProperty\");\n\n        // Use result.date, result.title, etc. in your add-in logic\n        dialog.close();\n      });\n    }\n  );\n}\n\n\nasync function insertBackCover() {\n\n\n  // Get properties need for the dialog.\n  const keys = [\"CoverOption\", \"CoverDesign\"];\n  const customPropertiesDict = await getCustomPropertiesAsJson(keys);\n  let autoTextName = null;\n  if (customPropertiesDict[\"CoverOption\"] == \"noCover\")\n  {\n    showAlert(\"Insert Back Cover is not supported for NoCover template choice.\")\n  }\n  else\n  {\n    switch (customPropertiesDict[\"CoverDesign\"])\n    {\n        case \"1\":\n        case \"2\":\n          autoTextName = \"LastPage_White\";\n          break;\n        case \"3\":\n          autoTextName = \"LastPage_Green\";\n          break;\n        case \"4\":\n          autoTextName = \"LastPage_Blue\";\n          break;\n        default:\n           showAlert(`Insert Back Cover is not supported for Cover ${customPropertiesDict[\"CoverDesign\"]} template choice.`)\n          break;\n    }\n  }\n\n  // TODO: ADD A DIALOG FOR IF autoTextName is null MsgBox \"This function is not available for 'No Cover' option\", vbOKOnly, c_Caption\n  // TODO: REVIEW IF SHOULD HIDE THE BACKCOVER BUTTON COMPLETEly if doesn't apply\n  if (autoTextName)\n  {\n     let snippet = await getAutoTextOOXML(autoTextName);\n      await Word.run(async (context) => {\n\n        // Todo: cleanup and understand these selection rules\n        // I had to get the full range again after inserting the paragraph or else section break would be\n        // inserted before the paragraph not after. \n          // Step 1: Get the end of the document\n          let endOfDoc = context.document.body.getRange(Word.RangeLocation.end);\n\n          // Step 2: Collapse the range to a cursor\n          let collapsed = endOfDoc.getRange(Word.RangeLocation.end);\n\n          // Step 3: Insert a paragraph\n          collapsed.insertParagraph(\"\", Word.InsertLocation.after);\n\n          endOfDoc = context.document.body.getRange(Word.RangeLocation.end);\n          collapsed = endOfDoc.getRange(Word.RangeLocation.end);\n\n          // Step 4: Insert a section break (next page)\n          collapsed.insertBreak(Word.BreakType.sectionNext, Word.InsertLocation.after);\n\n           // Step 2: Collapse the range to a cursor again at new end.\n          collapsed = endOfDoc.getRange(Word.RangeLocation.end);\n\n          // Note: could also get an updated range from start of document.\n          collapsed = context.document.body.getRange(Word.RangeLocation.end);\n          \n          // insert the autotext snippet.\n          collapsed.insertOoxml(snippet, Word.InsertLocation.replace);\n        \n\n          await context.sync();\n      });\n\n\n  }\n\n}","// Imports\nvar ___HTML_LOADER_IMPORT_0___ = new URL(\"./taskpane.css\", import.meta.url);\n// Module\nvar code = \" <!DOCTYPE html> <html> <head> <meta charset=\\\"UTF-8\\\"/> <meta http-equiv=\\\"X-UA-Compatible\\\" content=\\\"IE=Edge\\\"/> <meta name=\\\"viewport\\\" content=\\\"width=device-width,initial-scale=1\\\"> <title>Contoso Task Pane Add-in</title> <\" + \"script src=\\\"https://appsforoffice.microsoft.com/lib/1/hosted/office.js\\\"><\" + \"/script> <link rel=\\\"stylesheet\\\" href=\\\"https://res-1.cdn.office.net/files/fabric-cdn-prod_20230815.002/office-ui-fabric-core/11.1.0/css/fabric.min.css\\\"/> <link href=\\\"\" + ___HTML_LOADER_IMPORT_0___ + \"\\\" rel=\\\"stylesheet\\\"/> <style>body,html{height:100%;margin:0;padding:0;font-family:Segoe UI,sans-serif;overflow:hidden}.tab-container{display:flex;flex-direction:column;height:100%;border:1px solid #ccc;border-radius:6px;overflow:hidden}.tab-header{display:flex;flex-wrap:wrap;background-color:#e0e0e0;border-bottom:1px solid #ccc}.tab{font-size:13px;padding:6px 12px;cursor:pointer;flex:0 0 auto;text-align:center;background-color:#d4d4d4;border:1px solid #ccc;border-bottom:none;border-top-left-radius:6px;border-top-right-radius:6px;margin-right:4px;position:relative;z-index:1}.tab.active{background-color:#fff;font-weight:700;z-index:2;border-color:#0078d4 #ccc #fff #ccc}.tab:hover{background-color:#c8c8c8}.tab-body{flex:1;padding:12px;background-color:#fff;border:1px solid #ccc;border-top:none;border-bottom-left-radius:6px;border-bottom-right-radius:6px;overflow-y:auto}.tab-content{display:none}.tab-content.active{display:block}.log-output{height:96px;overflow-y:auto;background-color:#f9f9f9;border-top:1px solid #ccc;font-size:12px;font-family:Consolas,monospace;padding:8px;white-space:pre-wrap;box-sizing:border-box}.ribbon-button-container{display:flex;flex-wrap:wrap;gap:12px;padding:8px}.ribbon-button{width:64px;height:80px;padding:4px;display:flex;flex-direction:column;align-items:center;justify-content:center;border:1px solid #ccc;border-radius:6px;background-color:#f3f3f3;cursor:pointer;transition:background-color .2s ease;text-align:center;position:relative}.ribbon-button:hover{background-color:#e0e0e0}.ribbon-button img{width:24px;height:24px;margin-bottom:6px}.ribbon-button span{font-size:12px;color:#333}.highlight-wrapper{position:relative}.highlight-menu{position:absolute;bottom:-1px;left:0;transform:translateY(100%);background-color:#fff;border:1px solid #ccc;border-radius:4px;box-shadow:0 2px 6px rgba(0,0,0,.15);z-index:10;width:100px}.highlight-menu div{padding:6px 10px;font-size:12px;cursor:pointer}.highlight-menu div:hover{background-color:#eee}.hidden{display:none}.dropdown-arrow{width:0;height:0;border-left:4px solid transparent;border-right:4px solid transparent;border-top:5px solid #333;margin-top:4px;margin:0 auto}i{display:inline-block;width:24px;height:24px}p{font-size:12px!important}</style> <\" + \"script>function showTab(e){document.querySelectorAll(\\\".tab-content\\\").forEach(e=>e.classList.remove(\\\"active\\\")),document.getElementById(e).classList.add(\\\"active\\\"),document.querySelectorAll(\\\".tab\\\").forEach(e=>e.classList.remove(\\\"active\\\")),document.querySelector(`.tab[onclick=\\\"showTab('${e}')\\\"]`).classList.add(\\\"active\\\")}function toggleHighlightMenu(e){if(console.log(\\\"toggle button\\\"),e.target.closest(\\\".highlight-menu\\\"))return;e.stopPropagation(),document.querySelectorAll(\\\".highlight-menu\\\").forEach(e=>e.classList.add(\\\"hidden\\\"));e.currentTarget.querySelector(\\\".highlight-menu\\\").classList.toggle(\\\"hidden\\\")}function handleClick(e){console.log(`Button clicked: ${e}`),document.querySelectorAll(\\\".highlight-menu\\\").forEach(e=>e.classList.add(\\\"hidden\\\"));const[t,o]=e.split(\\\"|\\\");switch(console.log(\\\"Action:\\\",t),o&&console.log(\\\"Metadata:\\\",o),t){case\\\"chooseTemplate\\\":addinCommand.chooseTemplate();break;case\\\"insertFigureCaption\\\":addinCommand.insertFigureCaption();break;case\\\"getOOXML\\\":addinCommand.getOOXML();break;case\\\"getOOXMLDocument\\\":addinCommand.getOOXMLDocument();break;case\\\"pasteOOXML\\\":addinCommand.pasteOOXML();break;case\\\"pasteOOXMLAsDocument\\\":addinCommand.pasteOOXMLAsDocument();break;case\\\"insertPageBreakAtSelection\\\":addinCommand.insertPageBreakAtSelection();break;case\\\"insertBackCover\\\":addinCommand.insertBackCover();break;case\\\"screenshotFormatGuide\\\":addinCommand.screenshotFormatGuide();break;case\\\"insertImageIntoWord\\\":addinCommand.insertImageIntoWord();break;case\\\"insertTableCaption\\\":addinCommand.insertTableCaption();break;case\\\"dynamicTable\\\":addinCommand.dynamicTable(o);break;case\\\"insertAutoText\\\":addinCommand.insertAutoText(o);break;case\\\"clearFormatting\\\":addinCommand.clearFormatting();break;case\\\"setCoverHeadingFontSize\\\":addinCommand.setCoverHeadingFontSize(o);case\\\"setStyle\\\":addinCommand.setStyle(o);break;case\\\"pasteUnformatted\\\":addinCommand.pasteUnformatted();break;case\\\"normalText\\\":addinCommand.setStyle(o);break;case\\\"updateCoverProperties\\\":addinCommand.updateCoverProperties();break;case\\\"updateTOC\\\":addinCommand.updateTOC();break;case\\\"a4Orientation\\\":addinCommand.a4Orientation();break;default:console.log(\\\"no command found for action\\\")}\\\"bold\\\"===t&&Word.run(async e=>{e.document.getSelection().font.bold=!0,await e.sync(),console.log(\\\"Selected text set to bold.\\\")}).catch(function(e){console.log(\\\"Error: \\\"+e),e instanceof OfficeExtension.Error&&console.log(\\\"Debug info: \\\"+JSON.stringify(e.debugInfo))})}document.addEventListener(\\\"click\\\",()=>{document.querySelectorAll(\\\".highlight-menu\\\").forEach(e=>e.classList.add(\\\"hidden\\\"))}),function(){const e=console.log;console.log=function(...t){e.apply(console,t);const o=document.getElementById(\\\"consoleLog\\\");if(o){const e=t.map(e=>\\\"object\\\"==typeof e?JSON.stringify(e,null,2):String(e)).join(\\\" \\\"),n=document.createElement(\\\"div\\\");n.textContent=e,o.appendChild(n),o.scrollTop=o.scrollHeight}}}(),function(){const e=console.error;console.error=function(...t){e.apply(console,t);const o=document.getElementById(\\\"consoleLog\\\");if(o){const e=t.map(e=>\\\"object\\\"==typeof e?JSON.stringify(e,null,2):String(e)).join(\\\" \\\"),n=document.createElement(\\\"div\\\");n.textContent=e,o.appendChild(n),o.scrollTop=o.scrollHeight}}}()<\" + \"/script> </head> <body class=\\\"\\\"> <div class=\\\"tab-container\\\"> <div class=\\\"tab-header\\\"> <div class=\\\"tab active\\\" onclick='showTab(\\\"template\\\")'>Template</div> <div class=\\\"tab\\\" onclick='showTab(\\\"styles\\\")'>Styles</div> <div class=\\\"tab\\\" onclick='showTab(\\\"tableTools\\\")'>Table Tools</div> <div class=\\\"tab\\\" onclick='showTab(\\\"pageLayout\\\")'>Page Layout</div> <div class=\\\"tab\\\" onclick='showTab(\\\"debug\\\")'>Debug</div> <div class=\\\"tab\\\" onclick='showTab(\\\"help\\\")'>Help</div> </div> <div class=\\\"tab-body\\\"> <div id=\\\"template\\\" class=\\\"tab-content active\\\"> <div class=\\\"ribbon-button-container\\\"> <div class=\\\"ribbon-button\\\" onclick='handleClick(\\\"insertBackCover\\\")'> <span>Insert Back Page</span> </div> <div class=\\\"ribbon-button\\\" onclick='handleClick(\\\"updateCoverProperties\\\")'> <span>Update Cover Details</span> </div> </div> </div> <div id=\\\"styles\\\" class=\\\"tab-content\\\"> <div class=\\\"ribbon-button-container\\\"> <div class=\\\"ribbon-button\\\" onclick='handleClick(\\\"pasteUnformatted\\\")'> <i aria-hidden=\\\"true\\\" iconname=\\\"Paste_24\\\" zclass=\\\"___1n6nxe4 f1o7jddm f14t3ns0 fmd4ok8 f71fsbu fdgdznj f1sj8vnk\\\" data-icon-name=\\\"Paste_24\\\"><svg height=\\\"100%\\\" width=\\\"100%\\\" viewBox=\\\"0,0,2048,2048\\\" focusable=\\\"false\\\"><path type=\\\"path\\\" class=\\\"OfficeIconColors_HighContrast\\\" d=\\\"M1621 768q35 0 61 25 25 25 25 60v854q0 35-25 60-25 25-61 25h-597q-35 0-60-25-25-25-25-60v-854q0-35 25-60 25-25 60-25h597z m-597-85q-71 0-121 50-50 50-50 120v854q0 71 50 120 50 50 121 50h597q71 0 121-50 50-50 50-120v-854q0-71-50-120-50-50-121-50h-597z m-256-171q-71 0-121-50-50-50-50-121h-128q-53 0-90 38-37 37-38 90v1195q0 53 38 91 37 37 90 37h256q18 0 31 12 12 12 12 31 0 18-12 30-12 12-31 12h-256q-88 0-151-62-62-62-62-151v-1195q0-88 62-151 62-62 151-62h151q23-39 61-62 40-24 87-23h341q47 0 87 23 39 23 61 62h151q88 0 151 62 62 62 62 151v86q0 18-12 30-12 12-30 12-18 0-31-12-12-12-12-30v-86q0-53-37-90-37-37-91-38h-128q0 71-50 121-50 50-121 50h-341z m0-256q-35 0-60 25-25 25-25 60 0 35 25 61 25 25 60 25h341q35 0 61-25 25-25 25-61 0-35-25-60-25-25-61-25h-341z\\\"></path><path type=\\\"path\\\" zclass=\\\"OfficeIconColors_m22\\\" d=\\\"M1621 768q35 0 61 25 25 25 25 60v854q0 35-25 60-25 25-61 25h-597q-35 0-60-25-25-25-25-60v-854q0-35 25-60 25-25 60-25h597z m-597-85q-71 0-121 50-50 50-50 120v854q0 71 50 120 50 50 121 50h597q71 0 121-50 50-50 50-120v-854q0-71-50-120-50-50-121-50h-597z\\\"></path><path type=\\\"path\\\" class=\\\"OfficeIconColors_m212\\\" d=\\\"M469 1835h299v-982q0-106 75-181 75-75 181-75h555v-128q0-71-50-120-50-50-121-50h-171q0 43-25 103-28 68-60 67h-427q-32 0-60-67-25-60-25-103h-171q-71 0-120 50-50 50-50 120v1195q0 71 50 121 50 50 120 50z\\\"></path><path type=\\\"path\\\" class=\\\"OfficeIconColors_m211\\\" d=\\\"M768 512q-71 0-121-50-50-50-50-121h-128q-53 0-90 38-37 37-38 90v1195q0 53 38 91 37 37 90 37h256q18 0 31 12 12 12 12 31 0 18-12 30-12 12-31 12h-256q-88 0-151-62-62-62-62-151v-1195q0-88 62-151 62-62 151-62h151q23-39 61-62 40-24 87-23h341q47 0 87 23 39 23 61 62h151q88 0 151 62 62 62 62 151v86q0 18-12 30-12 12-30 12-18 0-31-12-12-12-12-30v-86q0-53-37-90-37-37-91-38h-128q0 71-50 121-50 50-121 50h-341z m0-256q-35 0-60 25-25 25-25 60 0 35 25 61 25 25 60 25h341q35 0 61-25 25-25 25-61 0-35-25-60-25-25-61-25h-341z\\\"></path></svg></i> <span>Paste Unformatted</span> </div> <div class=\\\"ribbon-button\\\" onclick='handleClick(\\\"setStyle|Section Heading\\\")'> <Zimg src=\\\"https://static.thenounproject.com/png/20462-200.png\\\" alt=\\\"Highlight\\\"/> <span>Section Heading</span> </div> <div class=\\\"ribbon-button highlight-wrapper\\\" onclick=\\\"toggleHighlightMenu(event)\\\"> <Zimg src=\\\"https://static.thenounproject.com/png/20462-200.png\\\" alt=\\\"Highlight\\\"/> <span>Cover Styless</span> <div class=\\\"dropdown-arrow\\\"></div> <div class=\\\"highlight-menu hidden\\\"> <div onclick='handleClick(\\\"setStyle|Cover Heading\\\")'>Cover Heading</div> <div onclick='handleClick(\\\"setStyle|Cover Subheading\\\")'>Cover Subheading</div> <div onclick='handleClick(\\\"setStyle|Cover Details\\\")'>Cover Details</div> </div> </div> <div class=\\\"ribbon-button highlight-wrapper\\\" onclick=\\\"toggleHighlightMenu(event)\\\"> <Zimg src=\\\"https://static.thenounproject.com/png/20462-200.png\\\" alt=\\\"Highlight\\\"/> <span>Headings</span> <div class=\\\"dropdown-arrow\\\"></div> <div class=\\\"highlight-menu hidden\\\"> <div onclick='handleClick(\\\"setStyle|Heading 1\\\")'>Heading 1</div> <div onclick='handleClick(\\\"setStyle|Heading 2\\\")'>Heading 2</div> <div onclick='handleClick(\\\"setStyle|Heading 3\\\")'>Heading 3</div> </div> </div> <div class=\\\"ribbon-button highlight-wrapper\\\" onclick=\\\"toggleHighlightMenu(event)\\\"> <Zimg src=\\\"https://static.thenounproject.com/png/20462-200.png\\\" alt=\\\"Highlight\\\"/> <span>Bullets</span> <div class=\\\"dropdown-arrow\\\"></div> <div class=\\\"highlight-menu hidden\\\"> <div onclick='handleClick(\\\"setStyle|List Bullet\\\")'>List Bullet 1</div> <div onclick='handleClick(\\\"setStyle|List Bullet 2\\\")'>List Bullet 2</div> <div onclick='handleClick(\\\"setStyle|List Bullet 3\\\")'>List Bullet 3</div> <div onclick='handleClick(\\\"setStyle|List Bullet 4\\\")'>List Bullet 4</div> <div onclick='handleClick(\\\"setStyle|List Bullet 5\\\")'>List Bullet 5</div> </div> </div> <div class=\\\"ribbon-button highlight-wrapper\\\" onclick=\\\"toggleHighlightMenu(event)\\\"> <Zimg src=\\\"https://static.thenounproject.com/png/20462-200.png\\\" alt=\\\"Highlight\\\"/> <span>Numbering</span> <div class=\\\"dropdown-arrow\\\"></div> <div class=\\\"highlight-menu hidden\\\"> <div onclick='handleClick(\\\"setStyle|List Number\\\")'>List Number 1</div> <div onclick='handleClick(\\\"setStyle|List Number 2\\\")'>List Number 2</div> <div onclick='handleClick(\\\"setStyle|List Number 3\\\")'>List Number 3</div> </div> </div> </div> </div> <div id=\\\"tableTools\\\" class=\\\"tab-content\\\"> <div style=\\\"font-size:8\\\"> <p style=\\\"font-weight:700\\\">Table items not implemented:</p> <p>Insert Table: TODO: make a dialog to specify rows and columns instead of hardcoded.</p> </div> <div class=\\\"ribbon-button-container\\\"> <div class=\\\"ribbon-button\\\" onclick='handleClick(\\\"dynamicTable\\\")'> <i aria-hidden=\\\"true\\\" iconname=\\\"Table_24\\\" class=\\\"___1n6nxe4 f1o7jddm f14t3ns0 fmd4ok8 f71fsbu fdgdznj f1sj8vnk\\\" data-icon-name=\\\"Table_24\\\"><svg height=\\\"100%\\\" width=\\\"100%\\\" viewBox=\\\"0,0,2048,2048\\\" focusable=\\\"false\\\"><path type=\\\"path\\\" class=\\\"OfficeIconColors_HighContrast\\\" d=\\\"M256 469q0-88 62-151 62-62 151-62h1110q88 0 151 62 62 62 62 151v1110q0 88-62 151-62 62-151 62h-1110q-88 0-151-62-62-62-62-151v-1110z m85 299v512h342v-512h-342z m427 0v512h512v-512h-512z m597 0v512h342v-512h-342z m-896-427q-53 0-90 38-37 37-38 90v214h1366v-214q0-53-38-90-37-37-90-38h-1110z m-128 1024v214q0 53 38 90 37 37 90 38h214v-342h-342z m427 0v342h512v-342h-512z m597 0v342h214q53 0 90-38 37-37 38-90v-214h-342z\\\"></path><path type=\\\"path\\\" class=\\\"OfficeIconColors_m22\\\" d=\\\"M256 1579v-854h1536v854q0 88-62 151-62 62-151 62h-1110q-88 0-151-62-62-62-62-151z m85-214v214q0 53 38 90 37 37 90 38h214v-342h-342z m427 0v342h512v-342h-512z m597 0v342h214q53 0 90-38 37-37 38-90v-214h-342z m0-597v512h342v-512h-342z m-85 512v-512h-512v512h512z m-939 0h342v-512h-342v512z\\\"></path><path type=\\\"path\\\" class=\\\"OfficeIconColors_m223\\\" d=\\\"M1579 299h-1110q-71 0-120 50-50 50-50 120v256h1450v-256q0-71-50-120-50-50-120-50z\\\"></path><path type=\\\"path\\\" class=\\\"OfficeIconColors_m22\\\" d=\\\"M469 256q-88 0-151 62-62 62-62 151v1110q0 88 62 151 62 62 151 62h1110q88 0 151-62 62-62 62-151v-1110q0-88-62-151-62-62-151-62h-1110z m-128 213q0-53 38-90 37-37 90-38h1110q53 0 90 38 37 37 38 90v214h-1366v-214z m0 1110v-214h342v342h-214q-53 0-90-38-37-37-38-90z m427 128v-342h512v342h-512z m597 0v-342h342v214q0 53-38 90-37 37-90 38h-214z m0-427v-512h342v512h-342z m-85-512v512h-512v-512h512z m-597 512h-342v-512h342v512z\\\"></path><path type=\\\"path\\\" class=\\\"OfficeIconColors_m224\\\" d=\\\"M256 469q0-88 62-151 62-62 151-62h1110q88 0 151 62 62 62 62 151v299h-1536v-299z m213-128q-53 0-90 38-37 37-38 90v214h1366v-214q0-53-38-90-37-37-90-38h-1110z\\\"></path></svg></i> <span>Insert Table</span> </div> <div class=\\\"ribbon-button highlight-wrapper\\\" onclick=\\\"toggleHighlightMenu(event)\\\"> <i aria-hidden=\\\"true\\\" iconname=\\\"GrowFont_16\\\" class=\\\"___1n6nxe4 f1o7jddm f14t3ns0 fmd4ok8 f71fsbu fdgdznj f1sj8vnk\\\" data-icon-name=\\\"GrowFont_16\\\"><svg height=\\\"100%\\\" width=\\\"100%\\\" viewBox=\\\"0,0,2048,2048\\\" focusable=\\\"false\\\"><path type=\\\"path\\\" class=\\\"OfficeIconColors_HighContrast\\\" d=\\\"M1800 731q13 23 38 31 25 7 49-6 23-13 31-38 7-25-6-49l-264-475q-24-43-69-59-43-15-86 0-45 16-69 59l-264 475q-13 23-6 49 7 25 31 38 23 13 49 6 25-7 38-31l264-475 264 475z m-1096-347q20 0 37 12 17 12 23 30l512 1408q9 25-2 49-11 24-36 33-25 9-49-2-24-11-33-36l-171-470h-562l-171 470q-9 25-33 36-24 11-49 2-25-9-36-33-11-24-2-49l512-1408q7-19 23-30 17-12 37-12z m0 251l-234 645h468l-234-645z\\\"></path><path type=\\\"path\\\" class=\\\"OfficeIconColors_m24\\\" d=\\\"M1887 756q-23 13-49 6-25-7-38-31l-264-475-264 475q-13 23-38 31-25 7-49-6-23-13-31-38-7-25 6-49l264-475q24-43 69-59 43-15 86 0 45 16 69 59l264 475q13 23 6 49-7 25-31 38z\\\"></path><path type=\\\"path\\\" class=\\\"OfficeIconColors_m22\\\" d=\\\"M764 426q-7-19-23-30-17-12-37-12-20 0-37 12-17 12-23 30l-512 1408q-9 25 2 49 11 24 36 33 25 9 49-2 24-11 33-36l171-470h562l171 470q9 25 33 36 24 11 49 2 25-9 36-33 11-24 2-49l-512-1408z m174 854h-468l234-645 234 645z\\\"></path></svg></i> <span>Table Styles</span> <div class=\\\"dropdown-arrow\\\"></div> <div class=\\\"highlight-menu hidden\\\"> <div onclick='handleClick(\\\"setStyle|Table Heading\\\")'>Table Heading</div> <div onclick='handleClick(\\\"setStyle|Table Column\\\")'>Table Column</div> <div onclick='handleClick(\\\"setStyle|Table Text\\\")'>Table Text</div> </div> </div> <div class=\\\"ribbon-button\\\" onclick='handleClick(\\\"insertTableCaption\\\")'> <span>Insert Table Caption</span> </div> </div> </div> <div id=\\\"pageLayout\\\" class=\\\"tab-content\\\"> <div class=\\\"ribbon-button-container\\\"> <div class=\\\"ribbon-button\\\" onclick='handleClick(\\\"updateTOC\\\")'> <span>Update TOC</span> </div> <div class=\\\"ribbon-button\\\" onclick='handleClick(\\\"a4Orientation\\\")'> <span>A4 Orientation</span> </div> <div class=\\\"ribbon-button\\\" onclick='handleClick(\\\"insertPageBreakAtSelection\\\")'> <span>Insert Page Break</span> </div> <div class=\\\"ribbon-button\\\" onclick='handleClick(\\\"insertFigureCaption\\\")'> <span>Insert Figure Caption</span> </div> <div class=\\\"ribbon-button\\\" onclick='handleClick(\\\"insertImageIntoWord\\\")'> <span>Insert Picture</span> </div> <div class=\\\"ribbon-button\\\" onclick='handleClick(\\\"insertAutoText|CaseStudy\\\")'> <span>Insert Case Study</span> </div> <div class=\\\"ribbon-button\\\" onclick='handleClick(\\\"insertAutoText|Checklist\\\")'> <span>Insert Checklist</span> </div> <div class=\\\"ribbon-button\\\" onclick='handleClick(\\\"insertAutoText|Quote\\\")'> <span>Insert Quote</span> </div> <div class=\\\"ribbon-button\\\" onclick='handleClick(\\\"insertAutoText|PulloutBox\\\")'> <span>Insert Pullout Box</span> </div> <div class=\\\"ribbon-button\\\" onclick='handleClick(\\\"insertAutoText|FeatureBox\\\")'> <span>Insert Feature Box</span> </div> </div> </div> <div id=\\\"debug\\\" class=\\\"tab-content\\\"> <div>The debug tab won't be visible in production.</div> <div class=\\\"ribbon-button-container\\\"> <div class=\\\"ribbon-button\\\" onclick='handleClick(\\\"getOOXML\\\")'> <span>Copy selection OOXML</span> </div> <div class=\\\"ribbon-button\\\" onclick='handleClick(\\\"getOOXMLDocument\\\")'> <span>Copy document OOXML</span> </div> <div class=\\\"ribbon-button\\\" onclick='handleClick(\\\"pasteOOXML\\\")'> <span>Paste OOXML at selection</span> </div> <div class=\\\"ribbon-button\\\" onclick='handleClick(\\\"pasteOOXMLAsDocument\\\")'> <span>Paste OOXML as document</span> </div> </div> </div> <div id=\\\"help\\\" class=\\\"tab-content\\\"> <div> <div> <img src=\\\"https://upsidedown.com.au/wp-content/uploads/2019/03/Templates-logo-animation.png\\\" alt=\\\"UPSIDE TEMPLATES Logo\\\" style=\\\"height:60px\\\"> <h2 style=\\\"margin:10px 0\\\">About this template</h2> </div> <p>This template was created by <strong>UpsideDown Productions</strong>:</p> <p>Tel: +61 (0)2 9411 4548<br> <a href=\\\"http://www.upsidedown.com.au\\\" target=\\\"_blank\\\">www.upsidedown.com.au</a><br> </p></div> </div> </div> <div id=\\\"consoleLog\\\" class=\\\"log-output\\\"></div> </div></body> </html> \";\n// Exports\nexport default code;"],"names":["__webpack_module_cache__","__webpack_require__","moduleId","cachedModule","undefined","exports","module","__webpack_modules__","m","d","definition","key","o","Object","defineProperty","enumerable","get","g","globalThis","this","Function","e","window","obj","prop","prototype","hasOwnProperty","call","scriptUrl","importScripts","location","document","currentScript","tagName","toUpperCase","src","scripts","getElementsByTagName","length","i","test","Error","replace","p","b","baseURI","self","href","t","r","Symbol","n","iterator","toStringTag","c","Generator","u","create","_regeneratorDefine2","f","y","G","v","a","bind","l","TypeError","done","value","return","GeneratorFunction","GeneratorFunctionPrototype","getPrototypeOf","setPrototypeOf","__proto__","displayName","_regenerator","w","_invoke","configurable","writable","asyncGeneratorStep","Promise","resolve","then","_asyncToGenerator","arguments","apply","_next","_throw","action","event","completed","launcHelpTaskpane","_x2","_launcHelpTaskpane","_callee7","_context7","launchTaskpane","showTab","_x3","_launchTaskpane","_callee8","keys","_context8","console","log","getCustomPropertiesAsJson","chooseTemplate","showAlert","Office","addin","showAsTaskpane","catch","error","_setStyle","_callee0","styleName","_t","_context0","Word","run","_ref5","_callee9","context","_context9","getSelection","style","sync","_x24","OfficeExtension","message","code","trace","traceMessages","_clearFormatting","_callee10","_t2","_context10","_ref6","_callee1","selection","font","_context1","bold","italic","underline","color","highlightColor","strikeThrough","subscript","superscript","_x25","addinCommand","pasteUnformatted","navigator","clipboard","readText","clipText","_ref2","_callee2","_context2","insertText","InsertLocation","_x4","err","setStyle","_x5","setCoverHeadingFontSize","_x9","_setCoverHeadingFontSize","clearFormatting","insertAutoText","dynamicTable","_dynamicTable","insertTableCaption","insertImageIntoWord","_insertImageIntoWord","screenshotFormatGuide","_screenshotFormatGuide","insertBackCover","_insertBackCover","insertPageBreakAtSelection","_ref3","_callee3","_context3","insertBreak","BreakType","page","after","_x18","updateCoverProperties","_updateCoverProperties","updateTOC","insertFigureCaption","_insertFigureCaption","a4Orientation","_a4Orientation","getOOXML","_getOOXML","getOOXMLDocument","_getOOXMLDocument","pasteOOXML","_pasteOOXML","pasteOOXMLAsDocument","_pasteOOXMLAsDocument","onReady","_ref","_callee","info","_context","actions","associate","_x","ahrc_CacheXml","getAutoTextOOXML","_x6","_getAutoTextOOXML","_callee11","autoText_identifier","xmlDoc","response","xmlText","parser","snippetNode","snippet","_context11","fetch","ok","concat","statusText","text","DOMParser","parseFromString","querySelector","textContent","_x7","_insertAutoText","_callee13","bookmarkName","_t3","_args13","_context13","_ref7","_callee12","insertRange","_context12","getBookmarkRange","load","clear","insertOoxml","_x26","_callee17","size","_t5","_context17","_ref9","_callee16","props","styles","coverHeadingStyle","getProp","coverChosen","docType","caption","docTypeLabel","_context16","properties","customProperties","getStyles","getByNameOrNullObject","name","items","find","isNullObject","_x28","_callee18","options","_context18","numRows","numCols","coloredBorders","lineBreaks","headerRow","firstColumn","lastColumn","totalRow","centerAligned","insertOrFormatTable","_x0","_insertOrFormatTable","_callee20","_t6","_context20","_ref0","_callee19","table","range","_context19","tables","insertParagraph","getRange","insertTable","blackBorders","headerRowCount","rows","getFirst","applyStyleToCellParagraphs","cells","_x29","_x1","_x10","_x11","_applyStyleToCellParagraphs","_callee21","_context21","forEach","cell","body","paragraphs","paragraph","updateAllFieldsInBatches","_updateAllFieldsInBatches","_callee24","fieldType","_args24","_context24","_ref1","_callee23","batchSize","totalUpdated","updateFieldsInRange","_updateFieldsInRange","sections","_iterator","_step","section","headers","_i","_headers","header","_t7","_context23","_callee22","label","fields","matchingFields","batchEnd","j","_context22","filter","field","type","Math","min","updateResult","_x31","_x32","_createForOfIteratorHelper","s","getHeader","_x30","_insertTableCaption","_callee27","sectionOoxml","_args27","_context27","_ref10","_callee25","_context25","getLast","RangeLocation","select","_x33","_ref11","_callee26","afterRange","_t8","_context26","_x34","_callee29","input","_context29","createElement","accept","display","onchange","file","files","reader","FileReader","onload","result","base64","startsWith","substring","indexOf","_ref12","_callee28","_context28","insertInlinePictureFromBase64","_x35","readAsDataURL","appendChild","click","_callee31","_context31","_ref13","_callee30","currentParagraph","endOfParagraph","_context30","end","_x36","_callee33","_context33","_ref14","_callee32","ooxml","ooxmlString","_t9","_context32","getOoxml","writeText","_x37","_callee35","_context35","_ref15","_callee34","_t0","_context34","_x38","_callee37","_t1","_context37","_ref16","_callee36","_context36","_x39","_callee39","_t10","_context39","_ref17","_callee38","_context38","_x40","_x12","_showAlert","_callee40","_context40","_updateTOC","_callee48","_context48","_ref20","_callee47","_context47","_x43","_callee49","_context49","getSectionIndexFromSelection","_getSectionIndexFromSelection","_callee52","_context52","_ref21","_callee51","selectionRange","sectionBodyRange","_context51","compareLocationWith","LocationRelation","inside","equal","_x44","_callee57","sectionIndex","headerOoxml","footerOoxml","firstPageheaderOoxml","firstPagefooterOoxml","landscapeHeaderOOXML","_context57","_ref22","_callee53","secondSection","primaryHeader","primaryFooter","zheaderOoxml","zfooterOoxml","firstHeader","firstFooter","zheaderOoxml2","zfooterOoxml2","_context53","HeaderFooterType","primary","getFooter","firstPage","_x45","_ref23","_callee54","_t14","_context54","_x46","_ref24","_callee55","firstSection","FprimaryHeader","FprimaryFooter","_context55","_x47","_ref25","_callee56","newSection","_context56","_x48","_x20","_getCustomPropertiesAsJson","_callee59","propertyNames","_context60","_ref26","_callee58","_iterator3","_step3","_loop","_t15","_context59","match","_context58","_regeneratorValues","_x49","setCustomPropertiesFromJson","_x21","_setCustomPropertiesFromJson","_callee61","propertyDict","_context63","_ref27","_callee60","_loop2","_i3","_Object$entries","_context62","_Object$entries$_i","existing","_context61","_slicedToArray","String","add","entries","_x50","getLocalizedLongDate","Date","toLocaleDateString","day","month","year","clearBookmarkContent","_x22","_clearBookmarkContent","_callee63","_context65","_ref28","_callee62","_context64","_x51","_chooseTemplate","_callee65","_values$CoverDate","_values$CoverTitle","_values$CoverSubtitle","_values$DocType","baseUrl","path","dir","values","date","title","subtitle","dialogUrl","_context67","origin","pathname","lastIndexOf","encodeURIComponent","ui","displayDialogAsync","height","width","asyncResult","dialog","addEventHandler","EventType","DialogMessageReceived","_ref29","_callee64","arg","customPropertiesDict","coverGrid","coverDesign","_t16","_context66","DialogClosed","close","JSON","parse","_x52","_callee67","_values$CoverDate2","_values$CoverTitle2","_values$CoverSubtitle2","_values$DocType2","_context69","_ref30","_callee66","_context68","_x53","_callee69","autoTextName","_t17","_context71","_ref31","_callee68","endOfDoc","_context70","sectionNext","_x54","URL"],"sourceRoot":""}